

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>output &mdash; T2GEORES  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> T2GEORES
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/gener.html">gener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/geometry.html">geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/it2Obs.html">it2Obs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/model_plots.html">model_plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/output.html">output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/regeo_mesh.html">regeo_mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/run.html">run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/t2geores_functions.html">t2geores_functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/txt2sqlite.html">txt2sqlite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/writer.html">writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/formats.html">formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/report.html">report</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">T2GEORES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>output</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for output</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">T2GEORES</span> <span class="kn">import</span> <span class="n">formats</span> <span class="k">as</span> <span class="n">formats</span>
<span class="kn">from</span> <span class="nn">iapws</span> <span class="kn">import</span> <span class="n">IAPWS97</span>

<div class="viewcode-block" id="write_PT_from_t2output"><a class="viewcode-back" href="../modules/output.html#output.write_PT_from_t2output">[docs]</a><span class="k">def</span> <span class="nf">write_PT_from_t2output</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It writes the parameter for every block from every well from the last output file of TOUGH2 simulation</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;, list of wells under the keywords &#39;WELLS&#39;, &#39;MAKE_UP_WELLS&#39; and &#39;NOT_PRODUCING_WELL&#39;</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  {well_name}_PT.txt: file containing the information for every block from every well</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	The layers and well block need  to be on the databse</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; write_PT_from_t2output(input_dictionary)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">wells</span><span class="o">=</span><span class="p">[]</span>

	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;MAKE_UP_WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;NOT_PRODUCING_WELL&#39;</span><span class="p">]:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">input_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
				<span class="n">wells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="n">t2_output_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">t2_output_file</span><span class="p">):</span>
		<span class="k">pass</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="s2">&quot;Theres is not t2.out file on t2/t2.out&quot;</span>

	<span class="c1">#Extracts all the times the line &#39;OUTPUT DATA AFTER&#39; was printed</span>
	<span class="n">output_headers</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">t2_output_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t2_file</span><span class="p">:</span>
		<span class="n">t2_output_array</span> <span class="o">=</span> <span class="n">t2_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">line_i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t2_output_array</span><span class="p">):</span>
			<span class="k">if</span> <span class="s2">&quot;OUTPUT DATA AFTER&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
				<span class="n">output_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line_i</span><span class="p">)</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="c1">#Create a dictionary containing all the blocks in a well</span>

	<span class="n">blocks_wells</span><span class="o">=</span><span class="p">{}</span>
	<span class="n">wells_data</span><span class="o">=</span><span class="p">{}</span>

	<span class="n">data_layer</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT correlative FROM layers ORDER BY  middle DESC;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>
		<span class="n">wells_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
		<span class="n">data_block</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT blockcorr FROM t2wellblock  WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39; ORDER BY blockcorr;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_block</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_layer</span><span class="p">[</span><span class="s1">&#39;correlative&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
				<span class="n">blocks_wells</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">name</span>
	
	<span class="c1">#Select the last line of TOUGH2 output file</span>
	<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">t2_output_array</span><span class="p">[</span><span class="n">output_headers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
		<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks_wells</span><span class="p">:</span>
			<span class="k">if</span>  <span class="n">block</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">==</span><span class="mi">12</span><span class="p">:</span> <span class="c1">#11</span>
				<span class="n">wells_data</span><span class="p">[</span><span class="n">blocks_wells</span><span class="p">[</span><span class="n">block</span><span class="p">]]</span><span class="o">+=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>

	<span class="c1">#Writes an output file for every well</span>
	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">wells_data</span><span class="p">:</span>
		<span class="n">file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/PT/txt/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ELEM,INDEX,P,T,SG,SW,X(WAT1),X(WAT2),PCAP,DG,DW,LOG(PERM)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">wells_data</span><span class="p">[</span><span class="n">well</span><span class="p">])</span>
		<span class="n">file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
	
<div class="viewcode-block" id="from_sav_to_json"><a class="viewcode-back" href="../modules/output.html#output.from_sav_to_json">[docs]</a><span class="k">def</span> <span class="nf">from_sav_to_json</span><span class="p">(</span><span class="n">sav_version</span><span class="o">=</span><span class="s1">&#39;sav1&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It writes a json file with temperature and pressure data from the specified .sav for every block including coordinates</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	sav_version : str</span>
<span class="sd">	  Extension of sav file, i.e. sav, sav1, sav2, etc.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  PT_json_from_sav.txt : on  ../output/PT/json/</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	The ELEME.json file needs to be updated</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; from_sav_to_json(sav_version=&#39;sav1&#39;)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">output_sav_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">sav_version</span>

	<span class="c1">#Generates a dictionary with block as keyword and x,y,z coordinates</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
	  	<span class="n">blocks_position</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

	<span class="n">eleme_dict</span><span class="o">=</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks_position</span><span class="p">:</span>
		<span class="n">eleme_dict</span><span class="p">[</span><span class="n">block</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">blocks_position</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">blocks_position</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">blocks_position</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;Z&#39;</span><span class="p">]]</span>

	<span class="c1">#Creates a string from .sav file</span>
	<span class="n">savfile</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_sav_file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
	<span class="n">savstring</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">for</span> <span class="n">linesav</span> <span class="ow">in</span> <span class="n">savfile</span><span class="p">:</span>
		<span class="n">savstring</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linesav</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
	<span class="n">savfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="c1">#Stores Pressure and Temperature on the dictionary</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_sav_file</span><span class="p">):</span>
		<span class="n">t2_sav_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_sav_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="n">contidion_found</span><span class="o">=</span><span class="kc">False</span>
		<span class="k">for</span> <span class="n">t2_sav_line</span> <span class="ow">in</span> <span class="n">t2_sav_file</span><span class="p">:</span>
			<span class="k">if</span>  <span class="n">t2_sav_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="ow">in</span>  <span class="n">eleme_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">contidion_found</span><span class="o">=</span><span class="kc">True</span>
				<span class="n">block</span><span class="o">=</span><span class="n">t2_sav_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
				<span class="k">continue</span>
			<span class="k">if</span> <span class="n">contidion_found</span><span class="p">:</span>
				<span class="n">eleme_dict</span><span class="p">[</span><span class="n">block</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t2_sav_line</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
				<span class="n">contidion_found</span><span class="o">=</span><span class="kc">False</span>
		<span class="n">t2_sav_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="n">eleme_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">eleme_dict</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
	<span class="n">eleme_pd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/PT_json_from_sav.json&quot;</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="PTjson_to_sqlite"><a class="viewcode-back" href="../modules/output.html#output.PTjson_to_sqlite">[docs]</a><span class="k">def</span> <span class="nf">PTjson_to_sqlite</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;t2&#39;</span><span class="p">,):</span>
	<span class="sd">&quot;&quot;&quot;It stores the defined json file into the database on the table t2PTout</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	source : str</span>
<span class="sd">	  It can be &#39;t2&#39; or &#39;sav&#39;</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; PTjson_to_sqlite(&quot;t2&quot;)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">source</span><span class="o">==</span><span class="s2">&quot;t2&quot;</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/PT_json.txt&quot;</span><span class="p">):</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/PT_json.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">q</span><span class="o">=</span><span class="s2">&quot;INSERT INTO t2PTout(blockcorr,x,y,z,&#39;index&#39;,P,T,SG,SW,X1,X2,PCAP,DG,DW) </span><span class="se">\</span>
<span class="s2">					VALUES (&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">element</span><span class="p">,</span>	<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;INDEX&#39;</span><span class="p">],</span>\
																			<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;T&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;SG&#39;</span><span class="p">],</span>\
																			<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;SW&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X(WAT1)&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X(WAT2)&#39;</span><span class="p">],</span>\
																			<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;PCAP&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;DG&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;DW&#39;</span><span class="p">])</span>

					<span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
				<span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">IntegrityError</span><span class="p">:</span>
					<span class="n">q</span><span class="o">=</span><span class="s2">&quot;UPDATE t2PTout SET </span><span class="se">\</span>
<span class="s2">					x=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					y=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					z=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					&#39;index&#39;=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					P=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					T=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					SG=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					SW=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					X1=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					X2=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					PCAP=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					DG=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					DW=</span><span class="si">%s</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">					WHERE blockcorr=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="o">%</span><span class="p">(</span>	<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;INDEX&#39;</span><span class="p">],</span>\
											<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;T&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;SG&#39;</span><span class="p">],</span>\
											<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;SW&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X(WAT1)&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X(WAT2)&#39;</span><span class="p">],</span>\
											<span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;PCAP&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;DG&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;DW&#39;</span><span class="p">],</span><span class="n">element</span><span class="p">)</span>
					<span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
				<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
	<span class="k">elif</span> <span class="n">source</span><span class="o">==</span><span class="s2">&quot;sav&quot;</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/PT_json_from_sav.txt&quot;</span><span class="p">):</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/PT_json_from_sav.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">q</span><span class="o">=</span><span class="s2">&quot;INSERT INTO t2PTout(blockcorr,x,y,z,P,T) </span><span class="se">\</span>
<span class="s2">					VALUES (&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">element</span><span class="p">,</span>\
												   <span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span>\
												   <span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
					<span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
				<span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">IntegrityError</span><span class="p">:</span>
					<span class="n">q</span><span class="o">=</span><span class="s2">&quot;UPDATE t2PTout SET </span><span class="se">\</span>
<span class="s2">					x=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					y=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					z=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					P=</span><span class="si">%s</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">					T=</span><span class="si">%s</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">					WHERE blockcorr=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;ELEM&#39;</span><span class="p">],</span>\
										   <span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span>\
										   <span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;T&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">element</span><span class="p">][</span><span class="s1">&#39;ELEM&#39;</span><span class="p">])</span>
					<span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
				<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="write_PT_of_wells_from_t2output_in_time"><a class="viewcode-back" href="../modules/output.html#output.write_PT_of_wells_from_t2output_in_time">[docs]</a><span class="k">def</span> <span class="nf">write_PT_of_wells_from_t2output_in_time</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates file containing the evolution of every block on every well</span>

<span class="sd">	Extrae la evolucion de los bloques relacionados de todos los pozos en la direccion &quot;../output/PT/evol&quot;</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	  Dictionary contaning the path and name of database on keyword &#39;db_path&#39;, list of wells under the keywords &#39;WELLS&#39;, &#39;MAKE_UP_WELLS&#39; and &#39;NOT_PRODUCING_WELL&#39;</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  {well}_PT_{layer}.txt : on  ../output/PT/evol</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; write_PT_of_wells_from_t2output_in_time(input_dictionary)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="n">wells</span><span class="o">=</span><span class="p">[]</span>

	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;MAKE_UP_WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;NOT_PRODUCING_WELL&#39;</span><span class="p">]:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">input_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
				<span class="n">wells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">blocks_wells</span><span class="o">=</span><span class="p">{}</span>
	<span class="n">blocks_data</span><span class="o">=</span><span class="p">{}</span>

	<span class="c1">#Generates a dictionary with the blocks on a well as a keyword </span>
	<span class="n">data_layer</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT correlative FROM layers ORDER BY  middle DESC;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>
		<span class="n">data_block</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT blockcorr FROM t2wellblock  WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39; ORDER BY blockcorr;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_block</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_layer</span><span class="p">[</span><span class="s1">&#39;correlative&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
				<span class="n">blocks_wells</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">name</span>
				<span class="n">blocks_data</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

	<span class="c1">#Explore the TOUGH2 output file line by line and store the information if the block list generated on the previous step is on the line.</span>
	<span class="n">output_t2_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">):</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="n">t2_file</span><span class="p">:</span>
			<span class="k">if</span> <span class="s2">&quot;OUTPUT DATA AFTER&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="n">time</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t2_line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">==</span><span class="mi">11</span> <span class="ow">and</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">blocks_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
				<span class="n">data_list</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
				<span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
				<span class="n">blocks_data</span><span class="p">[</span><span class="n">t2_line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>

	<span class="c1">#Store the data from the dictionary in files</span>
	<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks_data</span><span class="p">:</span>
		<span class="n">evol_file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/PT/evol/</span><span class="si">%s</span><span class="s2">_PT_</span><span class="si">%s</span><span class="s2">_evol.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">blocks_wells</span><span class="p">[</span><span class="n">block</span><span class="p">],</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">evol_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ELEM,INDEX,P,T,SG,SW,X(WAT1),X(WAT2),PCAP,DG,DW,TIME</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">evol_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">blocks_data</span><span class="p">[</span><span class="n">block</span><span class="p">])</span>
		<span class="n">evol_file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	
	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="gen_evol"><a class="viewcode-back" href="../modules/output.html#output.gen_evol">[docs]</a><span class="k">def</span> <span class="nf">gen_evol</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates an output file containing flow and flowing enthalpy for each GEN element. As a convention the library it is suggested to use GEN for any source/sink that is not a well</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  {GEN}_{BLOCK}_{NICKNAME}.txt : on  ../output/mh/txt</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="c1">#List the GEN elements</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
	<span class="n">data_source</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well,blockcorr,source_nickname FROM t2wellsource WHERE  source_nickname LIKE&#39;GEN*&#39; ORDER BY source_nickname;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="n">final_t2</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
	<span class="n">output_fi_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>

	<span class="c1">#Initialize a dictionary containing the file path and name.</span>
	<span class="n">dictionary_files</span><span class="o">=</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_source</span><span class="p">)):</span>
		<span class="n">well</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">blockcorr</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">source</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;source_nickname&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span><span class="s2">&quot;../output/mh/txt/</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_evol_mh.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">blockcorr</span><span class="p">,</span><span class="n">source</span><span class="p">),</span><span class="s1">&#39;file_container&#39;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">:</span><span class="n">blockcorr</span><span class="p">,</span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="n">source</span><span class="p">}</span>
		<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s2">&quot;ELEMENT,SOURCEINDEX,GENERATION RATE,ENTHALPY,X1,X2,FF(GAS),FF(AQ.),P(WB),TIME</span><span class="se">\n</span><span class="s2">&quot;</span>

	<span class="c1">#It reads the TOUGH2 output file line by line and store the data from each GEN element</span>
	<span class="n">output_t2_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">):</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="n">t2_file</span><span class="p">:</span>
			<span class="k">if</span> <span class="s2">&quot;OUTPUT DATA AFTER&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="n">time</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span> <span class="ow">and</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
					<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
					<span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
					<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>

	<span class="c1">#Creates a file for every GEN elemen</span>
	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
		<span class="n">t2_file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">])</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="src_evol"><a class="viewcode-back" href="../modules/output.html#output.src_evol">[docs]</a><span class="k">def</span> <span class="nf">src_evol</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates an output file containing flow and flowing enthalpy for each SRC element. As a convention the library it is suggested to use SRC for any source/sink that is a well</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  {GEN}_{BLOCK}_{NICKNAME}.txt : on  ../output/mh/txt</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1">#See comment for gen_evol</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
	<span class="n">data_source</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well,blockcorr,source_nickname FROM t2wellsource WHERE  source_nickname NOT LIKE&#39;GEN*&#39; ORDER BY source_nickname;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="n">final_t2</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
	<span class="n">output_fi_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>

	<span class="n">dictionary_files</span><span class="o">=</span><span class="p">{}</span>

	<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_source</span><span class="p">)):</span>
		<span class="n">well</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">blockcorr</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">source</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;source_nickname&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span><span class="s2">&quot;../output/mh/txt/</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_evol_mh.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">blockcorr</span><span class="p">,</span><span class="n">source</span><span class="p">),</span><span class="s1">&#39;file_container&#39;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">:</span><span class="n">blockcorr</span><span class="p">,</span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="n">source</span><span class="p">}</span>
		<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s2">&quot;ELEMENT,SOURCEINDEX,GENERATION RATE,ENTHALPY,X1,X2,FF(GAS),FF(AQ.),P(WB),TIME</span><span class="se">\n</span><span class="s2">&quot;</span>

	<span class="n">output_t2_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">):</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="n">t2_file</span><span class="p">:</span>
			<span class="k">if</span> <span class="s2">&quot;OUTPUT DATA AFTER&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="n">time</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span> <span class="ow">and</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
					<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
					<span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
					<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
		<span class="n">t2_file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">])</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="write_PT_from_t2output_from_prod"><a class="viewcode-back" href="../modules/output.html#output.write_PT_from_t2output_from_prod">[docs]</a><span class="k">def</span> <span class="nf">write_PT_from_t2output_from_prod</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">sav_version</span><span class="o">=</span><span class="s1">&#39;sav1&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It writes a pressure and temperature comming from block on every well in the specified .sav file.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;.</span>
<span class="sd">	sav_version : str</span>
<span class="sd">	  Extension of sav file, i.e. sav, sav1, sav2, etc.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  {well_name}_PT.txt: it contains the pressure and temperature information for every well</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="n">wells</span><span class="o">=</span><span class="p">[]</span>

	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;MAKE_UP_WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;NOT_PRODUCING_WELL&#39;</span><span class="p">]:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">input_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
				<span class="n">wells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="c1">#Listing all the wells and assigning them to a well</span>

	<span class="n">blocks_wells</span><span class="o">=</span><span class="p">{}</span>
	<span class="n">wells_data</span><span class="o">=</span><span class="p">{}</span>
	<span class="n">blocks_dictionary</span><span class="o">=</span><span class="p">{}</span>

	<span class="n">data_layer</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT correlative FROM layers ORDER BY  middle DESC;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>
		<span class="n">wells_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
		<span class="n">data_block</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT blockcorr FROM t2wellblock  WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39; ORDER BY blockcorr;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_block</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_layer</span><span class="p">[</span><span class="s1">&#39;correlative&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
				<span class="n">blocks_wells</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">name</span>

	
	<span class="n">output_sav_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">sav_version</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_sav_file</span><span class="p">):</span>
		<span class="n">t2_sav_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_sav_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="n">contidion_found</span><span class="o">=</span><span class="kc">False</span>
		<span class="k">for</span> <span class="n">t2_sav_line</span> <span class="ow">in</span> <span class="n">t2_sav_file</span><span class="p">:</span>
			<span class="k">if</span>  <span class="n">t2_sav_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="ow">in</span>  <span class="n">blocks_wells</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">contidion_found</span><span class="o">=</span><span class="kc">True</span>
				<span class="n">well</span><span class="o">=</span><span class="n">blocks_wells</span><span class="p">[</span><span class="n">t2_sav_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]]</span>
				<span class="n">block</span><span class="o">=</span><span class="n">t2_sav_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
				<span class="k">continue</span>
			<span class="k">if</span> <span class="n">contidion_found</span><span class="p">:</span>
				<span class="n">wells_data</span><span class="p">[</span><span class="n">well</span><span class="p">]</span><span class="o">+=</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t2_sav_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)))</span>
				<span class="n">contidion_found</span><span class="o">=</span><span class="kc">False</span>
		<span class="n">t2_sav_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">wells_data</span><span class="p">:</span>
		<span class="n">file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/PT/txt/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ELEM,P,T</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">wells_data</span><span class="p">[</span><span class="n">well</span><span class="p">])</span>
		<span class="n">file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="extract_csv_from_t2out"><a class="viewcode-back" href="../modules/output.html#output.extract_csv_from_t2out">[docs]</a><span class="k">def</span> <span class="nf">extract_csv_from_t2out</span><span class="p">(</span><span class="n">json_output</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It writes the parameter for every block from the last output file of TOUGH2 simulation on csv or json</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	json_output : bool</span>
<span class="sd">	  If True a json file is save on ../output/PT/json/</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  PT.csv: on ../output/PT/csv/</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	The file ELEME.json needs to be updated</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">eleme_dict</span><span class="o">=</span><span class="p">{}</span>

	<span class="n">ELEME_file</span><span class="o">=</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ELEME_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ELEME_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">blocks_position</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks_position</span><span class="p">:</span>
			<span class="n">eleme_dict</span><span class="p">[</span><span class="n">block</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">blocks_position</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">blocks_position</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">blocks_position</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;Z&#39;</span><span class="p">]]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="o">%</span><span class="n">ELEME_file</span>

	<span class="n">last</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;../model/t2/t2.out&quot;</span><span class="p">):</span>
		<span class="n">t2file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../model/t2/t2.out&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="s2">&quot;Theres is not t2.out file on t2/t2.out&quot;</span>


	<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
	<span class="n">t2string</span><span class="o">=</span><span class="p">[]</span>
	<span class="c1">#It finds the last section where OUTPUT DATA AFTER was printed and uses it to know where to start to extract data. But also converts every line of the file into an element in an array</span>
	<span class="k">for</span> <span class="n">linet2</span> <span class="ow">in</span> <span class="n">t2file</span><span class="p">:</span>
		<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
		<span class="n">t2string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linet2</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="k">if</span> <span class="s2">&quot;OUTPUT DATA AFTER&quot;</span> <span class="ow">in</span> <span class="n">linet2</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
			<span class="n">last</span><span class="o">=</span><span class="n">linet2</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
			<span class="n">line</span><span class="o">=</span><span class="n">cnt</span>
	<span class="n">t2file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="n">high_iteration</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">last</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>

	<span class="k">for</span> <span class="n">elementx</span> <span class="ow">in</span> <span class="n">eleme_dict</span><span class="p">:</span>
		<span class="n">cnt2</span><span class="o">=</span><span class="mi">0</span>
		<span class="k">for</span> <span class="n">lineout</span> <span class="ow">in</span> <span class="n">t2string</span><span class="p">[</span><span class="n">line</span><span class="o">+</span><span class="n">cnt2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
			<span class="k">if</span> <span class="s2">&quot; @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&quot;</span><span class="o">==</span><span class="n">lineout</span><span class="p">:</span>
				<span class="n">cnt2</span><span class="o">+=</span><span class="mi">1</span>
			<span class="k">elif</span> <span class="n">cnt2</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
				<span class="k">break</span>
			<span class="k">elif</span> <span class="n">elementx</span> <span class="ow">in</span> <span class="n">lineout</span><span class="p">:</span>
				<span class="n">lineselect</span><span class="o">=</span><span class="n">lineout</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="n">eleme_dict</span><span class="p">[</span><span class="n">elementx</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lineselect</span><span class="p">)</span>
				<span class="k">break</span>

	<span class="n">csv_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;ELEM&#39;</span><span class="p">,</span><span class="s1">&#39;INDEX&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span><span class="s1">&#39;SW&#39;</span><span class="p">,</span><span class="s1">&#39;X(WAT1)&#39;</span><span class="p">,</span><span class="s1">&#39;X(WAT2)&#39;</span><span class="p">,</span><span class="s1">&#39;PCAP&#39;</span><span class="p">,</span><span class="s1">&#39;DG&#39;</span><span class="p">,</span><span class="s1">&#39;DW&#39;</span><span class="p">]</span>

	<span class="k">if</span> <span class="n">json_output</span><span class="p">:</span>
		<span class="n">eleme_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">eleme_dict</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">csv_columns</span><span class="p">)</span>
		<span class="n">dtype</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span><span class="s1">&#39;str&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;INDEX&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;P&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;T&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;SG&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;SW&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;X(WAT1)&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;X(WAT2)&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;PCAP&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;DG&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
				 <span class="s1">&#39;DW&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">}</span>
		<span class="n">eleme_pd</span><span class="o">=</span> <span class="n">eleme_pd</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
		<span class="n">eleme_pd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/PT_json.txt&quot;</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/PT/csv/PT.csv&quot;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">csv_columns</span><span class="p">))</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">eleme_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">string</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
			<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">eleme_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
				<span class="n">string</span><span class="o">+=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="t2_to_json"><a class="viewcode-back" href="../modules/output.html#output.t2_to_json">[docs]</a><span class="k">def</span> <span class="nf">t2_to_json</span><span class="p">(</span><span class="n">itime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">save_full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It creates a severals or a single json file from the output file from the TOUGH2 run</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd"> 	itime: float</span>
<span class="sd">	  It defines a time at which a the parameters from the blocks are extracted into json file. Must be on the same units as the TOUGH2 output files (days, seconds, etc.)</span>
<span class="sd">	save_full: bool</span>
<span class="sd">	  If True it creates a single output json file</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	files</span>
<span class="sd">	  t2_ouput_{time}.json: on ../output/PT/json/evol/</span>
<span class="sd">	file</span>
<span class="sd">	  t2_output:  on ../output/PT/json/</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	When t2_output is saved, the large could be too large for the system to handle it</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; t2_to_json()</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">block__json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">block__json_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">blocks</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist, run ELEM_to_json from regeo_mesh&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>		  	


	<span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;T&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s2">&quot;SG&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s2">&quot;SW&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="s2">&quot;X(WAT1)&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="s2">&quot;X(WAT2)&quot;</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="s2">&quot;PCAP&quot;</span><span class="p">,</span><span class="mi">7</span><span class="p">:</span><span class="s2">&quot;DG&quot;</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="s2">&quot;DW&quot;</span><span class="p">}</span>

	<span class="c1">#Creates a json file for every output time on the TOUGH2 output file</span>
	<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
	<span class="n">output_t2_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">):</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="n">t2_file</span><span class="p">:</span>
			<span class="k">if</span> <span class="s2">&quot;OUTPUT DATA AFTER&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">cnt</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">itime</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">itime</span><span class="o">!=</span><span class="kc">None</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">==</span><span class="nb">float</span><span class="p">(</span><span class="n">itime</span><span class="p">)):</span>
						<span class="n">t2_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data_dictionary</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
						<span class="n">t2_pd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;../output/PT/json/evol/t2_output_</span><span class="si">%s</span><span class="s1">.json&#39;</span><span class="o">%</span><span class="n">time</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">itime</span><span class="o">!=</span><span class="kc">None</span> <span class="ow">and</span> <span class="n">itime</span><span class="o">==</span><span class="nb">float</span><span class="p">(</span><span class="n">itime</span><span class="p">):</span>
							<span class="k">break</span>
				<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
				<span class="n">time</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
				<span class="n">data_dictionary</span><span class="o">=</span><span class="p">{}</span>
				<span class="n">data_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t2_line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">==</span><span class="mi">12</span> <span class="ow">and</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">blocks</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
				<span class="n">data_list</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
				<span class="n">data_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">][</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">{}</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
					<span class="n">data_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">][</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">parameters</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">save_full</span><span class="p">:</span>
		<span class="c1">#It generates a dictionary with time as key and json file output as value</span>
		<span class="n">src</span><span class="o">=</span><span class="s1">&#39;../output/PT/json/evol/&#39;</span>
		<span class="n">src_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
		<span class="n">files_dictionary</span><span class="o">=</span><span class="p">{}</span>
		<span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">src_files</span><span class="p">:</span>
			<span class="n">time</span><span class="o">=</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.j&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">full_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
			<span class="n">files_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">]</span><span class="o">=</span><span class="n">full_file_name</span>
	
		<span class="c1">#It generates a single json output file, for a large model it can be to large for the system memory</span>
		<span class="n">t2_json</span><span class="o">=</span><span class="s1">&#39;../output/PT/json/t2_output.json&#39;</span>
		<span class="n">t2_output_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">t2_json</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

		<span class="n">t2_output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;{</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files_dictionary</span><span class="p">):</span>
			<span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">files_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
			<span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
				<span class="n">t2_output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
			<span class="n">t2_output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>		
		<span class="n">t2_output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
		<span class="n">t2_output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="it2COF"><a class="viewcode-back" href="../modules/output.html#output.it2COF">[docs]</a><span class="k">def</span> <span class="nf">it2COF</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Extracts the COF value for each block on the OBSERVATION section of the inverse file</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">		Contains the name of the iTOUGH2 file</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">		COF_PT.json: on the output/PT/json/ folder</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	It might changed based on the iTOUGH2 version</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; it2COF(input_dictionary)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">it2_output_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/</span><span class="si">%s</span><span class="s2">.out&quot;</span><span class="o">%</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">it2_output_file</span><span class="p">):</span>
		<span class="k">pass</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="s2">&quot;Theres is not %.out file on t2/</span><span class="si">%s</span><span class="s2">.out&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">],</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">])</span>

	<span class="c1">#First and last line in between the data</span>
	<span class="n">compare1</span> <span class="o">=</span> <span class="s2">&quot; DATASET              DATAPOINTS          MEAN       MEDIAN    STD. DEV.    AVE. DEV.   SKEWNESS   KURTOSIS      M/S    DWA     COF&quot;</span>
	<span class="n">compare2</span> <span class="o">=</span> <span class="s2">&quot; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -&quot;</span>

	<span class="c1">#Empty dataframe</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DATASET&quot;</span><span class="p">,</span><span class="s2">&quot;DATAPOINTS&quot;</span><span class="p">,</span><span class="s2">&quot;MEAN&quot;</span><span class="p">,</span><span class="s2">&quot;MEDIAN&quot;</span><span class="p">,</span><span class="s2">&quot;STD. DEV.&quot;</span><span class="p">,</span><span class="s2">&quot;AVE. DEV.&quot;</span><span class="p">,</span><span class="s2">&quot;SKEWNESS&quot;</span><span class="p">,</span><span class="s2">&quot;KURTOSIS&quot;</span><span class="p">,</span><span class="s2">&quot;M/S&quot;</span><span class="p">,</span><span class="s2">&quot;DWA&quot;</span><span class="p">,</span><span class="s2">&quot;COF&quot;</span><span class="p">])</span>

	<span class="c1">#Extracts the data based on compare1 and compare2</span>
	<span class="n">output_headers</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">it2_output_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t2_file</span><span class="p">:</span>
		<span class="n">it2_output_array</span> <span class="o">=</span> <span class="n">t2_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
		<span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">for</span> <span class="n">line_i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">it2_output_array</span><span class="p">):</span>

			<span class="k">if</span> <span class="n">compare1</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
				<span class="n">save</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">compare2</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
				<span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>

			<span class="k">if</span> <span class="n">save</span><span class="p">:</span>
				<span class="n">output_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it2_output_array</span><span class="p">[</span><span class="n">line_i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

	<span class="c1">#Stores the date into the appropiate column</span>
	<span class="n">output_headers</span><span class="o">=</span><span class="n">output_headers</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">output_headers</span><span class="p">:</span>
		<span class="n">data_i</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;DATASET&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
							<span class="s2">&quot;DATAPOINTS&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
							<span class="s2">&quot;MEAN&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
							<span class="s2">&quot;MEDIAN&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
							<span class="s2">&quot;STD. DEV.&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
							<span class="s2">&quot;AVE. DEV.&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
							<span class="s2">&quot;SKEWNESS&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>
							<span class="s2">&quot;KURTOSIS&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
							<span class="s2">&quot;M/S&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
							<span class="s2">&quot;DWA&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
							<span class="s2">&quot;COF&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">12</span><span class="p">]},</span><span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


	<span class="n">data</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/COF_PT.json&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="it2DATASET"><a class="viewcode-back" href="../modules/output.html#output.it2DATASET">[docs]</a><span class="k">def</span> <span class="nf">it2DATASET</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Extracts the OBSERVATION dataset on the the inverse file</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">		Contains the name of the iTOUGH2 file</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">		it2_PT.json: on the output/PT/json/ folder</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	It might changed based on the iTOUGH2 version</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; it2DATASET(input_dictionary)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">it2_output_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/</span><span class="si">%s</span><span class="s2">.out&quot;</span><span class="o">%</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">it2_output_file</span><span class="p">):</span>
		<span class="k">pass</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="s2">&quot;Theres is not </span><span class="si">%s</span><span class="s2">.out file on t2/</span><span class="si">%s</span><span class="s2">.out&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">],</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">])</span>

	<span class="c1">#First and last line in between the data</span>
	<span class="n">compare1</span><span class="o">=</span><span class="s2">&quot;    # OBSERVATION   AT TIME [sec]     MEASURED     COMPUTED     RESIDUAL     WEIGHT C.O.F [%]    STD. DEV.    Yi      Wi    DWi +/-&quot;</span>
	<span class="n">compare2</span><span class="o">=</span><span class="s2">&quot; Residual Plots&quot;</span>

	<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NUMBER&quot;</span><span class="p">,</span><span class="s2">&quot;OBSERVATION&quot;</span><span class="p">,</span><span class="s2">&quot;TIME&quot;</span><span class="p">,</span><span class="s2">&quot;MEASURED&quot;</span><span class="p">,</span><span class="s2">&quot;COMPUTED&quot;</span><span class="p">,</span><span class="s2">&quot;RESIDUAL&quot;</span><span class="p">,</span><span class="s2">&quot;WEIGHT&quot;</span><span class="p">,</span><span class="s2">&quot;C.O.F&quot;</span><span class="p">,</span><span class="s2">&quot;STD.DEV&quot;</span><span class="p">])</span>


	<span class="c1">#Extracts the data based on compare1 and compare2</span>
	<span class="n">output_headers</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">it2_output_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t2_file</span><span class="p">:</span>
		<span class="n">it2_output_array</span> <span class="o">=</span> <span class="n">t2_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
		<span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">for</span> <span class="n">line_i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">it2_output_array</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">compare1</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
				<span class="n">save</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">compare2</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
				<span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>

			<span class="k">if</span> <span class="n">save</span> <span class="ow">and</span> <span class="s1">&#39;ABS.&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="p">:</span>
				<span class="n">output_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it2_output_array</span><span class="p">[</span><span class="n">line_i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

	<span class="c1">#Stores the date into the corresponding column</span>

	<span class="n">output_headers</span><span class="o">=</span><span class="n">output_headers</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="c1">#[::2]</span>

	<span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">output_headers</span><span class="p">:</span>
		<span class="n">data_i</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">if</span> <span class="s1">&#39;AA&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_i</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;NUMBER&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
								<span class="s2">&quot;OBSERVATION&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
								<span class="s2">&quot;TIME&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
								<span class="s2">&quot;MEASURED&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
								<span class="s2">&quot;COMPUTED&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
								<span class="s2">&quot;RESIDUAL&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
								<span class="s2">&quot;WEIGHT&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
								<span class="s2">&quot;C.O.F&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>
								<span class="s2">&quot;STD&quot;</span><span class="p">:</span><span class="n">data_i</span><span class="p">[</span><span class="mi">8</span><span class="p">]},</span><span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

	<span class="n">data</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;../output/PT/json/it2_PT.json&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="it2OBJF"><a class="viewcode-back" href="../modules/output.html#output.it2OBJF">[docs]</a><span class="k">def</span> <span class="nf">it2OBJF</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Extracts the value of the objective function from the output inverse file and append it with the current time</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">		Contains the name of the iTOUGH2 file</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">		OBJ.json: on the output/PT/json/ folder</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	It might changed based on the iTOUGH2 version</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; it2OBJF(input_dictionary)</span>
<span class="sd">	&quot;&quot;&quot;</span>


	<span class="n">it2_output_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/</span><span class="si">%s</span><span class="s2">.out&quot;</span><span class="o">%</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">it2_output_file</span><span class="p">):</span>
		<span class="k">pass</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="s2">&quot;Theres is not </span><span class="si">%s</span><span class="s2">.out file on t2/</span><span class="si">%s</span><span class="s2">.out&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">],</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;iTOUGH2_file&#39;</span><span class="p">])</span>

	<span class="c1">#First and last line in between the data</span>

	<span class="n">compare1</span> <span class="o">=</span> <span class="s2">&quot;Objective Function&quot;</span>
	<span class="n">compare2</span> <span class="o">=</span> <span class="s2">&quot;==================================================================================================================================&quot;</span>

	<span class="c1">#Extracts the data based on compare1 and compare2</span>
	<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
	<span class="n">output_headers</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">it2_output_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t2_file</span><span class="p">:</span>
		<span class="n">it2_output_array</span> <span class="o">=</span> <span class="n">t2_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
		<span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">for</span> <span class="n">line_i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">it2_output_array</span><span class="p">):</span>

			<span class="k">if</span> <span class="n">compare1</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
				<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
				<span class="n">save</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">compare2</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
				<span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>

			<span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">save</span><span class="p">:</span>
				<span class="n">output_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it2_output_array</span><span class="p">[</span><span class="n">line_i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
	
	<span class="n">OBJ_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/OBJ.json&quot;</span>

	<span class="n">OBJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">)</span>

	<span class="c1">#Add the current time to the file</span>
	<span class="n">OBJ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">OBJ</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">output_headers</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">])]</span>

	<span class="n">OBJ</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<span class="c1">#not documented</span>
<div class="viewcode-block" id="normal_directions"><a class="viewcode-back" href="../modules/output.html#output.normal_directions">[docs]</a><span class="k">def</span> <span class="nf">normal_directions</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">block2</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	not documented</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">points</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT x1,y1,x2,y2,ELEME1,ELEME2 FROM segment WHERE ELEME1=&#39;</span><span class="si">%s</span><span class="s2">&#39; AND ELEME2=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="n">block2</span><span class="p">),</span><span class="n">conn</span><span class="p">)</span>
	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="n">block2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
		<span class="n">vectors</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">formats</span><span class="o">.</span><span class="n">formats_t2</span><span class="p">[</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">][</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">-</span><span class="n">formats</span><span class="o">.</span><span class="n">formats_t2</span><span class="p">[</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">][</span><span class="n">block2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="n">duz</span><span class="o">=-</span><span class="mi">1</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">duz</span><span class="o">=</span><span class="mi">1</span>
		<span class="n">dux</span><span class="o">=</span><span class="mi">0</span>
		<span class="n">duy</span><span class="o">=</span><span class="mi">0</span>
		<span class="n">points</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">dux</span><span class="p">,</span><span class="n">duy</span><span class="p">,</span><span class="n">duz</span><span class="p">]],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dux&#39;</span><span class="p">,</span><span class="s1">&#39;duy&#39;</span><span class="p">,</span><span class="s1">&#39;duz&#39;</span><span class="p">])</span>
	<span class="k">elif</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">block2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;dx&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;dy&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;y2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;dx&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;dy&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;ux&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;dx&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;uy&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;dy&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;dux&#39;</span><span class="p">]</span><span class="o">=-</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;uy&#39;</span><span class="p">]</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;duy&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="s1">&#39;ux&#39;</span><span class="p">]</span>
		<span class="n">points</span><span class="p">[</span><span class="s1">&#39;duz&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
	<span class="k">return</span> <span class="n">points</span></div>

<div class="viewcode-block" id="output_flows"><a class="viewcode-back" href="../modules/output.html#output.output_flows">[docs]</a><span class="k">def</span> <span class="nf">output_flows</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Read the .out file from the standard TOUGH2 file and store the data into a database. It includes the model version and timestamp.</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">elements</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT ELEME FROM ELEME WHERE model_version=</span><span class="si">%d</span><span class="s2">;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;model_version&#39;</span><span class="p">]),</span><span class="n">conn</span><span class="p">)</span>
	<span class="n">elements_list</span><span class="o">=</span><span class="n">elements</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">,</span> <span class="s1">&#39;ELEME2&#39;</span><span class="p">,</span> <span class="s1">&#39;INDEX&#39;</span><span class="p">,</span><span class="s1">&#39;FHEAT&#39;</span><span class="p">,</span><span class="s1">&#39;FLOH&#39;</span><span class="p">,</span><span class="s1">&#39;FLOF&#39;</span><span class="p">,</span><span class="s1">&#39;FLOG&#39;</span><span class="p">,</span><span class="s1">&#39;FLOAQ&#39;</span><span class="p">,</span><span class="s1">&#39;FLOWTR2&#39;</span><span class="p">,</span><span class="s1">&#39;VELG&#39;</span><span class="p">,</span><span class="s1">&#39;VELAQ&#39;</span><span class="p">,</span><span class="s1">&#39;TURB_COEFF&#39;</span><span class="p">,</span><span class="s1">&#39;model_time&#39;</span><span class="p">,</span><span class="s1">&#39;model_version&#39;</span><span class="p">,</span><span class="s1">&#39;model_output_timestamp&#39;</span><span class="p">]</span>

	<span class="n">time_now</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

	<span class="n">output_t2_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2.out&quot;</span>

	<span class="n">bulk_data</span><span class="o">=</span><span class="p">[]</span>

	<span class="n">allow</span><span class="o">=</span><span class="kc">False</span>
	<span class="n">allowed_line</span><span class="o">=</span><span class="mf">1E50</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">):</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">t2_line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t2_file</span><span class="p">):</span>
			<span class="k">if</span> <span class="s2">&quot;OUTPUT DATA AFTER&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="n">time</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
				<span class="n">fix_data</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;model_version&#39;</span><span class="p">],</span><span class="n">time_now</span><span class="p">]</span>
				<span class="n">allow</span><span class="o">=</span><span class="kc">True</span>

			<span class="k">if</span> <span class="n">t2_line</span><span class="o">==</span><span class="s2">&quot;                          (W)        (J/KG)        (KG/S)       (KG/S)       (KG/S)       (KG/S)        (M/S)        (M/S)        (1/M)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
				<span class="n">allowed_line</span><span class="o">=</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span>

			<span class="k">if</span> <span class="n">t2_line</span><span class="o">==</span><span class="s2">&quot; ELEMENT SOURCE INDEX      GENERATION RATE     ENTHALPY      X1           X2          FF(GAS)      FF(AQ.)         P(WB)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
				<span class="n">allow</span><span class="o">=</span><span class="kc">False</span>
				<span class="n">allowed_line</span><span class="o">=</span><span class="mf">1E50</span>

			<span class="k">if</span> <span class="n">allow</span> <span class="ow">and</span> <span class="n">n</span><span class="o">&gt;=</span><span class="n">allowed_line</span><span class="p">:</span>
				<span class="n">content</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="o">==</span><span class="mi">12</span> <span class="ow">and</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;ELEM1&#39;</span><span class="p">:</span>
					<span class="n">data_list</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">content</span><span class="p">))</span>
					<span class="n">data_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fix_data</span><span class="p">)</span>
					<span class="n">bulk_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>

			<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">			Previous logic</span>
<span class="sd">			#if len(t2_line.split())==12 and elements.ELEME.str.count(t2_line.split()[0]).sum()==1 and elements.ELEME.str.count(t2_line.split()[1]).sum()==1:</span>
<span class="sd">			#if len(t2_line.split())==12 and bool(re.match(&quot;^[A-Z][A-Z][0-9][0-9][0-9]$&quot;,str(t2_line.split()[0]))) and bool(re.match(&quot;^[A-Z][A-Z][0-9][0-9][0-9]$&quot;,str(t2_line.split()[1]))): #3000s</span>
<span class="sd">			if len(t2_line.split())==12 and len(t2_line.split()[0])==5 and not(any(y in t2_line.split() for y in [&#39;ELEM1&#39;,&#39;GENER&#39;] )): #2950s #t2_line.split()[0] in elements_list and t2_line.split()[1] in elements_list: #3500s</span>
<span class="sd">				#print(t2_line.split())</span>
<span class="sd">				t2_array=t2_line.rstrip().split(&quot; &quot;)</span>
<span class="sd">				data_list= list(filter(None, t2_array))</span>
<span class="sd">				data_list.extend(fix_data)</span>
<span class="sd">				data_line={}</span>

<span class="sd">				for i,name in enumerate(column_names):</span>
<span class="sd">					try:</span>
<span class="sd">						data_line[name]=float(data_list[i])</span>
<span class="sd">					except (ValueError,TypeError):</span>
<span class="sd">						data_line[name]=data_list[i]</span>
<span class="sd">				</span>
<span class="sd">				flows_df=flows_df.append(data_line,ignore_index=True)</span>
<span class="sd">			&quot;&quot;&quot;</span>
		<span class="n">flows_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bulk_data</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

		<span class="c1">#Writing the dataframe to the database</span>

		<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
		<span class="n">flows_df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;t2FLOWSout&#39;</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">,</span><span class="n">con</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
		<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="flow_direction"><a class="viewcode-back" href="../modules/output.html#output.flow_direction">[docs]</a><span class="k">def</span> <span class="nf">flow_direction</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	not documented</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">elements</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT ELEME FROM ELEME WHERE model_version=</span><span class="si">%d</span><span class="s2">;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;model_version&#39;</span><span class="p">]),</span><span class="n">conn</span><span class="p">)</span>
	<span class="n">elements_list</span><span class="o">=</span><span class="n">elements</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
	
	<span class="n">flows_dict</span><span class="o">=</span><span class="p">{}</span>

	<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements_list</span><span class="p">:</span>

		<span class="c1">#print(&quot;PRE DIRECTIONS&quot;,datetime.datetime.now())</span>
		<span class="n">directions</span><span class="o">=</span><span class="n">normal_directions</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">element</span><span class="p">)</span>
		<span class="c1">#print(&quot;AFTER DIRECTIONS&quot;,datetime.datetime.now())</span>
		
		<span class="c1">#Direction 1</span>
		<span class="c1">#print(&quot;PRE query flow&quot;,datetime.datetime.now())</span>
		<span class="n">flow_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM t2FLOWSout WHERE ELEME1=&#39;</span><span class="si">%s</span><span class="s2">&#39;AND model_time=-3359500000.0&quot;</span><span class="o">%</span><span class="n">element</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
		<span class="c1">#print(&quot;AFTER query flow&quot;,datetime.datetime.now())</span>

		<span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;flow_x&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
		<span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;flow_y&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

		<span class="c1">#print(&quot;PRE FIRST LOOP&quot;,datetime.datetime.now())</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">flow_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1">#horizontal</span>

			<span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
				<span class="c1">#Establish the direction of the flow</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">formats</span><span class="o">.</span><span class="n">formats_t2</span><span class="p">[</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">][</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">-</span><span class="n">formats</span><span class="o">.</span><span class="n">formats_t2</span><span class="p">[</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">][</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">uy</span><span class="o">=-</span><span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">uy</span><span class="o">=</span><span class="mi">1</span>

				<span class="c1">#It is necessary to check if the right position of ELEME1 and ELEME2 exists</span>
				<span class="k">if</span> <span class="n">element</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]:</span>
					<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_y&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">uy</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FLOF&#39;</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_y&quot;</span><span class="p">]</span><span class="o">=-</span><span class="n">uy</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FLOF&#39;</span><span class="p">]</span>

			<span class="k">else</span><span class="p">:</span>

				<span class="n">ux</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">directions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])][</span><span class="s1">&#39;dux&#39;</span><span class="p">])</span>
				<span class="n">uy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">directions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])][</span><span class="s1">&#39;duy&#39;</span><span class="p">])</span>
				
				<span class="n">flux</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])][</span><span class="s1">&#39;FLOF&#39;</span><span class="p">])</span>
				
				<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_x&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">ux</span><span class="o">*</span><span class="n">flux</span>
				<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_y&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">uy</span><span class="o">*</span><span class="n">flux</span>
		<span class="c1">#print(&quot;AFTER FIRST LOOP&quot;,datetime.datetime.now())</span>


		<span class="c1">#Direction 2</span>
		<span class="n">flow_data2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM t2FLOWSout WHERE ELEME2=&#39;</span><span class="si">%s</span><span class="s2">&#39; AND model_time=-3359500000.0&quot;</span><span class="o">%</span><span class="n">element</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
		<span class="n">flow_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flow_data2</span><span class="p">)</span>

		<span class="c1">#print(&quot;PRE SECOND LOOP&quot;,datetime.datetime.now())</span>

		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">flow_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1">#horizontal</span>

			<span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
				<span class="c1">#Establish the direction of the flow</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">formats</span><span class="o">.</span><span class="n">formats_t2</span><span class="p">[</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">][</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">-</span><span class="n">formats</span><span class="o">.</span><span class="n">formats_t2</span><span class="p">[</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">][</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">uy</span><span class="o">=-</span><span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">uy</span><span class="o">=</span><span class="mi">1</span>

				<span class="c1">#It is necessary to check if the right position of ELEME1 and ELEME2 exists</span>
				<span class="k">if</span> <span class="n">element</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]:</span>
					<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_y&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">uy</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FLOF&#39;</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_y&quot;</span><span class="p">]</span><span class="o">=-</span><span class="n">uy</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FLOF&#39;</span><span class="p">]</span>

			<span class="k">else</span><span class="p">:</span>

				<span class="n">ux</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">directions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])][</span><span class="s1">&#39;dux&#39;</span><span class="p">])</span>
				<span class="n">uy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">directions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])][</span><span class="s1">&#39;duy&#39;</span><span class="p">])</span>
				
				<span class="n">flux</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])][</span><span class="s1">&#39;FLOF&#39;</span><span class="p">])</span>
				
				<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_x&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">ux</span><span class="o">*</span><span class="n">flux</span>
				<span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]),</span><span class="s2">&quot;flow_y&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">uy</span><span class="o">*</span><span class="n">flux</span>
		<span class="c1">#print(&quot;AFTER SECOND LOOP&quot;,datetime.datetime.now())</span>

		<span class="c1">#print(&quot;PRE CALCS&quot;,datetime.datetime.now())</span>
		<span class="n">sum_flowx</span><span class="o">=</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;flow_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
		<span class="n">sum_flowy</span><span class="o">=</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;flow_y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
		<span class="n">flows_dict</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">sum_flowx</span><span class="p">,</span><span class="n">sum_flowy</span><span class="p">,(</span><span class="n">sum_flowx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">sum_flowy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">]</span>
		<span class="c1">#print(&quot;AFTER CALCS&quot;,datetime.datetime.now())</span>
		<span class="c1">#print(element,flows_dict[element])</span>

	<span class="n">flows</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">flows_dict</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flow_x&#39;</span><span class="p">,</span><span class="s1">&#39;flow_y&#39;</span><span class="p">,</span><span class="s1">&#39;flow_mag&#39;</span><span class="p">])</span>
	<span class="c1">#left_side=flow_data.loc[flow_data[&#39;ELEME1&#39;]==element]</span>
	<span class="c1">#right_side=flow_data.loc[flow_data[&#39;ELEME2&#39;]==element]</span>
	<span class="n">flows</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;directions.csv&#39;</span><span class="p">)</span>
	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="flow_direction2"><a class="viewcode-back" href="../modules/output.html#output.flow_direction2">[docs]</a><span class="k">def</span> <span class="nf">flow_direction2</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	not documented</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">elements</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT ELEME FROM ELEME WHERE model_version=</span><span class="si">%d</span><span class="s2">;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;model_version&#39;</span><span class="p">]),</span><span class="n">conn</span><span class="p">)</span>
	<span class="n">elements_list</span><span class="o">=</span><span class="n">elements</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
	
	<span class="n">flows_dict</span><span class="o">=</span><span class="p">{}</span>

	<span class="n">flow_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM t2FLOWSout WHERE model_time=-3359500000.0&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;x_flow&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">flow_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="n">normal_directions</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])[</span><span class="s1">&#39;dux&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FLOF&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;y_flow&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">flow_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="n">normal_directions</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])[</span><span class="s1">&#39;duy&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FLOF&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;z_flow&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">flow_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="n">normal_directions</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">])[</span><span class="s1">&#39;duz&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FLOF&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

	<span class="c1">#[Finished in 905.5s]</span>

	<span class="n">elements</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT ELEME FROM ELEME WHERE model_version=</span><span class="si">%d</span><span class="s2">;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;model_version&#39;</span><span class="p">]),</span><span class="n">conn</span><span class="p">)</span>
	<span class="n">elements_list</span><span class="o">=</span><span class="n">elements</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

	<span class="n">bulk_data</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">time_now</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
	<span class="n">time</span><span class="o">=-</span><span class="mf">3359500000.0</span>

	<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements_list</span><span class="p">:</span>
		<span class="n">x</span><span class="o">=</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">element</span><span class="p">,</span><span class="s1">&#39;x_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">-</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">element</span><span class="p">,</span><span class="s1">&#39;x_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
		<span class="n">y</span><span class="o">=</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">element</span><span class="p">,</span><span class="s1">&#39;y_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">-</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">element</span><span class="p">,</span><span class="s1">&#39;y_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
		<span class="n">z</span><span class="o">=</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">element</span><span class="p">,</span><span class="s1">&#39;z_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">-</span><span class="n">flow_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;ELEME2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">element</span><span class="p">,</span><span class="s1">&#39;z_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
		<span class="n">bulk_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">element</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;model_version&#39;</span><span class="p">],</span><span class="n">time_now</span><span class="p">])</span>


	<span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">,</span><span class="s1">&#39;FLOF_x&#39;</span><span class="p">,</span><span class="s1">&#39;FLOF_y&#39;</span><span class="p">,</span><span class="s1">&#39;FLOF_z&#39;</span><span class="p">,</span><span class="s1">&#39;model_time&#39;</span><span class="p">,</span><span class="s1">&#39;model_version&#39;</span><span class="p">,</span><span class="s1">&#39;model_output_timestamp&#39;</span><span class="p">]</span>

	<span class="n">flows_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bulk_data</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>

	<span class="c1">#Writing the dataframe into the database</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">flows_df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;t2FLOWVectors&#39;</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">,</span><span class="n">con</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<div class="viewcode-block" id="src_csv"><a class="viewcode-back" href="../modules/output.html#output.src_csv">[docs]</a><span class="k">def</span> <span class="nf">src_csv</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates an output file containing flow and flowing enthalpy for each GEN element from the T2 .csv output file. As a convention the library it is suggested to use GEN for any source/sink that is not a well</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  {GEN}_{BLOCK}_{NICKNAME}.txt : on  ../output/mh/txt</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="c1">#List the GEN elements</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
	<span class="n">data_source</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well,blockcorr,source_nickname FROM t2wellsource WHERE source_nickname NOT LIKE&#39;GEN*&#39; ORDER BY source_nickname;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="c1">#It reads the gener.csv output file line by line and store the data from each GEN element</span>
	<span class="n">poss_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../model/t2/t2_gener.csv&quot;</span><span class="p">]</span>
	<span class="n">poss_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
	<span class="n">output_t2_file</span> <span class="o">=</span> <span class="kc">None</span> 
	<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">poss_names</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
			<span class="n">output_t2_file</span> <span class="o">=</span> <span class="n">file</span>

	<span class="k">if</span> <span class="n">output_t2_file</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;No output file located&quot;</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="c1">#Initialize a dictionary containing the file path and name.</span>
		<span class="n">dictionary_files</span><span class="o">=</span><span class="p">{}</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_source</span><span class="p">)):</span>
			<span class="n">well</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
			<span class="n">blockcorr</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
			<span class="n">source</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;source_nickname&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
			<span class="n">dictionary_files</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span><span class="s2">&quot;../output/mh/txt/</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_evol_mh.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">blockcorr</span><span class="p">,</span><span class="n">source</span><span class="p">),</span><span class="s1">&#39;file_container&#39;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">:</span><span class="n">blockcorr</span><span class="p">,</span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="n">source</span><span class="p">}</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">):</span>
			<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t2_file</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
					<span class="n">t2_array</span> <span class="o">=</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span>  <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span> <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="ow">or</span> <span class="s1">&#39;)&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
					<span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TIME&quot;</span><span class="p">)</span>

					<span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
						<span class="n">dictionary_files</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

				<span class="k">if</span> <span class="s2">&quot;TIME [sec]&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">time</span> <span class="o">=</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
					<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
						<span class="n">time</span> <span class="o">=</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>

				<span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span> <span class="ow">and</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
						<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
						<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
						<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
						<span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
						<span class="n">dictionary_files</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>

		<span class="nb">print</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">)</span>

		<span class="c1">#Creates a file for every GEN elemen</span>
		<span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
			<span class="n">t2_file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
			<span class="n">t2_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">])</span>
			<span class="n">t2_file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="gen_csv"><a class="viewcode-back" href="../modules/output.html#output.gen_csv">[docs]</a><span class="k">def</span> <span class="nf">gen_csv</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates an output file containing flow and flowing enthalpy for each GEN element from the T2 .csv output file. As a convention the library it is suggested to use GEN for any source/sink that is not a well</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  {GEN}_{BLOCK}_{NICKNAME}.txt : on  ../output/mh/txt</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="c1">#List the GEN elements</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
	<span class="n">data_source</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well,blockcorr,source_nickname FROM t2wellsource WHERE source_nickname  LIKE&#39;GEN*&#39; ORDER BY source_nickname;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="c1">#Initialize a dictionary containing the file path and name.</span>
	<span class="n">dictionary_files</span><span class="o">=</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_source</span><span class="p">)):</span>
		<span class="n">well</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">blockcorr</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">source</span><span class="o">=</span><span class="n">data_source</span><span class="p">[</span><span class="s1">&#39;source_nickname&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
		<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span><span class="s2">&quot;../output/mh/txt/</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_evol_mh.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">blockcorr</span><span class="p">,</span><span class="n">source</span><span class="p">),</span><span class="s1">&#39;file_container&#39;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">:</span><span class="n">blockcorr</span><span class="p">,</span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="n">source</span><span class="p">}</span>
		<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s2">&quot;ELEMENT,SOURCEINDEX,GENERATION RATE,ENTHALPY,FF(GAS),FF(AQ.),P(WB),TIME</span><span class="se">\n</span><span class="s2">&quot;</span>

	<span class="c1">#It reads the gener.csv output file line by line and store the data from each GEN element</span>
	<span class="n">output_t2_file</span><span class="o">=</span><span class="s2">&quot;../model/t2/t2_gener.csv&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">):</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="n">t2_file</span><span class="p">:</span>
			<span class="k">if</span> <span class="s2">&quot;TIME [sec]&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
				<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span> <span class="ow">and</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
					<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span> <span class="p">]</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">10</span><span class="p">]]</span>
					<span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
					<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>

	<span class="c1">#Creates a file for every GEN elemen</span>
	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
		<span class="n">t2_file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">])</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="eleme_CSV"><a class="viewcode-back" href="../modules/output.html#output.eleme_CSV">[docs]</a><span class="k">def</span> <span class="nf">eleme_CSV</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="c1">#List the GEN elements</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">dictionary_files</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="n">data_block</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well, blockcorr FROM t2wellblock  ORDER BY blockcorr;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_block</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">blockcorr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]):</span>
			<span class="n">dictionary_files</span><span class="p">[</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span><span class="s2">&quot;../output/PT/evol/</span><span class="si">%s</span><span class="s2">_PT_evol.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]),</span>\
			                                                <span class="s1">&#39;file_container&#39;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">:</span><span class="n">blockcorr</span><span class="p">}</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Store data on the table t2wellblock&quot;</span><span class="p">)</span>

	<span class="c1">#It reads the gener.csv output file line by line and store the data from each GEN element</span>
	<span class="n">poss_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../model/t2/t2_XYZ.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;../model/t2/t2_eleme.csv&quot;</span><span class="p">]</span>
	<span class="n">poss_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
	<span class="n">output_t2_file</span> <span class="o">=</span> <span class="kc">None</span> 
	<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">poss_names</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
			<span class="n">output_t2_file</span> <span class="o">=</span> <span class="n">file</span>

	<span class="k">if</span> <span class="n">output_t2_file</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;No output file located&quot;</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t2_file</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span>  <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span> <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="ow">or</span> <span class="s1">&#39;)&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
				<span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;TIME&quot;</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
					<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">if</span> <span class="s2">&quot;TIME [sec]&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
				<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
					<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
					<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
					<span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
					<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="c1">#Creates a file for every block elemen</span>
	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
		<span class="n">t2_file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">])</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="eleme_CSV_PT"><a class="viewcode-back" href="../modules/output.html#output.eleme_CSV_PT">[docs]</a><span class="k">def</span> <span class="nf">eleme_CSV_PT</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">def_time</span> <span class="o">=</span> <span class="mi">300</span><span class="p">):</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>

	<span class="c1">#List the GEN elements</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">dictionary_files</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="n">data_block</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well, blockcorr FROM t2wellblock  ORDER BY blockcorr;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_block</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">blockcorr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]):</span>
			<span class="n">dictionary_files</span><span class="p">[</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span><span class="s2">&quot;../output/PT/txt/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">data_block</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]),</span>\
			                                                <span class="s1">&#39;file_container&#39;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">:</span><span class="n">blockcorr</span><span class="p">}</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Store data on the table t2wellblock&quot;</span><span class="p">)</span>

	<span class="n">time</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1E50</span>

	<span class="c1">#It reads the gener.csv output file line by line and store the data from each GEN element</span>
	<span class="n">poss_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../model/t2/t2_XYZ.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;../model/t2/t2_eleme.csv&quot;</span><span class="p">]</span>
	<span class="n">poss_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
	<span class="n">output_t2_file</span> <span class="o">=</span> <span class="kc">None</span> 
	<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">poss_names</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
			<span class="n">output_t2_file</span> <span class="o">=</span> <span class="n">file</span>

	<span class="k">if</span> <span class="n">output_t2_file</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;No output file located&quot;</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t2_file</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span>  <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span> <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="ow">or</span> <span class="s1">&#39;)&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
				<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
					<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">if</span> <span class="s2">&quot;TIME [sec]&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
				<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="n">def_time</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
						<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
						<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
						<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
						<span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">if</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="n">def_time</span><span class="p">:</span>
				<span class="k">break</span>
		<span class="n">t2_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="c1">#Creates a file for every block elemen</span>
	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">dictionary_files</span><span class="p">:</span>
		<span class="n">t2_file_out</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dictionary_files</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;file_container&#39;</span><span class="p">])</span>
		<span class="n">t2_file_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	

	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="t2_CSV_to_json"><a class="viewcode-back" href="../modules/output.html#output.t2_CSV_to_json">[docs]</a><span class="k">def</span> <span class="nf">t2_CSV_to_json</span><span class="p">(</span><span class="n">itime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">all_times</span> <span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It creates a severals or a single json file from the output file from the TOUGH2 run</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd"> 	itime: float</span>
<span class="sd">	  It defines a time at which a the parameters from the blocks are extracted into json file. Must be on the same units as the TOUGH2 output files (days, seconds, etc.)</span>
<span class="sd">	save_full: bool</span>
<span class="sd">	  If True it creates a single output json file</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	files</span>
<span class="sd">	  t2_ouput_{time}.json: on ../output/PT/json/evol/</span>
<span class="sd">	file</span>
<span class="sd">	  t2_output:  on ../output/PT/json/</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	When t2_output is saved, the large could be too large for the system to handle it</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; t2_to_json()</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">block_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">block_json_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">blocks</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist, run ELEM_to_json from regeo_mesh&quot;</span><span class="o">%</span><span class="n">output_t2_file</span><span class="p">)</span>		  	


	<span class="c1">#It reads the gener.csv output file line by line and store the data from each GEN element</span>
	<span class="n">poss_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../model/t2/t2_XYZ.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;../model/t2/t2_eleme.csv&quot;</span><span class="p">]</span>
	<span class="n">poss_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
	<span class="n">output_t2_file</span> <span class="o">=</span> <span class="kc">None</span> 
	<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">poss_names</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
			<span class="n">output_t2_file</span> <span class="o">=</span> <span class="n">file</span>

	<span class="k">if</span> <span class="n">output_t2_file</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;No output file located&quot;</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		
		<span class="n">cnt_t</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		file =  open(output_t2_file, &#39;r&#39;)</span>
<span class="sd">		data_file = file.read()</span>
<span class="sd">		count = data_file.count(&quot;TIME&quot;)</span>
<span class="sd">		file.close()</span>
<span class="sd">		&quot;&quot;&quot;</span>

		<span class="n">count</span> <span class="o">=</span> <span class="mi">400</span>

		<span class="k">if</span> <span class="n">num</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

		<span class="n">t2_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">output_t2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t2_line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t2_file</span><span class="p">):</span>

			<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
				<span class="n">param_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
				<span class="n">param_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span>  <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">param_list</span> <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="ow">or</span> <span class="s1">&#39;)&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
				<span class="n">param_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">param_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>

			<span class="k">if</span> <span class="s2">&quot;TIME [sec]&quot;</span> <span class="ow">in</span> <span class="n">t2_line</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">cnt_t</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span> <span class="c1">#takes the previous time and save it</span>
					<span class="n">t2_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data_dictionary</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
					<span class="n">t2_pd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;../output/PT/json/evol/t2_output_</span><span class="si">%.0f</span><span class="s1">.json&#39;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
				
				<span class="k">try</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
					<span class="n">cnt_t</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
					<span class="n">time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
					<span class="n">cnt_t</span> <span class="o">+=</span> <span class="mi">1</span>

				<span class="n">data_dictionary</span><span class="o">=</span> <span class="p">{}</span>	
				<span class="n">data_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

				<span class="k">if</span> <span class="ow">not</span> <span class="n">all_times</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="n">itime</span><span class="p">:</span>
						<span class="k">break</span>

			<span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="s1">&#39;TIME&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t2_line</span> <span class="ow">and</span> <span class="n">cnt_t</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
				<span class="n">t2_array</span><span class="o">=</span><span class="n">t2_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">t2_array</span><span class="p">))</span>
				<span class="n">block</span> <span class="o">=</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
				<span class="n">data_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">][</span><span class="n">block</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
				<span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
				<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param_list</span><span class="p">):</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">data_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">][</span><span class="n">block</span><span class="p">][</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">str_list</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
					<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
						<span class="n">data_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">][</span><span class="n">block</span><span class="p">][</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">str_list</span><span class="p">[</span><span class="n">n</span><span class="p">]</span></div>


<div class="viewcode-block" id="total_enthalpy"><a class="viewcode-back" href="../modules/output.html#output.total_enthalpy">[docs]</a><span class="k">def</span> <span class="nf">total_enthalpy</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">wells</span><span class="p">,</span> <span class="n">years</span> <span class="o">=</span> <span class="mi">35</span><span class="p">):</span>


	<span class="c1">#data[&#39;date_time&#39;] = pd.date_range(start= input_dictionary[&#39;ref_date&#39;], end= input_dictionary[&#39;ref_date&#39;]+datetime.timedelta(days=years*365.25), freq = &#39;D&#39; )</span>

	<span class="n">data_p</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mh&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
	

	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>

		<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mh&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
		
		<span class="n">data_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/mh/</span><span class="si">%s</span><span class="s2">_mh.dat&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;total_flow&#39;</span><span class="p">,</span> <span class="s1">&#39;enthalpy&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;steam&#39;</span><span class="p">])</span>
		<span class="n">data_x</span> <span class="o">=</span> <span class="n">data_x</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_x</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">data_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H:%M:%S&quot;</span><span class="p">)</span>

		
		<span class="n">data_ix</span> <span class="o">=</span> <span class="n">data_x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">data_ix</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">data_ix</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span>
		<span class="k">del</span> <span class="n">data_ix</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span>
		<span class="n">data_ii_inter_x</span> <span class="o">=</span> <span class="n">data_ix</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
		<span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="o">.</span><span class="n">index</span>


		<span class="k">if</span> <span class="n">wells</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;producer&#39;</span><span class="p">:</span>
			<span class="n">data</span><span class="p">[</span><span class="s1">&#39;mh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;total_flow&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;enthalpy&#39;</span><span class="p">]</span>
			<span class="n">data</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;total_flow&#39;</span><span class="p">]</span>
			<span class="n">data</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span>

			<span class="n">data_p</span> <span class="o">=</span> <span class="n">data_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

	<span class="n">data_p</span> <span class="o">=</span> <span class="n">data_p</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date_time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

	<span class="n">data_p</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_p</span><span class="p">[</span><span class="s1">&#39;mh&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">data_p</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span>

	<span class="n">data_p</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../input/mh/total_prod_mh.csv&#39;</span> <span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span></div>



<div class="viewcode-block" id="power"><a class="viewcode-back" href="../modules/output.html#output.power">[docs]</a><span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">WHP</span><span class="p">):</span>

	<span class="k">def</span> <span class="nf">power_i</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span><span class="n">hx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">ESC</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">mx</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">quality</span> <span class="o">=</span> <span class="n">IAPWS97</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">Px</span><span class="o">+</span><span class="mf">0.092</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">hx</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>
				<span class="n">power</span> <span class="o">=</span> <span class="o">-</span><span class="n">quality</span><span class="o">*</span><span class="n">mx</span><span class="o">/</span><span class="n">ESC</span>
			<span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Out of bounds, Pressure:&quot;</span><span class="p">,</span> <span class="n">Px</span><span class="p">,</span><span class="s2">&quot;[bar], Enthalpy: &quot;</span><span class="p">,</span><span class="n">hx</span><span class="p">,</span> <span class="s2">&quot;[kJ/kg]&quot;</span><span class="p">)</span>
				<span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">return</span> <span class="n">power</span>
		
	<span class="n">data_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">])</span>
	<span class="n">data_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">])</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">well_sources</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM t2wellsource WHERE well LIKE &#39;TR-%&#39;&quot;</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">well_sources</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> 
		<span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">WHP</span><span class="p">]:</span>

			<span class="n">evol_file</span> <span class="o">=</span> <span class="s1">&#39;../output/PT/evol/</span><span class="si">%s</span><span class="s1">_PT_evol.dat&#39;</span><span class="o">%</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">]</span>

			<span class="n">data_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">evol_file</span><span class="p">)</span>

			<span class="n">temp_i</span> <span class="o">=</span> <span class="n">data_i</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">data_i</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span> <span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_i</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="p">),</span> <span class="p">[</span><span class="s1">&#39;PRES_VAP&#39;</span><span class="p">,</span><span class="s1">&#39;TIME&#39;</span><span class="p">]]</span>
			<span class="n">temp_i</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

			<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;../output/mh/txt/</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_evol_mh.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;blockcorr&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;source_nickname&#39;</span><span class="p">])</span>

			<span class="n">data_mh</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

			<span class="n">times</span> <span class="o">=</span> <span class="n">data_mh</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

			<span class="n">dates</span><span class="o">=</span><span class="p">[]</span>
			<span class="n">enthalpy</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">flow_rate</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">pressures</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">power</span> <span class="o">=</span> <span class="p">[]</span>

			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">pressures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_i</span><span class="p">[</span><span class="s1">&#39;PRES_VAP&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">])</span>
						<span class="n">enthalpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_mh</span><span class="p">[</span><span class="s1">&#39;ENTH&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="mf">1E3</span><span class="p">)</span>
						<span class="n">flow_rate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_mh</span><span class="p">[</span><span class="s1">&#39;GEN&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">])</span>
						<span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>
						
						<span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">WHP</span><span class="p">]:</span>
							<span class="n">power</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power_i</span><span class="p">(</span><span class="n">WHP</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1E6</span><span class="p">,</span><span class="n">data_mh</span><span class="p">[</span><span class="s1">&#39;ENTH&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="mf">1E3</span><span class="p">,</span><span class="n">data_mh</span><span class="p">[</span><span class="s1">&#39;GEN&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">WHP</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">]][</span><span class="mi">1</span><span class="p">]))</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">power</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

					<span class="k">except</span> <span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>

			<span class="n">input_row</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;date_time&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span>
			                 <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="n">enthalpy</span><span class="p">,</span>
			                 <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="n">flow_rate</span><span class="p">,</span>
			               <span class="s1">&#39;BWP&#39;</span><span class="p">:</span> <span class="n">pressures</span><span class="p">,</span>
			               <span class="s1">&#39;power&#39;</span><span class="p">:</span><span class="n">power</span><span class="p">}</span>

			<span class="n">output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">input_row</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">WHP</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">]][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1_2&#39;</span><span class="p">:</span>
				<span class="n">data_12</span> <span class="o">=</span> <span class="n">data_12</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">WHP</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;well&#39;</span><span class="p">]][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
				<span class="n">data_3</span> <span class="o">=</span> <span class="n">data_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

	<span class="n">data_12</span> <span class="o">=</span> <span class="n">data_12</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> 
	<span class="n">data_3</span> <span class="o">=</span> <span class="n">data_3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> 


	<span class="n">data_12</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../output/unit_12_power.csv&#39;</span><span class="p">)</span>
	<span class="n">data_3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../output/unit_3_power.csv&#39;</span><span class="p">)</span></div>
		


<div class="viewcode-block" id="field_areas_enthalpy"><a class="viewcode-back" href="../modules/output.html#output.field_areas_enthalpy">[docs]</a><span class="k">def</span> <span class="nf">field_areas_enthalpy</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>


	<span class="n">data_p_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mh&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
	<span class="n">data_p_3_17</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mh&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
	<span class="n">data_p_3_18</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mh&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
	
	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>

		<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mh&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
		
		<span class="n">data_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/mh/</span><span class="si">%s</span><span class="s2">_mh.dat&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">,</span> <span class="s1">&#39;total_flow&#39;</span><span class="p">,</span> <span class="s1">&#39;enthalpy&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;steam&#39;</span><span class="p">])</span>
		<span class="n">data_x</span> <span class="o">=</span> <span class="n">data_x</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_x</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">data_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H:%M:%S&quot;</span><span class="p">)</span>

		
		<span class="n">data_ix</span> <span class="o">=</span> <span class="n">data_x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">data_ix</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">data_ix</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span>
		<span class="k">del</span> <span class="n">data_ix</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span>
		<span class="n">data_ii_inter_x</span> <span class="o">=</span> <span class="n">data_ix</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
		<span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="o">.</span><span class="n">index</span>


		<span class="n">data</span><span class="p">[</span><span class="s1">&#39;mh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;total_flow&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;enthalpy&#39;</span><span class="p">]</span>
		<span class="n">data</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;total_flow&#39;</span><span class="p">]</span>
		<span class="n">data</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ii_inter_x</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span>

		<span class="k">if</span> <span class="n">wells</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1_2&#39;</span><span class="p">:</span>
			<span class="n">data_p_12</span> <span class="o">=</span> <span class="n">data_p_12</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">wells</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
			<span class="k">if</span> <span class="s1">&#39;17&#39;</span> <span class="ow">in</span> <span class="n">well</span><span class="p">:</span>
				<span class="n">data_p_3_17</span> <span class="o">=</span> <span class="n">data_p_3_17</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
			<span class="k">elif</span> <span class="s1">&#39;18&#39;</span> <span class="ow">in</span> <span class="n">well</span><span class="p">:</span>
				<span class="n">data_p_3_18</span> <span class="o">=</span> <span class="n">data_p_3_18</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

	<span class="n">data_p_12</span> <span class="o">=</span> <span class="n">data_p_12</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date_time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

	<span class="n">data_p_12</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_p_12</span><span class="p">[</span><span class="s1">&#39;mh&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">data_p_12</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span>

	<span class="n">data_p_12</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../input/mh/unit12_mh.csv&#39;</span> <span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


	<span class="n">data_p_3_17</span> <span class="o">=</span> <span class="n">data_p_3_17</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date_time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

	<span class="n">data_p_3_17</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_p_3_17</span><span class="p">[</span><span class="s1">&#39;mh&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">data_p_3_17</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span>

	<span class="n">data_p_3_17</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../input/mh/unit3_17_mh.csv&#39;</span> <span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


	<span class="n">data_p_3_18</span> <span class="o">=</span> <span class="n">data_p_3_18</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date_time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

	<span class="n">data_p_3_18</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_p_3_18</span><span class="p">[</span><span class="s1">&#39;mh&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">data_p_3_18</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span>

	<span class="n">data_p_3_18</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../input/mh/unit3_18_mh.csv&#39;</span> <span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Erick Jimenez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>