

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>regeo_mesh &mdash; T2GEORES  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> T2GEORES
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/gener.html">gener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/geometry.html">geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/it2Obs.html">it2Obs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/model_plots.html">model_plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/output.html">output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/regeo_mesh.html">regeo_mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/run.html">run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/t2geores_functions.html">t2geores_functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/txt2sqlite.html">txt2sqlite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/writer.html">writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/formats.html">formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/report.html">report</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">T2GEORES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>regeo_mesh</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for regeo_mesh</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">T2GEORES</span> <span class="kn">import</span> <span class="n">geometry</span> <span class="k">as</span> <span class="n">geometry</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span> <span class="k">as</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">shapefile</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plb</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">ConvexHull</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">FormatStrFormatter</span><span class="p">,</span><span class="n">AutoMinorLocator</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
<span class="kn">import</span> <span class="nn">vtk</span>

<div class="viewcode-block" id="py2amesh"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh">[docs]</a><span class="k">class</span> <span class="nc">py2amesh</span><span class="p">:</span>
	<span class="sd">&quot;&quot;&quot;It creates a mesh based on well positions and irregular blocks</span>

<span class="sd">	The main characteristics are:</span>

<span class="sd">	-It generates the mesh based on defined boundaries</span>

<span class="sd">	-The inner section is called wellfield and can contain elements with hexagonal  or square shape</span>

<span class="sd">	-The wellfield can be delimited by a shapefile or by fixed squared boundaries.</span>

<span class="sd">	-It allows to generates elements along a line to represent structures.</span>

<span class="sd">	-The voronoi elements are generated by AMESH.</span>

<span class="sd">	-The elements name cannot contain two consecutive zeros.</span>

<span class="sd">	-The well blocks are the first on the list</span>

<span class="sd">	-It creates the input files to work on Steinar (RockEditor)</span>

<span class="sd">	-It can export a defined layer on a shapefile format</span>

<span class="sd">	-It can plot a selected layer (It is recommended to use the function plot_voronoi() to plot) </span>

<span class="sd">	-Two json file are generated with the correlative block for each well, from which can be track during all the modelling steps.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	filename : str</span>
<span class="sd">	    File name with well feedzone location</span>
<span class="sd">	filepath : str</span>
<span class="sd">		Path of input files</span>
<span class="sd">	Xmin  : float</span>
<span class="sd">		Minimun X coordinates for the grid </span>
<span class="sd">	Xmax : float</span>
<span class="sd">		Maximun X coordinates for the grid </span>
<span class="sd">	Ymin : float</span>
<span class="sd">		Minimun Y coordinates for the grid </span>
<span class="sd">	Ymax : float</span>
<span class="sd">		Maximun Y coordinates for the grid </span>
<span class="sd">	toler : float</span>
<span class="sd">		AMESH parameter</span>
<span class="sd">	layers : dictionary</span>
<span class="sd">		Name (correlative) and thickness of every layer on the model, keyword on input_dictionary</span>
<span class="sd">	layer_to_plot : int</span>
<span class="sd">		In case it is specified a voronoi plot will be performed</span>
<span class="sd">	x_space : float</span>
<span class="sd">		Horizontal distance between elements for the outerfield</span>
<span class="sd">	y_space : float</span>
<span class="sd">		Vertical distance between elements for the outerfield</span>
<span class="sd">	radius_criteria: float</span>
<span class="sd">		Minimun distance between well location and a regular element</span>
<span class="sd">	x_from_boarder: float</span>
<span class="sd">		Horizontal distance from the first element to the east border</span>
<span class="sd">	y_from_boarder: float</span>
<span class="sd">		Vertical distance from the first element to the south border</span>
<span class="sd">	x_gap_min: float</span>
<span class="sd">		Minimun X coordinates on the grid for the well field </span>
<span class="sd">	x_gap_max: float</span>
<span class="sd">		Maximun X coordinates on the grid for the well field </span>
<span class="sd">	x_gap_space: float</span>
<span class="sd">		Horizontal distance between elements for the farfield</span>
<span class="sd">	y_gap_min: float</span>
<span class="sd">		Minimun Y coordinates on the grid for the well field o</span>
<span class="sd">	y_gap_max: float</span>
<span class="sd">		Maximun X coordinates on the grid for the well field </span>
<span class="sd">	y_gap_space: float</span>
<span class="sd">		Vertical distance between elements for the farfield</span>
<span class="sd">	plot_names: bool</span>
<span class="sd">		If true it plots the name of the blocks from the selected layer to plot</span>
<span class="sd">	plot_centers: bool</span>
<span class="sd">		If true it plots the centers of the blocks from the selected layer to plot</span>
<span class="sd">	z0_level: float</span>
<span class="sd">		Reference level (elevation) for all the grid, keyword on input_dictionary</span>
<span class="sd">	mesh_creation: bool</span>
<span class="sd">		If true the mesh is created</span>
<span class="sd">	plot_layer: bool</span>
<span class="sd">		If true it plots the selected layer</span>
<span class="sd">	to_steinar: bool</span>
<span class="sd">		If true it creates the input files for steinar</span>
<span class="sd">	to_GIS: bool</span>
<span class="sd">		If true it generates a shapefile of the selected layer</span>
<span class="sd">	plot_all_GIS: bool</span>
<span class="sd">		If true it generates a shapefile of all  layers</span>
<span class="sd">	from_leapfrog: bool</span>
<span class="sd">		lee archivos leapfrong ../mesh/from_leapfrog/LF_geometry.dat y ../mesh/from_leapfrog/LF_t2.dat, sin embargo se pierde la simbologia usada en leapfrog y no te utiliza la malla regular ni los pozos. Solamente se crea la malla utilizando amesh</span>
<span class="sd">	line_file: str</span>
<span class="sd">		It defines the path and name of a line that can represented a fault or other structure on the mesh, The input file must contain the header: ID,X,Y on csv format. ID referes to the same</span>
<span class="sd">		structure, thus, more than one structure can be defined on a single file.</span>
<span class="sd">	fault_distance: float</span>
<span class="sd">		In case a line_file is define, some paralels elements will be created at a defined distance</span>
<span class="sd">	with_polygon: bool</span>
<span class="sd">		If true a shapefile will be read to define the wellfield.</span>
<span class="sd">	polygon_shape: str</span>
<span class="sd">		The shapefile deines the wellfield boundaries. The shape must not contain any cavity</span>
<span class="sd">	set_inac_from_poly: bool</span>
<span class="sd">		If true all the elements on the outside of the shapefile are defined as inactive</span>
<span class="sd">	set_inac_from_inner:bool</span>
<span class="sd">		If true all the elements on the outerfield are defined as inactive</span>
<span class="sd">	rotate: bool</span>
<span class="sd">	    If true it rotates the mesh a defined angle</span>
<span class="sd">	angle: float</span>
<span class="sd">	    Angle in degrees</span>
<span class="sd">	inner_mesh_type: string</span>
<span class="sd">	    Type of mesh on the inner part of the mesh, it could be &#39;honeycomb&#39; or &#39;regular&#39;</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  eleme: list of blocks from the grid</span>
<span class="sd">	file</span>
<span class="sd">	  conne : list of connections on the grid</span>
<span class="sd">	shapefile</span>
<span class="sd">	  mesh_{field}_layer_{layer} : shapefile of a defined (or all) layer including rock distribution</span>
<span class="sd">	plot</span>
<span class="sd">	  Voronoi plot (in case is specified)</span>
<span class="sd">	  </span>
<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	A copy of AMESH must be on the path or directory</span>


<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">filepath</span><span class="p">,</span><span class="n">Xmin</span><span class="p">,</span><span class="n">Xmax</span><span class="p">,</span><span class="n">Ymin</span><span class="p">,</span><span class="n">Ymax</span><span class="p">,</span>\
		<span class="n">toler</span><span class="p">,</span><span class="n">layers</span><span class="p">,</span><span class="n">layer_to_plot</span><span class="p">,</span><span class="n">x_space</span><span class="p">,</span><span class="n">y_space</span><span class="p">,</span><span class="n">radius_criteria</span><span class="p">,</span>\
		<span class="n">x_from_boarder</span><span class="p">,</span><span class="n">y_from_boarder</span><span class="p">,</span>\
		<span class="n">x_gap_min</span><span class="p">,</span><span class="n">x_gap_max</span><span class="p">,</span><span class="n">x_gap_space</span><span class="p">,</span><span class="n">y_gap_min</span><span class="p">,</span><span class="n">y_gap_max</span><span class="p">,</span><span class="n">y_gap_space</span><span class="p">,</span>\
		<span class="n">plot_names</span><span class="p">,</span><span class="n">plot_centers</span><span class="p">,</span><span class="n">z0_level</span><span class="p">,</span><span class="n">plot_all_GIS</span><span class="p">,</span><span class="n">from_leapfrog</span><span class="p">,</span><span class="n">line_file</span><span class="p">,</span><span class="n">fault_distance</span><span class="p">,</span><span class="n">with_polygon</span><span class="p">,</span><span class="n">polygon_shape</span><span class="p">,</span><span class="n">set_inac_from_poly</span><span class="p">,</span><span class="n">set_inac_from_inner</span><span class="p">,</span><span class="n">rotate</span><span class="p">,</span><span class="n">angle</span><span class="p">,</span><span class="n">inner_mesh_type</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">=</span><span class="n">filepath</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">=</span><span class="n">layers</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">number_of_layer</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span><span class="o">=</span><span class="n">Xmin</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">Xmax</span><span class="o">=</span><span class="n">Xmax</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span><span class="o">=</span><span class="n">Ymin</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">Ymax</span><span class="o">=</span><span class="n">Ymax</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">z0_level</span><span class="o">=</span><span class="n">z0_level</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">layer_to_plot</span><span class="o">=</span><span class="n">layer_to_plot</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">radius_criteria</span><span class="o">=</span><span class="n">radius_criteria</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">x_space</span><span class="o">=</span><span class="n">x_space</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y_space</span><span class="o">=</span><span class="n">y_space</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">x_from_boarder</span><span class="o">=</span><span class="n">x_from_boarder</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y_from_boarder</span><span class="o">=</span><span class="n">y_from_boarder</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">delf_rock</span><span class="o">=</span><span class="s2">&quot;101&quot;</span>  <span class="c1">#Layer index</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">filename_out</span><span class="o">=</span><span class="s2">&quot;in&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">toler</span><span class="o">=</span><span class="n">toler</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">x_gap_min</span><span class="o">=</span><span class="n">x_gap_min</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x_gap_max</span><span class="o">=</span><span class="n">x_gap_max</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="o">=</span><span class="n">x_gap_space</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y_gap_min</span><span class="o">=</span><span class="n">y_gap_min</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y_gap_max</span><span class="o">=</span><span class="n">y_gap_max</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y_gap_space</span><span class="o">=</span><span class="n">y_gap_space</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">plot_names</span><span class="o">=</span><span class="n">plot_names</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">plot_centers</span><span class="o">=</span><span class="n">plot_centers</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">plot_all_GIS</span><span class="o">=</span><span class="n">plot_all_GIS</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">from_leapfrog</span><span class="o">=</span><span class="n">from_leapfrog</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">line_file</span><span class="o">=</span><span class="n">line_file</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fault_distance</span><span class="o">=</span><span class="n">fault_distance</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">with_polygon</span><span class="o">=</span><span class="n">with_polygon</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_inac_from_poly</span><span class="o">=</span><span class="n">set_inac_from_poly</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_inac_from_inner</span><span class="o">=</span><span class="n">set_inac_from_inner</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="o">=</span><span class="n">rotate</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="o">=</span><span class="n">angle</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">inner_mesh_type</span><span class="o">=</span><span class="n">inner_mesh_type</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_polygon</span><span class="p">:</span>
			<span class="n">shape</span> <span class="o">=</span> <span class="n">shapefile</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">polygon_shape</span><span class="p">)</span>

			<span class="c1">#first feature of the shapefile</span>
			<span class="n">feature</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">shapeRecords</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">points</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">__geo_interface__</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">=</span><span class="p">[]</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">points</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
					<span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="s1">&#39;coordinates&#39;</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="c1"># (GeoJSON format)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[[</span><span class="s1">&#39;AA&#39;</span><span class="p">,</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span><span class="s1">&#39;AC&#39;</span><span class="p">,</span><span class="s1">&#39;AD&#39;</span><span class="p">,</span><span class="s1">&#39;AE&#39;</span><span class="p">,</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span><span class="s1">&#39;AG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK1&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span>\
						   <span class="mi">2</span><span class="p">:[[</span><span class="s1">&#39;BA&#39;</span><span class="p">,</span><span class="s1">&#39;BB&#39;</span><span class="p">,</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span><span class="s1">&#39;BD&#39;</span><span class="p">,</span><span class="s1">&#39;BE&#39;</span><span class="p">,</span><span class="s1">&#39;BF&#39;</span><span class="p">,</span><span class="s1">&#39;BG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK2&#39;</span><span class="p">,</span><span class="s1">&#39;white&#39;</span><span class="p">],</span>\
						   <span class="mi">3</span><span class="p">:[[</span><span class="s1">&#39;CA&#39;</span><span class="p">,</span><span class="s1">&#39;CB&#39;</span><span class="p">,</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span><span class="s1">&#39;CD&#39;</span><span class="p">,</span><span class="s1">&#39;CE&#39;</span><span class="p">,</span><span class="s1">&#39;CF&#39;</span><span class="p">,</span><span class="s1">&#39;CG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK3&#39;</span><span class="p">,</span><span class="s1">&#39;yellow&#39;</span><span class="p">],</span>\
						   <span class="mi">4</span><span class="p">:[[</span><span class="s1">&#39;DA&#39;</span><span class="p">,</span><span class="s1">&#39;DB&#39;</span><span class="p">,</span><span class="s1">&#39;DC&#39;</span><span class="p">,</span><span class="s1">&#39;DD&#39;</span><span class="p">,</span><span class="s1">&#39;DE&#39;</span><span class="p">,</span><span class="s1">&#39;DF&#39;</span><span class="p">,</span><span class="s1">&#39;DG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK4&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">],</span>\
						   <span class="mi">5</span><span class="p">:[[</span><span class="s1">&#39;EA&#39;</span><span class="p">,</span><span class="s1">&#39;EB&#39;</span><span class="p">,</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span><span class="s1">&#39;ED&#39;</span><span class="p">,</span><span class="s1">&#39;EE&#39;</span><span class="p">,</span><span class="s1">&#39;EF&#39;</span><span class="p">,</span><span class="s1">&#39;EG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK5&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">],</span>\
						   <span class="mi">6</span><span class="p">:[[</span><span class="s1">&#39;FA&#39;</span><span class="p">,</span><span class="s1">&#39;FB&#39;</span><span class="p">,</span><span class="s1">&#39;FC&#39;</span><span class="p">,</span><span class="s1">&#39;FD&#39;</span><span class="p">,</span><span class="s1">&#39;FE&#39;</span><span class="p">,</span><span class="s1">&#39;FF&#39;</span><span class="p">,</span><span class="s1">&#39;FG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK6&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">],</span>\
						   <span class="mi">7</span><span class="p">:[[</span><span class="s1">&#39;GA&#39;</span><span class="p">,</span><span class="s1">&#39;GB&#39;</span><span class="p">,</span><span class="s1">&#39;GC&#39;</span><span class="p">,</span><span class="s1">&#39;GD&#39;</span><span class="p">,</span><span class="s1">&#39;GE&#39;</span><span class="p">,</span><span class="s1">&#39;GF&#39;</span><span class="p">,</span><span class="s1">&#39;GG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK7&#39;</span><span class="p">,</span><span class="s1">&#39;#ff69b4&#39;</span><span class="p">],</span>\
						   <span class="mi">8</span><span class="p">:[[</span><span class="s1">&#39;HA&#39;</span><span class="p">,</span><span class="s1">&#39;HB&#39;</span><span class="p">,</span><span class="s1">&#39;HC&#39;</span><span class="p">,</span><span class="s1">&#39;HD&#39;</span><span class="p">,</span><span class="s1">&#39;HE&#39;</span><span class="p">,</span><span class="s1">&#39;HF&#39;</span><span class="p">,</span><span class="s1">&#39;HG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK8&#39;</span><span class="p">,</span><span class="s1">&#39;darkorange&#39;</span><span class="p">],</span>\
						   <span class="mi">9</span><span class="p">:[[</span><span class="s1">&#39;IA&#39;</span><span class="p">,</span><span class="s1">&#39;IB&#39;</span><span class="p">,</span><span class="s1">&#39;IC&#39;</span><span class="p">,</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;IE&#39;</span><span class="p">,</span><span class="s1">&#39;IF&#39;</span><span class="p">,</span><span class="s1">&#39;IG&#39;</span><span class="p">],</span><span class="s1">&#39;ROCK9&#39;</span><span class="p">,</span><span class="s1">&#39;cyan&#39;</span><span class="p">],</span>\
						   <span class="mi">10</span><span class="p">:[[</span><span class="s1">&#39;JA&#39;</span><span class="p">,</span><span class="s1">&#39;JB&#39;</span><span class="p">,</span><span class="s1">&#39;JC&#39;</span><span class="p">,</span><span class="s1">&#39;JD&#39;</span><span class="p">,</span><span class="s1">&#39;JE&#39;</span><span class="p">,</span><span class="s1">&#39;JF&#39;</span><span class="p">,</span><span class="s1">&#39;JG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK10&#39;</span><span class="p">,</span><span class="s1">&#39;magenta&#39;</span><span class="p">],</span>\
						   <span class="mi">11</span><span class="p">:[[</span><span class="s1">&#39;KA&#39;</span><span class="p">,</span><span class="s1">&#39;KB&#39;</span><span class="p">,</span><span class="s1">&#39;KC&#39;</span><span class="p">,</span><span class="s1">&#39;KD&#39;</span><span class="p">,</span><span class="s1">&#39;KE&#39;</span><span class="p">,</span><span class="s1">&#39;KF&#39;</span><span class="p">,</span><span class="s1">&#39;KG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK11&#39;</span><span class="p">,</span><span class="s1">&#39;#faebd7&#39;</span><span class="p">],</span>\
						   <span class="mi">12</span><span class="p">:[[</span><span class="s1">&#39;LA&#39;</span><span class="p">,</span><span class="s1">&#39;LB&#39;</span><span class="p">,</span><span class="s1">&#39;LC&#39;</span><span class="p">,</span><span class="s1">&#39;LD&#39;</span><span class="p">,</span><span class="s1">&#39;LE&#39;</span><span class="p">,</span><span class="s1">&#39;LF&#39;</span><span class="p">,</span><span class="s1">&#39;LG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK12&#39;</span><span class="p">,</span><span class="s1">&#39;#2e8b57&#39;</span><span class="p">],</span>\
						   <span class="mi">13</span><span class="p">:[[</span><span class="s1">&#39;MA&#39;</span><span class="p">,</span><span class="s1">&#39;MB&#39;</span><span class="p">,</span><span class="s1">&#39;MC&#39;</span><span class="p">,</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;ME&#39;</span><span class="p">,</span><span class="s1">&#39;MF&#39;</span><span class="p">,</span><span class="s1">&#39;MG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK13&#39;</span><span class="p">,</span><span class="s1">&#39;#eeefff&#39;</span><span class="p">],</span>\
						   <span class="mi">14</span><span class="p">:[[</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span><span class="s1">&#39;NB&#39;</span><span class="p">,</span><span class="s1">&#39;NC&#39;</span><span class="p">,</span><span class="s1">&#39;ND&#39;</span><span class="p">,</span><span class="s1">&#39;NE&#39;</span><span class="p">,</span><span class="s1">&#39;NF&#39;</span><span class="p">,</span><span class="s1">&#39;NG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK14&#39;</span><span class="p">,</span><span class="s1">&#39;#da70d6&#39;</span><span class="p">],</span>\
						   <span class="mi">15</span><span class="p">:[[</span><span class="s1">&#39;OA&#39;</span><span class="p">,</span><span class="s1">&#39;OB&#39;</span><span class="p">,</span><span class="s1">&#39;OC&#39;</span><span class="p">,</span><span class="s1">&#39;OD&#39;</span><span class="p">,</span><span class="s1">&#39;OE&#39;</span><span class="p">,</span><span class="s1">&#39;OF&#39;</span><span class="p">,</span><span class="s1">&#39;OG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK15&#39;</span><span class="p">,</span><span class="s1">&#39;#ff7f50&#39;</span><span class="p">],</span>\
						   <span class="mi">16</span><span class="p">:[[</span><span class="s1">&#39;PA&#39;</span><span class="p">,</span><span class="s1">&#39;PB&#39;</span><span class="p">,</span><span class="s1">&#39;PC&#39;</span><span class="p">,</span><span class="s1">&#39;PD&#39;</span><span class="p">,</span><span class="s1">&#39;PE&#39;</span><span class="p">,</span><span class="s1">&#39;PF&#39;</span><span class="p">,</span><span class="s1">&#39;PG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK16&#39;</span><span class="p">,</span><span class="s1">&#39;#cd853f&#39;</span><span class="p">],</span>\
						   <span class="mi">17</span><span class="p">:[[</span><span class="s1">&#39;QA&#39;</span><span class="p">,</span><span class="s1">&#39;QB&#39;</span><span class="p">,</span><span class="s1">&#39;QC&#39;</span><span class="p">,</span><span class="s1">&#39;QD&#39;</span><span class="p">,</span><span class="s1">&#39;QE&#39;</span><span class="p">,</span><span class="s1">&#39;QF&#39;</span><span class="p">,</span><span class="s1">&#39;QG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK17&#39;</span><span class="p">,</span><span class="s1">&#39;#bc8f8f&#39;</span><span class="p">],</span>\
						   <span class="mi">18</span><span class="p">:[[</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span><span class="s1">&#39;RB&#39;</span><span class="p">,</span><span class="s1">&#39;RC&#39;</span><span class="p">,</span><span class="s1">&#39;RD&#39;</span><span class="p">,</span><span class="s1">&#39;RE&#39;</span><span class="p">,</span><span class="s1">&#39;RF&#39;</span><span class="p">,</span><span class="s1">&#39;RG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK18&#39;</span><span class="p">,</span><span class="s1">&#39;#5f9ea0&#39;</span><span class="p">],</span>\
						   <span class="mi">19</span><span class="p">:[[</span><span class="s1">&#39;SA&#39;</span><span class="p">,</span><span class="s1">&#39;SB&#39;</span><span class="p">,</span><span class="s1">&#39;SC&#39;</span><span class="p">,</span><span class="s1">&#39;SD&#39;</span><span class="p">,</span><span class="s1">&#39;SE&#39;</span><span class="p">,</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="s1">&#39;SG&#39;</span><span class="p">],</span><span class="s1">&#39;ROK19&#39;</span><span class="p">,</span><span class="s1">&#39;#daa520&#39;</span><span class="p">]}</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="o">=</span><span class="p">{}</span>
		<span class="n">prof_cont</span><span class="o">=</span><span class="mi">0</span>
		<span class="k">for</span> <span class="n">jk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">jk</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">prof_cont</span><span class="o">=</span><span class="n">layers</span><span class="p">[</span><span class="n">jk</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span>
				<span class="n">z_real</span><span class="o">=</span><span class="n">z0_level</span><span class="o">-</span><span class="n">prof_cont</span>
			<span class="k">elif</span> <span class="n">jk</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">prof_cont</span><span class="o">=</span><span class="n">prof_cont</span><span class="o">+</span><span class="n">layers</span><span class="p">[</span><span class="n">jk</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="o">+</span><span class="n">layers</span><span class="p">[</span><span class="n">jk</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span>
				<span class="n">z_real</span><span class="o">=</span><span class="n">z0_level</span><span class="o">-</span><span class="n">prof_cont</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="p">[</span><span class="n">jk</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">jk</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">jk</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
			<span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">jk</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">jk</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">z_real</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">jk</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<div class="viewcode-block" id="py2amesh.regular_mesh"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.regular_mesh">[docs]</a>	<span class="k">def</span> <span class="nf">regular_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Genera malla regular en en toda la extension de la region definida por Xmin,Xmax,Ymin y Ymax</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">x_regular</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_space</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_space</span><span class="p">)</span>
		<span class="n">y_regular</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_space</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_space</span><span class="p">)</span>

		<span class="n">x_regular_small</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_min</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_max</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="p">)</span>
		<span class="n">y_regular_small</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_min</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_max</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_space</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_space</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">nx</span> <span class="ow">in</span> <span class="n">x_regular</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">ny</span> <span class="ow">in</span> <span class="n">y_regular</span><span class="p">:</span>
				<span class="k">if</span> <span class="p">((</span><span class="n">nx</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_min</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">nx</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_max</span><span class="p">))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">ny</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_min</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ny</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_max</span><span class="p">)):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">])</span>


		<span class="c1">#Small polygon area must be here</span>

		<span class="k">for</span> <span class="n">nxx</span> <span class="ow">in</span> <span class="n">x_regular_small</span><span class="p">:</span>
			<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
			<span class="k">for</span> <span class="n">nyy</span> <span class="ow">in</span> <span class="n">y_regular_small</span><span class="p">:</span>
				<span class="k">if</span> <span class="p">[</span><span class="n">nxx</span><span class="p">,</span><span class="n">nyy</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">:</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_mesh_type</span><span class="o">==</span><span class="s1">&#39;honeycomb&#39;</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">cnt</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nxx</span><span class="p">,</span><span class="n">nyy</span><span class="p">])</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nxx</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nyy</span><span class="p">])</span>
					<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_mesh_type</span><span class="o">==</span><span class="s1">&#39;regular&#39;</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nxx</span><span class="p">,</span><span class="n">nyy</span><span class="p">])</span>
					<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">:</span>
			<span class="n">angle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span>
			<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">)):</span>
				<span class="n">x1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span>
				<span class="n">y1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">-</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span>

		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">)</span></div>

<div class="viewcode-block" id="py2amesh.check_in_out"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.check_in_out">[docs]</a>	<span class="k">def</span> <span class="nf">check_in_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">point</span><span class="p">,</span><span class="n">source</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Verifica si un punto de la malla del campo cercano esta dentro o fuera del poligo definido por el shapefile de entrada o del campo cercano</span>
<span class="sd">		&quot;&quot;&quot;</span>

		<span class="n">boolean</span><span class="o">=</span><span class="kc">False</span>
		<span class="k">if</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;shapefile&#39;</span><span class="p">:</span>
			<span class="n">polygon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span>
			<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)):</span>
				<span class="k">if</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
					<span class="n">m</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">plb</span><span class="o">.</span><span class="n">polyfit</span><span class="p">([</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],[</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span><span class="mi">1</span><span class="p">)</span>
					<span class="n">val_range</span><span class="o">=</span><span class="p">[</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
				<span class="k">elif</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
					<span class="n">m</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">plb</span><span class="o">.</span><span class="n">polyfit</span><span class="p">([</span><span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],[</span><span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span><span class="mi">1</span><span class="p">)</span>
					<span class="n">val_range</span><span class="o">=</span><span class="p">[</span><span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
				
				<span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">m</span>
				<span class="k">if</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">x</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">val_range</span><span class="p">)</span><span class="o">&lt;</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">(</span><span class="n">val_range</span><span class="p">):</span>
					<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
			<span class="k">if</span> <span class="n">cnt</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">boolean</span><span class="o">=</span><span class="kc">True</span>
		<span class="k">elif</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;inner&#39;</span><span class="p">:</span>
			<span class="n">Xarray_inner</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_min</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_max</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="p">])</span>
			<span class="n">Yarray_inner</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_min</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_max</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_space</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">Xarray_inner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">Xarray_inner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">Yarray_inner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">Yarray_inner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
				<span class="n">boolean</span><span class="o">=</span><span class="kc">True</span>
		<span class="k">return</span> <span class="n">boolean</span></div>

<div class="viewcode-block" id="py2amesh.reg_pol_mesh"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.reg_pol_mesh">[docs]</a>	<span class="k">def</span> <span class="nf">reg_pol_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Crea malla regular cuando existe un poligono de entrada</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">x_regular</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_space</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_space</span><span class="p">)</span>
		<span class="n">y_regular</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_space</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_space</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">nx</span> <span class="ow">in</span> <span class="n">x_regular</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">ny</span> <span class="ow">in</span> <span class="n">y_regular</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">])</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">:</span>
			<span class="n">angle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span>
			<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">)):</span>
				<span class="n">x1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span>
				<span class="n">y1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">-</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span>


		<span class="n">x_pol</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">y_pol</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)):</span>
			<span class="n">x_pol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">y_pol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
		<span class="n">x_pol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
		<span class="n">y_pol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>


		<span class="n">x_gap_min</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">x_pol</span><span class="p">)</span>
		<span class="n">x_gap_max</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">x_pol</span><span class="p">)</span>
	
		<span class="n">y_gap_min</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">y_pol</span><span class="p">)</span>
		<span class="n">y_gap_max</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">y_pol</span><span class="p">)</span>

		<span class="n">small_mesh</span><span class="o">=</span><span class="p">[]</span>

		<span class="n">x_regular_small</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_gap_min</span><span class="p">,</span><span class="n">x_gap_max</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="p">)</span>
		<span class="n">y_regular_small</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_gap_min</span><span class="p">,</span><span class="n">y_gap_max</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_space</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_space</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">nxx</span> <span class="ow">in</span> <span class="n">x_regular_small</span><span class="p">:</span>
			<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
			<span class="k">for</span> <span class="n">nyy</span> <span class="ow">in</span> <span class="n">y_regular_small</span><span class="p">:</span>
				<span class="k">if</span> <span class="p">[</span><span class="n">nxx</span><span class="p">,</span><span class="n">nyy</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">small_mesh</span><span class="p">:</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_mesh_type</span><span class="o">==</span><span class="s1">&#39;honeycomb&#39;</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">cnt</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
							<span class="n">small_mesh</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nxx</span><span class="p">,</span><span class="n">nyy</span><span class="p">])</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">small_mesh</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nxx</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_space</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">nyy</span><span class="p">])</span>
					<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_mesh_type</span><span class="o">==</span><span class="s1">&#39;regular&#39;</span><span class="p">:</span>
						<span class="n">small_mesh</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nxx</span><span class="p">,</span><span class="n">nyy</span><span class="p">])</span>
					<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">:</span>
			<span class="n">angle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span>
			<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">small_mesh</span><span class="p">)):</span>
				<span class="n">x1</span><span class="o">=</span><span class="n">small_mesh</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_min</span>
				<span class="n">y1</span><span class="o">=</span><span class="n">small_mesh</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_min</span>
				<span class="n">small_mesh</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">-</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_gap_min</span>
				<span class="n">small_mesh</span><span class="p">[</span><span class="n">pair</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_gap_min</span>
				
		<span class="n">to_delete</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">)):</span>
			<span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
			<span class="n">check</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_in_out</span><span class="p">(</span><span class="n">point</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;shapefile&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">check</span><span class="p">:</span>
				<span class="n">to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


		<span class="n">to_delete</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">small_mesh</span><span class="p">)):</span>
			<span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="n">small_mesh</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">small_mesh</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
			<span class="n">check</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_in_out</span><span class="p">(</span><span class="n">point</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;shapefile&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">check</span><span class="p">:</span>
				<span class="n">to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

		<span class="n">small_mesh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">small_mesh</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

		<span class="n">mesh_pol</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">vk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">)):</span>
			<span class="n">mesh_pol</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">vk</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_array</span><span class="p">[</span><span class="n">vk</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

		<span class="k">for</span> <span class="n">vk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">small_mesh</span><span class="p">)):</span>
			<span class="n">mesh_pol</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">small_mesh</span><span class="p">[</span><span class="n">vk</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">small_mesh</span><span class="p">[</span><span class="n">vk</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mesh_pol</span><span class="p">)</span></div>

<div class="viewcode-block" id="py2amesh.radius_select"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.radius_select">[docs]</a>	<span class="k">def</span> <span class="nf">radius_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">xr</span><span class="p">,</span><span class="n">yr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Verifica si dos puntos estan mas cerca que el criterio seleccionado</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">r</span><span class="o">=</span><span class="p">((</span><span class="n">x0</span><span class="o">-</span><span class="n">xr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y0</span><span class="o">-</span><span class="n">yr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
		<span class="k">if</span> <span class="n">r</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_criteria</span><span class="p">:</span>
			<span class="n">boolean</span><span class="o">=</span><span class="mi">1</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">boolean</span><span class="o">=</span><span class="mi">0</span>
		<span class="k">return</span> <span class="n">boolean</span></div>

<div class="viewcode-block" id="py2amesh.from_leapfrog_mesh"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.from_leapfrog_mesh">[docs]</a>	<span class="k">def</span> <span class="nf">from_leapfrog_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Extrae puntos mas extremos y la posicion de los elementos de un set de datos provinientes de leapfrog, sin embargo no considera los elementos asociados a la roca ATM 0 </span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">geometry_file</span><span class="o">=</span><span class="s2">&quot;../mesh/from_leapfrog/LF_geometry.dat&quot;</span>
		<span class="n">leapfrog_t2_file</span><span class="o">=</span><span class="s2">&quot;../mesh/from_leapfrog/LF_t2.dat&quot;</span>

		<span class="c1">#Creates a dictionary using the layers</span>
		<span class="n">printlayer</span><span class="o">=</span><span class="kc">False</span>
		<span class="n">layer_min</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">layers</span><span class="o">=</span><span class="p">{}</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">geometry_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
		  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>

		  	<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">:</span>
		  		<span class="n">printlayer</span><span class="o">=</span><span class="kc">True</span>
		  		<span class="k">continue</span>
		  	<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;SURFA&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
		  		<span class="n">printlayer</span><span class="o">=</span><span class="kc">False</span>

		  	<span class="k">if</span> <span class="n">printlayer</span><span class="p">:</span>
		  		<span class="n">layer</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
		  		<span class="k">if</span> <span class="n">layer</span><span class="o">==</span><span class="s1">&#39; 0&#39;</span><span class="p">:</span>
		  			<span class="n">layer_min</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">2</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
		  			<span class="n">layer_middle</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">13</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span>
		  			<span class="n">layer_max</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">13</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span>
		  			<span class="k">continue</span>
		  		<span class="k">else</span><span class="p">:</span>
		  			<span class="n">layer_max</span><span class="o">=</span><span class="n">layer_min</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		  			<span class="n">layer_min</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">2</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
		  			<span class="n">layer_middle</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">13</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span>
		  		<span class="n">layers</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">layer</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">layer_max</span><span class="p">),</span><span class="nb">float</span><span class="p">(</span><span class="n">layer_middle</span><span class="p">),</span><span class="nb">float</span><span class="p">(</span><span class="n">layer_min</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>

		<span class="n">max_layer</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

		<span class="n">xc</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">yc</span><span class="o">=</span><span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">LP_mesh</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">printeleme</span><span class="o">=</span><span class="kc">False</span>
		<span class="c1">#Takes the elements at the selected leyer</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">leapfrog_t2_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
		  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>

		  	<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ELEME&#39;</span><span class="p">:</span>
		  		<span class="n">printeleme</span><span class="o">=</span><span class="kc">True</span>
		  		<span class="k">continue</span>
		  	<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;CONNE&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
		  		<span class="n">printeleme</span><span class="o">=</span><span class="kc">False</span>

		  	<span class="k">if</span> <span class="n">printeleme</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;ATM 0&quot;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span><span class="o">==</span><span class="n">max_layer</span><span class="p">:</span>
		  		<span class="n">xc</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">51</span><span class="p">:</span><span class="mi">60</span><span class="p">])</span>
		  		<span class="n">yc</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">60</span><span class="p">:</span><span class="mi">70</span><span class="p">])</span>
		  		<span class="bp">self</span><span class="o">.</span><span class="n">LP_mesh</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">])</span>


		<span class="c1">#Creates a dictionary of the VERTICES</span>

		<span class="n">printvertices</span><span class="o">=</span><span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E20</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x_max</span><span class="o">=</span><span class="mi">0</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E20</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="o">=</span><span class="mi">0</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">geometry_file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
		  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>

		    <span class="c1">#It will read between the keywords GRID and CONNECTIONS</span>
		    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;VERTICES&#39;</span><span class="p">:</span>
		      <span class="n">printvertices</span><span class="o">=</span><span class="kc">True</span>
		      <span class="k">continue</span>
		    <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;GRID&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
		      <span class="n">printvertices</span><span class="o">=</span><span class="kc">False</span>

		    <span class="k">if</span> <span class="n">printvertices</span><span class="p">:</span>
		     	<span class="n">vertice_x</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">4</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
		     	<span class="n">vertice_y</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">13</span><span class="p">:</span><span class="mi">23</span><span class="p">])</span>

		     	<span class="k">if</span> <span class="n">vertice_x</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">x_max</span><span class="p">:</span>
		     		<span class="bp">self</span><span class="o">.</span><span class="n">x_max</span><span class="o">=</span><span class="n">vertice_x</span>

		     	<span class="k">if</span> <span class="n">vertice_y</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="p">:</span>
		     		<span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="o">=</span><span class="n">vertice_y</span>

		     	<span class="k">if</span> <span class="n">vertice_x</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">x_min</span><span class="p">:</span>
		     		<span class="bp">self</span><span class="o">.</span><span class="n">x_min</span><span class="o">=</span><span class="n">vertice_x</span>

		     	<span class="k">if</span> <span class="n">vertice_y</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="p">:</span>
		     		<span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="o">=</span><span class="n">vertice_y</span>

		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_max</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LP_mesh</span></div>

<div class="viewcode-block" id="py2amesh.data"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.data">[docs]</a>	<span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Define los puntos que ingresaran al archivo de entrada para amesh. Adicionalmente, en caso de definir un linea en el archivo de entrada &lt;i&gt;&lt;lines_data/i&gt; se procedera a ingresar estos puntos y crear puntos paralelos en ambos extremos de la linea</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;names&#39;</span><span class="p">:(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;TYPE&#39;</span><span class="p">),</span><span class="s1">&#39;formats&#39;</span><span class="p">:(</span><span class="s1">&#39;&lt;U7&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;U10&#39;</span><span class="p">)},</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">skip_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">IDXY</span><span class="o">=</span><span class="p">{}</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_leapfrog</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_polygon</span><span class="p">:</span>
				<span class="n">regular_mesh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reg_pol_mesh</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">regular_mesh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">regular_mesh</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">x</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">regular_mesh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">from_leapfrog_mesh</span><span class="p">()</span>
		
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">])):</span>
			<span class="c1">#Store the data from wells</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">IDXY</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]))]</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;TYPE&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]]</span>
			<span class="c1">#self.IDXY[&quot;%s&quot;%(str(self.raw_data[&#39;ID&#39;][n])).split(&quot;&#39;&quot;)[1]]=[self.raw_data[&#39;X&#39;][n],self.raw_data[&#39;Y&#39;][n],self.raw_data[&#39;TYPE&#39;][n]]</span>
			<span class="n">to_delete</span><span class="o">=</span><span class="p">[]</span>
			
			<span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
			<span class="n">y0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
			
			<span class="c1">#Delete the regular points close to the wells</span>
			<span class="k">for</span> <span class="n">ngrid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">regular_mesh</span><span class="p">)):</span>
				<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x0</span><span class="o">-</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_criteria</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y0</span><span class="o">-</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_criteria</span><span class="p">:</span>
					<span class="n">boolean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_select</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
					<span class="k">if</span> <span class="n">boolean</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
						<span class="n">to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ngrid</span><span class="p">)</span>

			<span class="n">regular_mesh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">regular_mesh</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

		<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_file</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">lines_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">line_file</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;names&#39;</span><span class="p">:(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">),</span><span class="s1">&#39;formats&#39;</span><span class="p">:(</span><span class="s1">&#39;S10&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">)},</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
			<span class="n">lines_dict</span><span class="o">=</span><span class="p">{}</span>
			<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_data</span><span class="p">:</span>
				<span class="n">key</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">lines_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
					<span class="n">lines_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="p">[[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">])]]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">lines_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>

			<span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fault_distance</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">lines_dict</span><span class="p">:</span>
				<span class="n">x_lines</span><span class="o">=</span><span class="p">[]</span>
				<span class="n">y_lines</span><span class="o">=</span><span class="p">[]</span>
				<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines_dict</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
					<span class="n">x_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
					<span class="n">y_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="n">x_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
				<span class="n">y_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

				<span class="k">for</span> <span class="n">nv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_lines</span><span class="p">)):</span>
					<span class="k">if</span> <span class="n">nv</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">x_lines</span><span class="p">):</span>

						<span class="n">x_lines_np_local</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_lines</span><span class="p">[</span><span class="n">nv</span><span class="p">],</span><span class="n">x_lines</span><span class="p">[</span><span class="n">nv</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
						<span class="n">y_lines_np_local</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_lines</span><span class="p">[</span><span class="n">nv</span><span class="p">],</span><span class="n">y_lines</span><span class="p">[</span><span class="n">nv</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
						
						<span class="n">x_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_lines_np</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_lines</span><span class="p">[</span><span class="n">nv</span><span class="p">],</span><span class="n">x_lines</span><span class="p">[</span><span class="n">nv</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
						<span class="n">y_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_lines_np</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_lines</span><span class="p">[</span><span class="n">nv</span><span class="p">],</span><span class="n">y_lines</span><span class="p">[</span><span class="n">nv</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>

						<span class="n">m</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">plb</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x_lines_np_local</span><span class="p">,</span><span class="n">y_lines_np_local</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

						<span class="n">p_s</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
						<span class="n">c</span><span class="o">=</span><span class="nb">abs</span><span class="p">(((</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">p_s</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>

						<span class="n">x_u</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_lines_np_local</span><span class="p">]</span>
						<span class="n">x_d</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_lines_np_local</span><span class="p">]</span>

						<span class="n">y_u</span><span class="o">=</span><span class="p">[]</span>
						<span class="n">y_d</span><span class="o">=</span><span class="p">[]</span>

						<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_u</span><span class="p">)):</span>
							<span class="n">y_u</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_s</span><span class="o">*</span><span class="n">x_u</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">y_lines_np_local</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">-</span><span class="n">p_s</span><span class="o">*</span><span class="n">x_lines_np_local</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
							<span class="n">y_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_s</span><span class="o">*</span><span class="n">x_d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">y_lines_np_local</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">-</span><span class="n">p_s</span><span class="o">*</span><span class="n">x_lines_np_local</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>


						<span class="n">x_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_lines_np</span><span class="p">,</span><span class="n">x_u</span><span class="p">)</span>
						<span class="n">x_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_lines_np</span><span class="p">,</span><span class="n">x_d</span><span class="p">)</span>

						<span class="n">y_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_lines_np</span><span class="p">,</span><span class="n">y_u</span><span class="p">)</span>
						<span class="n">y_lines_np</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_lines_np</span><span class="p">,</span><span class="n">y_d</span><span class="p">)</span>

				<span class="k">for</span> <span class="n">n2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_lines_np</span><span class="p">)):</span>

					<span class="n">to_delete</span><span class="o">=</span><span class="p">[]</span>

					<span class="n">x0</span><span class="o">=</span><span class="n">x_lines_np</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
					<span class="n">y0</span><span class="o">=</span><span class="n">y_lines_np</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
					
					<span class="k">for</span> <span class="n">ngrid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">regular_mesh</span><span class="p">)):</span>
						<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x0</span><span class="o">-</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_criteria</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y0</span><span class="o">-</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_criteria</span><span class="p">:</span>
							<span class="n">boolean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_select</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">ngrid</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
							<span class="k">if</span> <span class="n">boolean</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
								<span class="n">to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ngrid</span><span class="p">)</span>

					<span class="n">regular_mesh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">regular_mesh</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

				<span class="k">for</span> <span class="n">n3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_lines_np</span><span class="p">)):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">IDXY</span><span class="p">[</span><span class="s2">&quot;RG</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n3</span><span class="o">+</span><span class="n">cnt</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">x_lines_np</span><span class="p">[</span><span class="n">n3</span><span class="p">],</span><span class="n">y_lines_np</span><span class="p">[</span><span class="n">n3</span><span class="p">],</span><span class="s1">&#39;REGUL&#39;</span><span class="p">]</span>
				<span class="n">cnt</span><span class="o">+=</span><span class="n">n3</span>

		<span class="c1">#Store the data from the regular mesh on IDXY</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">regular_mesh</span><span class="p">)):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">IDXY</span><span class="p">[</span><span class="s2">&quot;RG</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">cnt</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">regular_mesh</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;REGUL&#39;</span><span class="p">]</span>

		<span class="k">return</span> <span class="p">{</span><span class="s1">&#39;raw_data&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">,</span><span class="s1">&#39;IDXY&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">IDXY</span><span class="p">}</span></div>

<div class="viewcode-block" id="py2amesh.well_blk_assign"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.well_blk_assign">[docs]</a>	<span class="k">def</span> <span class="nf">well_blk_assign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Asigna el nombre a cada bloque, priorizando los pozos, es decir, estos llevan los correlativos mas bajos. Por ultimo almacena dos archivo json para registro de los bloques asignados a los pozos</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">well_names</span><span class="o">=</span><span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">blocks_PT</span><span class="o">=</span><span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">well_blocks_names</span><span class="o">=</span><span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">wells_correlative</span><span class="o">=</span><span class="p">{}</span>
		<span class="n">data_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>


		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layer</span><span class="p">):</span>
			<span class="n">cnt</span><span class="o">=</span><span class="mi">110</span>
			<span class="n">layer_num</span><span class="o">=</span><span class="mi">0</span>

			<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">]:</span>

				<span class="k">if</span> <span class="n">cnt</span><span class="o">%</span><span class="mi">100</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">blocknumber</span><span class="o">=</span><span class="n">cnt</span><span class="o">+</span><span class="mi">10</span>
					<span class="n">cnt</span><span class="o">=</span><span class="n">blocknumber</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">blocknumber</span><span class="o">=</span><span class="n">cnt</span>
					
				<span class="k">if</span> <span class="n">cnt</span><span class="o">%</span><span class="mi">1010</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">cnt</span><span class="o">=</span><span class="mi">110</span>
					<span class="n">blocknumber</span><span class="o">=</span><span class="n">cnt</span>
					<span class="n">layer_num</span><span class="o">+=</span><span class="mi">1</span>

				<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
				<span class="n">string_ele</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][(</span><span class="n">layer_num</span><span class="p">)]</span>

				<span class="n">blockname</span><span class="o">=</span><span class="n">string_ele</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">blocknumber</span><span class="p">)</span>

				<span class="bp">self</span><span class="o">.</span><span class="n">well_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blockname</span><span class="p">)</span>

				<span class="bp">self</span><span class="o">.</span><span class="n">well_blocks_names</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">blockname</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span>\
				                      <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
				                      <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
				                      <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
				                      <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>\
				                      <span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">]]</span>
				<span class="c1">#print(data_dict[&#39;IDXY&#39;][x][2]!=&#39;REGUL&#39;)</span>
				<span class="c1">#if data_dict[&#39;IDXY&#39;][x][2]==&#39;prod&#39; or data_dict[&#39;IDXY&#39;][x][2]==&#39;rein&#39;:</span>
				<span class="k">if</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;REGUL&#39;</span><span class="p">:</span>
					<span class="c1">#str(data_dict[&#39;IDXY&#39;][x][2]).split(&quot;&#39;&quot;)[1],\</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">blocks_PT</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">blockname</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span>\
				                      <span class="nb">str</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>\
				                      <span class="nb">str</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>\
				                      <span class="nb">str</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDXY&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span>\
				                      <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]),</span>\
				                      <span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rock_dict</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">])]</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">wells_correlative</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">blockname</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
					<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
						<span class="k">pass</span>
		<span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks_PT</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../mesh/well_dict.txt&quot;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
		<span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells_correlative</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../mesh/wells_correlative.txt&quot;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

		<span class="k">return</span> <span class="p">{</span><span class="s1">&#39;well_names&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">well_names</span><span class="p">,</span> <span class="s1">&#39;well_blocks_names&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">well_blocks_names</span><span class="p">}</span></div>

<div class="viewcode-block" id="py2amesh.input_file_to_amesh"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.input_file_to_amesh">[docs]</a>	<span class="k">def</span> <span class="nf">input_file_to_amesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Genera el archivo de entrada para amesh</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">welldict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">well_blk_assign</span><span class="p">()[</span><span class="s1">&#39;well_blocks_names&#39;</span><span class="p">]</span>
		
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_leapfrog</span><span class="p">:</span>
			<span class="n">Xarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmax</span><span class="p">])</span>
			<span class="n">Yarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymax</span><span class="p">])</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">regular_mesh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">from_leapfrog_mesh</span><span class="p">()</span>
			<span class="n">Xarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">])</span>
			<span class="n">Yarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">])</span>

		<span class="n">boundaries</span><span class="o">=</span><span class="p">[]</span>
		
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">Xarray</span><span class="p">,</span> <span class="n">Yarray</span><span class="p">):</span>
			<span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>


		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">:</span>
			<span class="n">angle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span>
			<span class="k">for</span> <span class="n">point_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)):</span>
				<span class="n">x1</span><span class="o">=</span><span class="n">boundaries</span><span class="p">[</span><span class="n">point_n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span>
				<span class="n">y1</span><span class="o">=</span><span class="n">boundaries</span><span class="p">[</span><span class="n">point_n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span>
				<span class="n">boundaries</span><span class="p">[</span><span class="n">point_n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">-</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span>
				<span class="n">boundaries</span><span class="p">[</span><span class="n">point_n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="n">y1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">angle</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span>

		<span class="n">boundaries</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
		<span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>

		<span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename_out</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;locat</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">welldict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">string</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:5s}{:5d}{:20.2f}{:20.2f}{:20.2f}{:20.2f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">welldict</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>\
				                                       <span class="n">welldict</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
				                                       <span class="n">welldict</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
				                                       <span class="n">welldict</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span>\
				                                       <span class="n">welldict</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">7</span><span class="p">])</span>
			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;     </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;bound</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
			<span class="n">string_bound</span><span class="o">=</span><span class="s2">&quot; </span><span class="si">%9.3E</span><span class="s2"> </span><span class="si">%9.3E</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">boundaries</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">boundaries</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">])</span>
			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string_bound</span><span class="p">)</span>

		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;     </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;toler&quot;</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;     </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%10s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">toler</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;     &quot;</span><span class="p">)</span>
		<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

		<span class="n">fileread</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;amesh</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">string_out</span><span class="o">=</span><span class="n">fileread</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		<span class="n">files2move</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="s1">&#39;conne&#39;</span><span class="p">,</span><span class="s1">&#39;eleme&#39;</span><span class="p">,</span><span class="s1">&#39;segmt&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">files2move</span><span class="p">:</span>
			<span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s1">&#39;../mesh/from_amesh/</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">fn</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">string_out</span></div>

<div class="viewcode-block" id="py2amesh.plot_voronoi"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.plot_voronoi">[docs]</a>	<span class="k">def</span> <span class="nf">plot_voronoi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;En caso de ser solicitado, grafica la  malla a partir de los archivo en la carpeta ../mesh/from_amesh</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">welldict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">well_blk_assign</span><span class="p">()[</span><span class="s1">&#39;well_blocks_names&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/segmt&#39;</span><span class="p">):</span>
			<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/segmt&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;f8,f8,f8,f8,i8,S5,S5&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span><span class="s1">&#39;X2&#39;</span><span class="p">,</span><span class="s1">&#39;Y2&#39;</span><span class="p">,</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="s1">&#39;elem1&#39;</span><span class="p">,</span><span class="s1">&#39;elem2&#39;</span><span class="p">],</span><span class="n">delimiter</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
			
			<span class="n">fig</span><span class="p">,</span> <span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

			<span class="c1">#Set of the principal plot</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymax</span><span class="p">])</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;East [m]&#39;</span><span class="p">)</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;North [m]&#39;</span><span class="p">)</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mesh for layer </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_to_plot</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.04</span><span class="p">)</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x_space</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x_space</span><span class="p">))</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">y_space</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y_from_boarder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_space</span><span class="p">))</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span>

			<span class="c1">#Plot of the Yaxis in the top </span>
			<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
			<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax0</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
			<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax0</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
			<span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span>

			<span class="c1">#Plot of the Xaxis in the top </span>
			<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ax0</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">())</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax0</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span>


			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;elem1&#39;</span><span class="p">]):</span>
				<span class="n">Xfill</span><span class="o">=</span><span class="p">[]</span>
				<span class="n">Yfill</span><span class="o">=</span><span class="p">[]</span>
				<span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_to_plot</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
					<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">])):</span>
						<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
						<span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;elem1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">n</span><span class="p">:</span>
							<span class="n">Xfill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
							<span class="n">Xfill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X2&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
							<span class="n">Yfill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
							<span class="n">Yfill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y2&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
							<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X2&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]],[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y2&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]],</span><span class="s1">&#39;-k&#39;</span><span class="p">)</span>
							
							<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_names</span><span class="p">:</span>
								<span class="k">if</span> <span class="n">cnt</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
									<span class="k">if</span> <span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;WELL&#39;</span><span class="p">:</span>
										<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
											      <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">n</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
										<span class="n">color_dot</span><span class="o">=</span><span class="s1">&#39;r&#39;</span>
									<span class="k">else</span><span class="p">:</span>
										<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
											      <span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
										<span class="n">color_dot</span><span class="o">=</span><span class="s1">&#39;b&#39;</span>
								<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>

							<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_centers</span><span class="p">:</span>
								<span class="k">if</span> <span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;WELL&#39;</span><span class="p">:</span>
									<span class="n">color_dot</span><span class="o">=</span><span class="s1">&#39;r&#39;</span>
								<span class="k">else</span><span class="p">:</span>
									<span class="n">color_dot</span><span class="o">=</span><span class="s1">&#39;b&#39;</span>
								<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">o&#39;</span><span class="o">%</span><span class="n">color_dot</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
								

					<span class="n">ax0</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">Xfill</span><span class="p">,</span><span class="n">Yfill</span><span class="p">,</span><span class="n">welldict</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#CCCCCC&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
			<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../mesh/plot_voronoi_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)),</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">pad_inches</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">plot_s</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">plot_s</span><span class="o">=</span><span class="s2">&quot;Excecute input_file_to_amesh() function first&quot;</span>
		<span class="k">return</span> <span class="n">plot_s</span></div>

<div class="viewcode-block" id="py2amesh.to_steinar"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.to_steinar">[docs]</a>	<span class="k">def</span> <span class="nf">to_steinar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Convierte los archivos de salida amesh en formato de entrada para Steinar</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/segmt&#39;</span><span class="p">):</span>
			<span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/segmt&#39;</span><span class="p">,</span> <span class="s1">&#39;../mesh/to_steinar/segmt&#39;</span><span class="p">)</span>
			<span class="n">ele_file_st</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/to_steinar/eleme&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>  
			<span class="n">ele_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/eleme&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>  
			<span class="n">data_eleme</span><span class="o">=</span><span class="n">ele_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
			
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_inac_from_poly</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_inac_from_inner</span><span class="p">:</span>
				<span class="n">source_file</span><span class="o">=</span><span class="s2">&quot;../mesh/from_amesh/eleme&quot;</span>
				<span class="n">data_eleme</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="s1">&#39;rocktype&#39;</span><span class="p">,</span><span class="s1">&#39;vol&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span>
				<span class="n">data_eleme</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">)</span>
				<span class="n">ele_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;eleme</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_inac_from_inner</span><span class="p">:</span>
					<span class="n">source</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_inac_from_poly</span><span class="p">:</span>
					<span class="n">source</span><span class="o">=</span><span class="s1">&#39;shapefile&#39;</span>
					
				<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_eleme</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
					<span class="n">check</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_in_out</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]],</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
					<span class="n">outside</span><span class="o">=</span><span class="mi">1</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">check</span><span class="p">:</span>
						<span class="n">outside</span><span class="o">=-</span><span class="mi">1</span>
					<span class="n">ele_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%5s%10s%5s%10.3E</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">],</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;rocktype&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vol&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">outside</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
				<span class="k">for</span> <span class="n">a_line</span> <span class="ow">in</span> <span class="n">data_eleme</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">cnt</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
						<span class="n">name_rock_vol</span> <span class="o">=</span> <span class="n">a_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span>  
						<span class="n">ele_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name_rock_vol</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">ele_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;eleme</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
					<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
			<span class="n">ele_file_st</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="n">ele_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

			<span class="n">conne_file_st</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/to_steinar/conne&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>  
			<span class="n">conne_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/conne&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>  
			<span class="n">data_conne</span><span class="o">=</span><span class="n">conne_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
			<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
			<span class="k">for</span> <span class="n">a_line</span> <span class="ow">in</span> <span class="n">data_conne</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">cnt</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">name_conne</span> <span class="o">=</span> <span class="n">a_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>  
					<span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">name_conne</span><span class="p">:</span>
						<span class="k">pass</span>
					<span class="k">elif</span> <span class="n">cnt</span><span class="o">&lt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">data_conne</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>
						<span class="k">try</span><span class="p">:</span>
							<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name_conne</span><span class="p">)</span>
							<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;   0    0    0   &quot;</span><span class="p">)</span>

							<span class="n">nod4</span><span class="o">=</span><span class="n">a_line</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">64</span><span class="p">]</span>

							<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nod4</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
								<span class="n">per</span><span class="o">=</span><span class="mi">3</span>
							<span class="k">else</span><span class="p">:</span>
								<span class="n">per</span><span class="o">=</span><span class="n">a_line</span><span class="p">[</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span>

							<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">per</span><span class="p">)</span>

							<span class="n">nod1</span><span class="o">=</span><span class="n">a_line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
							<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%9.3E</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nod1</span><span class="p">)))</span>

							<span class="n">nod2</span><span class="o">=</span><span class="n">a_line</span><span class="p">[</span><span class="mi">40</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
							<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%9.3E</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nod2</span><span class="p">)))</span>

							<span class="n">nod3</span><span class="o">=</span><span class="n">a_line</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
							<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%9.3E</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nod3</span><span class="p">)))</span>

							<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nod4</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
								<span class="c1">#nod4=-1</span>
								<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:9.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nod4</span><span class="p">)))</span>
							<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nod4</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
								<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;      0.0&quot;</span><span class="p">)</span>

							<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; 0.0000E+00</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

						<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
							<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">conne_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;conne</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
			<span class="n">conne_file_st</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="n">conne_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

			<span class="n">in_file_st</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/to_steinar/in&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

			<span class="c1">#block_file=open(&#39;block_name.csv&#39;,&#39;w&#39;)</span>
			<span class="n">in_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/in&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>  
			<span class="n">data_in</span><span class="o">=</span><span class="n">in_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
			<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;bound</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_leapfrog</span><span class="p">:</span>
				<span class="n">Xarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Xmax</span><span class="p">])</span>
				<span class="n">Yarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ymax</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">regular_mesh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">from_leapfrog_mesh</span><span class="p">()</span>
				<span class="n">Xarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">])</span>
				<span class="n">Yarray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">])</span>

			<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%6.2d</span><span class="s2"> </span><span class="si">%6.2d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Xarray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Yarray</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%6.2d</span><span class="s2"> </span><span class="si">%6.2d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Xarray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Yarray</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
			<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%6.2d</span><span class="s2"> </span><span class="si">%6.2d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Xarray</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Yarray</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
			<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%6.2d</span><span class="s2"> </span><span class="si">%6.2d</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Xarray</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Yarray</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;locat</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

			<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>

			<span class="k">for</span> <span class="n">ny</span> <span class="ow">in</span> <span class="n">data_in</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">cnt</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">cnt</span><span class="o">&lt;</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_in</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">):</span>
					<span class="n">read1</span><span class="o">=</span><span class="n">ny</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
					<span class="n">read2</span><span class="o">=</span><span class="n">ny</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
					<span class="n">read3</span><span class="o">=</span><span class="n">ny</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span>
					<span class="n">read4</span><span class="o">=</span><span class="n">ny</span><span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">52</span><span class="p">]</span>
					<span class="n">read5</span><span class="o">=</span><span class="n">ny</span><span class="p">[</span><span class="mi">51</span><span class="p">:</span><span class="mi">72</span><span class="p">]</span>
					<span class="n">read6</span><span class="o">=</span><span class="n">ny</span><span class="p">[</span><span class="mi">71</span><span class="p">:</span><span class="mi">92</span><span class="p">]</span>
					<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">read1</span><span class="p">)</span>
					<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%4s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">read2</span><span class="p">)</span>
					<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%23.8E</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">read3</span><span class="p">))</span>
					<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%24.8E</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">read4</span><span class="p">))</span>
					<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%24.8E</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">read5</span><span class="p">))</span>
					<span class="n">in_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%24.8E</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">read6</span><span class="p">))</span>

					<span class="c1">#stringx=&quot;%.2f,%.2f,%.2f\n&quot;%(float(read3),float(read4),float(read5))</span>
					<span class="c1">#block_file.write(stringx)</span>
				<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>

			<span class="n">in_file_st</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="n">in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="c1">#block_file.close()</span>
			<span class="n">rock_file_st</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/to_steinar/rocks&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
			<span class="n">rock_file_st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;rock1    02.6500E+031.0000E-011.0000E-151.0000E-151.0000E-152.1000E+008.5000E+02 160 243 150&quot;</span><span class="p">)</span>
			<span class="n">rock_file_st</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">pass</span></div>

<div class="viewcode-block" id="py2amesh.to_GIS"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.py2amesh.to_GIS">[docs]</a>	<span class="k">def</span> <span class="nf">to_GIS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Toma como entrada el archivo segment de ../mesh/from_amesh y eleme de ../mesh/to_stainar y los convierte en shapefile con atributos de roca, nombre y volumen</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;../mesh/from_amesh/segmt&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;../mesh/to_steinar/eleme&#39;</span><span class="p">):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_all_GIS</span><span class="p">:</span>
				<span class="n">max_layer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layer</span>
				<span class="n">min_layer</span><span class="o">=</span><span class="mi">1</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">max_layer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_to_plot</span>
				<span class="n">min_layer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_to_plot</span>

			<span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">min_layer</span><span class="p">,</span><span class="n">max_layer</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
				<span class="n">w</span><span class="o">=</span><span class="n">shapefile</span><span class="o">.</span><span class="n">Writer</span><span class="p">(</span><span class="s1">&#39;../mesh/GIS/mesh_cga_layer_</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">ln</span><span class="p">)</span>
				<span class="n">w</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;BLOCK_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
				<span class="n">w</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;ROCKTYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
				<span class="n">w</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;VOLUMEN&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
				
				<span class="n">alttype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y2&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;elem1&#39;</span><span class="p">,</span> <span class="s1">&#39;U5&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;elem2&#39;</span><span class="p">,</span> <span class="s1">&#39;U5&#39;</span><span class="p">)])</span>
				<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;../mesh/to_steinar/segmt&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">alttype</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

				<span class="n">elem_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../mesh/to_steinar/eleme&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
				<span class="n">plain_elemfile</span><span class="o">=</span><span class="n">elem_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

				<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;elem1&#39;</span><span class="p">]):</span>
					<span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
						<span class="n">points</span><span class="o">=</span><span class="p">[]</span>
						<span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.*$&quot;</span><span class="o">%</span><span class="n">n</span><span class="p">,</span> <span class="n">plain_elemfile</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
						<span class="n">rocktype</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">17</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span>
						<span class="n">volumen</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">22</span><span class="p">:</span><span class="mi">32</span><span class="p">])</span>
						<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">])):</span>
							<span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;elem1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">n</span><span class="p">:</span>
								<span class="n">point1</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y1&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span>
								<span class="n">point2</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X2&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y2&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span>
								<span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point1</span><span class="p">)</span>
								<span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point2</span><span class="p">)</span>
						<span class="n">w</span><span class="o">.</span><span class="n">poly</span><span class="p">([</span><span class="n">points</span><span class="p">])</span>
						<span class="n">w</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">rocktype</span><span class="p">,</span><span class="n">volumen</span><span class="p">)</span>
				<span class="n">w</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
				<span class="n">elem_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="kc">None</span></div></div>

<div class="viewcode-block" id="mesh_creation_func"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.mesh_creation_func">[docs]</a><span class="k">def</span> <span class="nf">mesh_creation_func</span><span class="p">(</span><span class="n">input_mesh_dictionary</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Creates a grid</span>

<span class="sd">	Most of the parameters are keywords from the input dictionary input_mesh_dictionary. Otherwise, the input dictionary is specified.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	filename : str</span>
<span class="sd">	    File name with well feedzone location</span>
<span class="sd">	filepath : str</span>
<span class="sd">		Path of input files</span>
<span class="sd">	Xmin  : float</span>
<span class="sd">		Minimun X coordinates for the grid </span>
<span class="sd">	Xmax : float</span>
<span class="sd">		Maximun X coordinates for the grid </span>
<span class="sd">	Ymin : float</span>
<span class="sd">		Minimun Y coordinates for the grid </span>
<span class="sd">	Ymax : float</span>
<span class="sd">		Maximun Y coordinates for the grid </span>
<span class="sd">	toler : float</span>
<span class="sd">		AMESH parameter</span>
<span class="sd">	layers : dictionary</span>
<span class="sd">		Name (correlative) and thickness of every layer on the model, keyword on input_dictionary</span>
<span class="sd">	layer_to_plot : int</span>
<span class="sd">		In case it is specified a voronoi plot will be performed</span>
<span class="sd">	x_space : float</span>
<span class="sd">		Horizontal distance between elements for the outerfield</span>
<span class="sd">	y_space : float</span>
<span class="sd">		Vertical distance between elements for the outerfield</span>
<span class="sd">	radius_criteria: float</span>
<span class="sd">		Minimun distance between well location and a regular element</span>
<span class="sd">	x_from_boarder: float</span>
<span class="sd">		Horizontal distance from the first element to the east border</span>
<span class="sd">	y_from_boarder: float</span>
<span class="sd">		Vertical distance from the first element to the south border</span>
<span class="sd">	x_gap_min: float</span>
<span class="sd">		Minimun X coordinates on the grid for the well field </span>
<span class="sd">	x_gap_max: float</span>
<span class="sd">		Maximun X coordinates on the grid for the well field </span>
<span class="sd">	x_gap_space: float</span>
<span class="sd">		Horizontal distance between elements for the farfield</span>
<span class="sd">	y_gap_min: float</span>
<span class="sd">		Minimun Y coordinates on the grid for the well field o</span>
<span class="sd">	y_gap_max: float</span>
<span class="sd">		Maximun X coordinates on the grid for the well field </span>
<span class="sd">	y_gap_space: float</span>
<span class="sd">		Vertical distance between elements for the farfield</span>
<span class="sd">	plot_names: bool</span>
<span class="sd">		If true it plots the name of the blocks from the selected layer to plot</span>
<span class="sd">	plot_centers: bool</span>
<span class="sd">		If true it plots the centers of the blocks from the selected layer to plot</span>
<span class="sd">	z0_level: float</span>
<span class="sd">		Reference level (elevation) for all the grid, keyword on input_dictionary</span>
<span class="sd">	mesh_creation: bool</span>
<span class="sd">		If true the mesh is created</span>
<span class="sd">	plot_layer: bool</span>
<span class="sd">		If true it plots the selected layer</span>
<span class="sd">	to_steinar: bool</span>
<span class="sd">		If true it creates the input files for steinar</span>
<span class="sd">	to_GIS: bool</span>
<span class="sd">		If true it generates a shapefile of the selected layer</span>
<span class="sd">	plot_all_GIS: bool</span>
<span class="sd">		If true it generates a shapefile of all  layers</span>
<span class="sd">	from_leapfrog: bool</span>
<span class="sd">		lee archivos leapfrong ../mesh/from_leapfrog/LF_geometry.dat y ../mesh/from_leapfrog/LF_t2.dat, sin embargo se pierde la simbologia usada en leapfrog y no te utiliza la malla regular ni los pozos. Solamente se crea la malla utilizando amesh</span>
<span class="sd">	line_file: str</span>
<span class="sd">		It defines the path and name of a line that can represented a fault or other structure on the mesh, The input file must contain the header: ID,X,Y on csv format. ID referes to the same</span>
<span class="sd">		structure, thus, more than one structure can be defined on a single file.</span>
<span class="sd">	fault_distance: float</span>
<span class="sd">		In case a line_file is define, some paralels elements will be created at a defined distance</span>
<span class="sd">	with_polygon: bool</span>
<span class="sd">		If true a shapefile will be read to define the wellfield.</span>
<span class="sd">	polygon_shape: str</span>
<span class="sd">		The shapefile deines the wellfield boundaries. The shape must not contain any cavity</span>
<span class="sd">	set_inac_from_poly: bool</span>
<span class="sd">		If true all the elements on the outside of the shapefile are defined as inactive</span>
<span class="sd">	set_inac_from_inner:bool</span>
<span class="sd">		If true all the elements on the outerfield are defined as inactive</span>
<span class="sd">	rotate: bool</span>
<span class="sd">	    If true it rotates the mesh a defined angle</span>
<span class="sd">	angle: float</span>
<span class="sd">	    Angle in degrees</span>
<span class="sd">	inner_mesh_type: string</span>
<span class="sd">	    Type of mesh on the inner part of the mesh, it could be &#39;honeycomb&#39; or &#39;regular&#39;</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  eleme: list of blocks from the grid</span>
<span class="sd">	file</span>
<span class="sd">	  conne : list of connections on the grid</span>
<span class="sd">	shapefile</span>
<span class="sd">	  mesh_{field}_layer_{layer} : shapefile of a defined (or all) layer including rock distribution</span>
<span class="sd">	plot</span>
<span class="sd">	  Voronoi plot (in case is specified)</span>
<span class="sd">	  </span>
<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	A copy of AMESH must be on the path or directory</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">layers_thick</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;LAYERS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()))[:][:,</span><span class="mi">1</span><span class="p">]))</span>


	<span class="n">blocks</span><span class="o">=</span><span class="n">py2amesh</span><span class="p">(</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;filepath&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;Xmin&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;Xmax&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;Ymin&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;Ymax&#39;</span><span class="p">],</span>\
			<span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;toler&#39;</span><span class="p">],</span><span class="n">layers_thick</span><span class="p">,</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;layer_to_plot&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;x_space&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;y_space&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;radius_criteria&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;x_from_boarder&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;y_from_boarder&#39;</span><span class="p">],</span>\
			<span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;x_gap_min&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;x_gap_max&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;x_gap_space&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;y_gap_min&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;y_gap_max&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;y_gap_space&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;plot_names&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;plot_centers&#39;</span><span class="p">],</span>\
			<span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;z_ref&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;plot_all_GIS&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;from_leapfrog&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;line_file&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;fault_distance&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;with_polygon&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;polygon_shape&#39;</span><span class="p">],</span>\
			<span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;set_inac_from_poly&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;set_inac_from_inner&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;rotate&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">],</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;inner_mesh_type&#39;</span><span class="p">])</span>

	<span class="k">if</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;mesh_creation&#39;</span><span class="p">]:</span>

		<span class="n">blocks</span><span class="o">.</span><span class="n">input_file_to_amesh</span><span class="p">()</span>

		<span class="k">if</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;plot_layer&#39;</span><span class="p">]:</span>
			<span class="n">blocks</span><span class="o">.</span><span class="n">plot_voronoi</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;to_steinar&#39;</span><span class="p">]:</span>
			<span class="n">blocks</span><span class="o">.</span><span class="n">to_steinar</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;to_GIS&#39;</span><span class="p">]:</span>
			<span class="n">blocks</span><span class="o">.</span><span class="n">to_GIS</span><span class="p">()</span>

	<span class="k">elif</span> <span class="ow">not</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;mesh_creation&#39;</span><span class="p">]:</span>
		<span class="k">if</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;plot_layer&#39;</span><span class="p">]:</span>
			<span class="n">blocks</span><span class="o">.</span><span class="n">plot_voronoi</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;to_steinar&#39;</span><span class="p">]:</span>
			<span class="n">blocks</span><span class="o">.</span><span class="n">to_steinar</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;to_GIS&#39;</span><span class="p">]:</span>
			<span class="n">blocks</span><span class="o">.</span><span class="n">to_GIS</span><span class="p">()</span>

	<span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="change_ref_elevation"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.change_ref_elevation">[docs]</a><span class="k">def</span> <span class="nf">change_ref_elevation</span><span class="p">(</span><span class="n">variation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It modifies the in files from the folders to_steinar and from_amesh by increasing (or decreasing) a fixed value</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd"> 	variation: float</span>
<span class="sd">	  Defined value change the elevation of the in file from amesh</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  in: modified on folders  ../mesh/to_steinar and ../mesh/from_amesh</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	The change is generated on all the elements. It is recommened to run ELEM_to_json() after this execution</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; change_ref_elevation(variation=-100)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">in_file_steinar</span><span class="o">=</span><span class="s1">&#39;../mesh/to_steinar/in&#39;</span>
	<span class="n">in_file_amesh</span><span class="o">=</span><span class="s1">&#39;../mesh/from_amesh/in&#39;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">in_file_steinar</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">in_file_amesh</span><span class="p">):</span>

		<span class="n">steinar_colums</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),(</span><span class="mi">10</span><span class="p">,</span><span class="mi">35</span><span class="p">),(</span><span class="mi">35</span><span class="p">,</span><span class="mi">60</span><span class="p">),(</span><span class="mi">60</span><span class="p">,</span><span class="mi">85</span><span class="p">),(</span><span class="mi">85</span><span class="p">,</span><span class="mi">110</span><span class="p">)]</span>
		<span class="n">steinar_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">in_file_steinar</span><span class="p">,</span><span class="n">colspecs</span><span class="o">=</span><span class="n">steinar_colums</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="s1">&#39;level&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">])</span>
		<span class="n">steinar_data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">steinar_data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">variation</span>

		<span class="n">string</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file_steinar</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
				<span class="n">string</span><span class="o">+=</span><span class="n">line</span>
				<span class="k">if</span> <span class="s1">&#39;locat&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
					<span class="k">break</span>

		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">steinar_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
			<span class="n">string</span><span class="o">+=</span><span class="s2">&quot;</span><span class="si">{:5s}{:5d}{:23.8f}{:24.8f}{:24.8f}{:24.8f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">])</span>


		<span class="n">steinar_in_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">in_file_steinar</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
		<span class="n">steinar_in_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
		<span class="n">steinar_in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


		<span class="n">amesh_colums</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">),(</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">),(</span><span class="mi">50</span><span class="p">,</span><span class="mi">70</span><span class="p">),(</span><span class="mi">70</span><span class="p">,</span><span class="mi">90</span><span class="p">)]</span>
		<span class="n">amesh_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">in_file_amesh</span><span class="p">,</span><span class="n">colspecs</span><span class="o">=</span><span class="n">amesh_colums</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="s1">&#39;level&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">])</span>
		<span class="n">amesh_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">amesh_data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">amesh_data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">variation</span>

		<span class="n">string</span><span class="o">=</span><span class="s2">&quot;locat</span><span class="se">\n</span><span class="s2">&quot;</span>

		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">amesh_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
			<span class="n">string</span><span class="o">+=</span><span class="s2">&quot;</span><span class="si">{:5s}{:5.0f}{:20.3f}{:20.3f}{:20.3f}{:20.3f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">])</span>

		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file_amesh</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">check_in</span><span class="o">=</span><span class="kc">False</span>
			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
				<span class="k">if</span> <span class="s1">&#39;bound&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
					<span class="n">check_in</span><span class="o">=</span><span class="kc">True</span>
					<span class="n">string</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
				
				<span class="k">if</span> <span class="n">check_in</span><span class="p">:</span>
					<span class="n">string</span><span class="o">+=</span><span class="n">line</span>

		<span class="n">amesh_in_file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">in_file_amesh</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
		<span class="n">amesh_in_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
		<span class="n">amesh_in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="empty_mesh"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.empty_mesh">[docs]</a><span class="k">def</span> <span class="nf">empty_mesh</span><span class="p">():</span>
	<span class="sd">&quot;&quot;&quot;If the suggested T2GEORES folder structure is used. The folder mesh/to_steinar, mesh/from_amesh and mesh/GIS are emptied</span>
<span class="sd">	</span>
<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	No input parameter is needed</span>


<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; empty_mesh()</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">folders</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../mesh/to_steinar&#39;</span><span class="p">,</span><span class="s1">&#39;../mesh/from_amesh&#39;</span><span class="p">,</span><span class="s1">&#39;../mesh/GIS&#39;</span><span class="p">]</span>
	<span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">file_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
				<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">IsADirectoryError</span><span class="p">:</span>
				<span class="k">pass</span></div>

<div class="viewcode-block" id="ELEM_to_json"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.ELEM_to_json">[docs]</a><span class="k">def</span> <span class="nf">ELEM_to_json</span><span class="p">():</span>
	<span class="sd">&quot;&quot;&quot;It combines the files eleme and in from the steinar folder into a single json file</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  ELEME.json: on ../mesh/</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	Currently, it uses the steinar function because it assume the modeler will perfome the block assignation on it </span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; ELEM_to_json()</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">source_file</span><span class="o">=</span><span class="s2">&quot;../mesh/to_steinar/in&quot;</span>
	<span class="n">eleme_file</span><span class="o">=</span><span class="s2">&quot;../mesh/to_steinar/eleme&quot;</span>

	<span class="n">eleme_dict</span><span class="o">=</span><span class="p">{}</span>
	<span class="n">col_eleme</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)]</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">eleme_file</span><span class="p">):</span>
		<span class="n">data_in</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="s1">&#39;li&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">])</span>
		<span class="n">data_eleme</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">eleme_file</span><span class="p">,</span><span class="n">colspecs</span><span class="o">=</span><span class="n">col_eleme</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="s1">&#39;rocktype&#39;</span><span class="p">,</span><span class="s1">&#39;vol&#39;</span><span class="p">])</span>

		<span class="c1">#data_eleme[[&#39;rocktype&#39;,&#39;vol&#39;]] =data_eleme.data.apply(lambda x: pd.Series([str(x)[0:5],str(x)[5:16]]))</span>
		<span class="c1">#data_eleme.drop(&#39;data&#39;, axis=1, inplace=True)</span>

		<span class="n">data_in</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">)</span>
		<span class="n">data_eleme</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">)</span>

		<span class="n">data_eleme</span><span class="o">=</span><span class="n">data_eleme</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_in</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
		<span class="n">data_eleme</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">data_eleme</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">source_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="CONNE_to_json"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.CONNE_to_json">[docs]</a><span class="k">def</span> <span class="nf">CONNE_to_json</span><span class="p">():</span>
	<span class="sd">&quot;&quot;&quot;It creates a json file from the CONNE file on mesh/to_steinar folder </span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  CONNE.json: on ../mesh/</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	Currently, it uses the steinar folder because it assume the modeler will perfome the block assignation on it </span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; CONNE_to_json()</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">source_file</span><span class="o">=</span><span class="s2">&quot;../mesh/to_steinar/conne&quot;</span>

	<span class="n">conne_dict</span><span class="o">=</span><span class="p">{}</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">source_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">rock_file</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">rock_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
				<span class="n">linex</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">conne_dict</span><span class="p">[</span><span class="n">linex</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">8</span><span class="p">])]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">conne_dict</span><span class="p">[</span><span class="n">linex</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">linex</span><span class="p">[</span><span class="mi">8</span><span class="p">])]</span>

		<span class="n">CONNE_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">conne_dict</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ISOT&#39;</span><span class="p">,</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span><span class="s1">&#39;AREAX&#39;</span><span class="p">,</span> <span class="s1">&#39;BETAX&#39;</span><span class="p">])</span>
		<span class="n">CONNE_pd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;../mesh/CONNE.json&#39;</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">source_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="segmnt_to_json"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.segmnt_to_json">[docs]</a><span class="k">def</span> <span class="nf">segmnt_to_json</span><span class="p">():</span>
	<span class="sd">&quot;&quot;&quot;It combines the information from eleme and segmt from folder mesh/to_steinar into a single json</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  segmt.json: on ../mesh/</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	Currently, it uses the steinar folder because it assume the modeler will perfome the block assignation on it. </span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; segmnt_to_json()</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">eleme_file</span><span class="o">=</span><span class="s2">&quot;../mesh/to_steinar/eleme&quot;</span>
	<span class="n">segmt_file</span><span class="o">=</span><span class="s2">&quot;../mesh/to_steinar/segmt&quot;</span>
	<span class="n">elment_dict</span><span class="o">=</span><span class="p">{}</span>

	<span class="n">col_eleme</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)]</span>
	<span class="n">col_segment</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">),(</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">),(</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">),(</span><span class="mi">45</span><span class="p">,</span><span class="mi">60</span><span class="p">),(</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">),(</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">),(</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">)]</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">segmt_file</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">eleme_file</span><span class="p">):</span>

		<span class="n">segmt_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">segmt_file</span><span class="p">,</span><span class="n">colspecs</span><span class="o">=</span><span class="n">col_segment</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span><span class="s1">&#39;X2&#39;</span><span class="p">,</span><span class="s1">&#39;Y2&#39;</span><span class="p">,</span><span class="s1">&#39;redunt&#39;</span><span class="p">,</span><span class="s1">&#39;eleme1&#39;</span><span class="p">,</span><span class="s1">&#39;eleme2&#39;</span><span class="p">])</span>

		<span class="n">eleme_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">eleme_file</span><span class="p">,</span><span class="n">colspecs</span><span class="o">=</span><span class="n">col_eleme</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="s1">&#39;rocktype&#39;</span><span class="p">,</span><span class="s1">&#39;vol&#39;</span><span class="p">])</span>

		<span class="n">eleme_data</span><span class="o">=</span><span class="n">eleme_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">segmt_data</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;eleme1&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

		<span class="n">eleme_data</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eleme_data</span><span class="p">[[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span><span class="s1">&#39;X2&#39;</span><span class="p">,</span><span class="s1">&#39;Y2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

		<span class="n">eleme_data</span><span class="o">=</span><span class="n">eleme_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;block&#39;</span><span class="p">,</span><span class="s1">&#39;rocktype&#39;</span><span class="p">,</span><span class="s1">&#39;vol&#39;</span><span class="p">])[</span><span class="s1">&#39;points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

		<span class="n">eleme_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

		<span class="n">eleme_data</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;../mesh/segmt.json&#39;</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Either the file </span><span class="si">%s</span><span class="s2"> or </span><span class="si">%s</span><span class="s2"> do not exist&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">eleme_file</span><span class="p">,</span><span class="n">segmt_file</span><span class="p">))</span></div>

<div class="viewcode-block" id="plot_voronoi"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.plot_voronoi">[docs]</a><span class="k">def</span> <span class="nf">plot_voronoi</span><span class="p">(</span><span class="n">input_mesh_dictionary</span><span class="p">,</span> <span class="n">geners</span><span class="p">,</span><span class="n">layer</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="n">plot_center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">mark_elements</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">cross_section</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">savefig</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It plots a selected layer, showing the rock distribution</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	layer : str</span>
<span class="sd">	  It defines the layer correlative to plot</span>
<span class="sd">	plot_center : bool</span>
<span class="sd">	  If True it plots the center point for each element</span>
<span class="sd">	mark_elements : bool</span>
<span class="sd">	  If True it considers the final four identifiers from each constant sink/source element defined on geners and fill the block with a different color.</span>
<span class="sd">	cross_section : bool</span>
<span class="sd">	  If true plot a line where a vertical cross section is created with the output module</span>
<span class="sd">	savefig : bool</span>
<span class="sd">	  If true a png file is saved on ../mesh</span>
<span class="sd">	input_mesh_dictionary : dictionary</span>
<span class="sd">	  Contains a unique color for every rocktype.</span>
<span class="sd">	geners : dictionary</span>
<span class="sd">	  Contains the neccesary information to define a sink/source. g.e. &#39;DA110&#39;:{&#39;SL&#39;:&#39;GEN&#39;,&#39;NS&#39;:10,&#39;TYPE&#39;:&#39;MASS&#39;,&#39;GX&#39;:1,&#39;EX&#39;:1.1E6}</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	plot</span>
<span class="sd">	  layer_{layer}: containing the rock distribution from the selected layer</span>

<span class="sd">	Attention</span>
<span class="sd">	---------</span>
<span class="sd">	The functions ELEM_to_json() </span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; segmnt_to_json() and segmnt_to_json() should be executed previously</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">segmt_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/segmt.json&#39;</span>

	<span class="n">eleme_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span>

	<span class="n">wells_corr_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/wells_correlative.txt&#39;</span>


	<span class="k">if</span> <span class="n">cross_section</span><span class="p">:</span>
		<span class="n">x_points</span><span class="o">=</span><span class="n">cross_section</span><span class="p">[</span><span class="s1">&#39;cross_section&#39;</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
		<span class="n">y_points</span><span class="o">=</span><span class="n">cross_section</span><span class="p">[</span><span class="s1">&#39;cross_section&#39;</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">blocks</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

		<span class="n">rocktypes</span><span class="o">=</span><span class="p">{}</span>
		<span class="n">cnt</span><span class="o">=</span><span class="mi">1</span>
		<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rocktypes</span><span class="p">:</span>
				<span class="n">rocktypes</span><span class="p">[</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">input_mesh_dictionary</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">][</span><span class="n">cnt</span><span class="p">]</span>
				<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">eleme_json_file</span><span class="p">):</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">eleme_json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
			  	<span class="n">ELEME</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>


		<span class="k">if</span> <span class="n">mark_elements</span><span class="p">:</span>
			<span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Legend&#39;</span>
			<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">wells_corr_json_file</span><span class="p">):</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">wells_corr_json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
				  	<span class="n">well_corr</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">geners</span><span class="p">:</span>
				<span class="n">src</span><span class="o">=</span><span class="n">geners</span><span class="p">[</span><span class="n">gen</span><span class="p">][</span><span class="s1">&#39;SL&#39;</span><span class="p">]</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">geners</span><span class="p">[</span><span class="n">gen</span><span class="p">][</span><span class="s1">&#39;NS&#39;</span><span class="p">])</span>
				<span class="n">corr</span><span class="o">=</span><span class="n">gen</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
				<span class="n">well_corr</span><span class="p">[</span><span class="n">src</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">corr</span><span class="p">]</span>
			<span class="n">corr_well</span> <span class="o">=</span> <span class="p">{</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">well_corr</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">legend</span><span class="o">=</span><span class="s1">&#39;ROCKS&#39;</span>

		<span class="n">fig</span><span class="p">,</span> <span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
		<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;East [m]&quot;</span><span class="p">)</span>
		<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;North [m]&quot;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="n">cross_section</span><span class="p">:</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span><span class="n">y_points</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;A&#39;&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

		<span class="n">colors_on_plot</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">legends</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">layer</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;points&#39;</span><span class="p">]):</span>
					<span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
						<span class="n">fill_x</span><span class="o">=</span><span class="p">[]</span>
						<span class="n">fill_y</span><span class="o">=</span><span class="p">[]</span>
						<span class="n">line</span><span class="o">=</span><span class="p">[]</span>
					<span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
						<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;-k&#39;</span><span class="p">)</span>
						<span class="n">fill_x</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
						<span class="n">fill_y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
						<span class="n">line</span><span class="o">=</span><span class="p">[]</span>
					<span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">4</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
						<span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">plot_center</span><span class="p">:</span>
					<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ELEME</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">ELEME</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="s1">&#39;.k&#39;</span><span class="p">)</span>

				<span class="n">ax0</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">fill_x</span><span class="p">,</span><span class="n">fill_y</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="n">rocktypes</span><span class="p">[</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">]],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
				
				<span class="k">if</span> <span class="n">mark_elements</span><span class="p">:</span>
					<span class="k">if</span> <span class="s1">&#39;red&#39;</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="n">colors_on_plot</span><span class="p">:</span>
						<span class="n">legend_for_rock</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sinks/sources&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
						<span class="n">colors_on_plot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
						<span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend_for_rock</span><span class="p">)</span>
					<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">corr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">block</span> <span class="k">for</span> <span class="n">corr</span> <span class="ow">in</span> <span class="n">well_corr</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
						<span class="n">ax0</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">fill_x</span><span class="p">,</span><span class="n">fill_y</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
						<span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">corr_well</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]],</span>
									<span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ELEME</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">ELEME</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
									<span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">ELEME</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">500</span><span class="p">,</span><span class="n">ELEME</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">500</span><span class="p">),</span><span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
									<span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
									<span class="n">shrinkA</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
									<span class="n">patchA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patchB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
									<span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;bar,angle=180,fraction=-0.2&quot;</span><span class="p">))</span>

				<span class="k">if</span> <span class="n">rocktypes</span><span class="p">[</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">]]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colors_on_plot</span><span class="p">:</span>
					<span class="n">legend_for_rock</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">rocktypes</span><span class="p">[</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
					<span class="n">colors_on_plot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rocktypes</span><span class="p">[</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">]])</span>
					<span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend_for_rock</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legends</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">savefig</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../mesh/layer_</span><span class="si">%s</span><span class="s1">.png&#39;</span><span class="o">%</span><span class="n">layer</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">))</span></div>

<div class="viewcode-block" id="CONNE_count"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.CONNE_count">[docs]</a><span class="k">def</span> <span class="nf">CONNE_count</span><span class="p">(</span><span class="n">save_csv</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Return a dataframe with the name of elements and the number of connection</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd"> 	save_csv: bool</span>
<span class="sd">	  If true writes the output dataframe as csv, default False</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	dataframe</span>
<span class="sd">	  count_conne: blocks and number of connections</span>
<span class="sd">	file:</span>
<span class="sd">	   CONNE_count.csv: at ../mesh/</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">conne_file</span><span class="o">=</span><span class="s1">&#39;../mesh/CONNE.json&#39;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">conne_file</span><span class="p">):</span>
		<span class="n">CONNE_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">conne_file</span><span class="p">)</span>
		<span class="n">CONNE_df</span><span class="o">=</span><span class="n">CONNE_df</span><span class="o">.</span><span class="n">T</span>
		<span class="n">CONNE_df</span><span class="p">[</span><span class="s1">&#39;BLOCKS&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">CONNE_df</span><span class="o">.</span><span class="n">index</span>
		<span class="n">CONNE_df</span><span class="p">[[</span><span class="s1">&#39;block1&#39;</span><span class="p">,</span><span class="s1">&#39;block2&#39;</span><span class="p">]]</span> <span class="o">=</span><span class="n">CONNE_df</span><span class="o">.</span><span class="n">BLOCKS</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]]))</span>

		<span class="n">count_conne_1</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">CONNE_df</span><span class="p">[</span><span class="s1">&#39;block1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
		<span class="n">count_conne_2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">CONNE_df</span><span class="p">[</span><span class="s1">&#39;block2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>

		<span class="n">count_conne</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">count_conne_1</span><span class="p">,</span><span class="n">count_conne_2</span><span class="p">])</span>

		<span class="n">count_conne</span><span class="o">=</span><span class="n">count_conne</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

		<span class="n">count_conne</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">count_conne</span><span class="p">[</span><span class="s1">&#39;block1&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">count_conne</span><span class="p">[</span><span class="s1">&#39;block2&#39;</span><span class="p">]</span>

		<span class="k">del</span> <span class="n">count_conne</span><span class="p">[</span><span class="s1">&#39;block1&#39;</span><span class="p">]</span>
		<span class="k">del</span> <span class="n">count_conne</span><span class="p">[</span><span class="s1">&#39;block2&#39;</span><span class="p">]</span>

		<span class="n">count_conne</span><span class="o">=</span><span class="n">count_conne</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">save_csv</span><span class="p">:</span>
			<span class="n">count_conne</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../mesh/CONNE.csv&#39;</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">count_conne</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">conne_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="mesh_to_paraview"><a class="viewcode-back" href="../modules/regeo_mesh.html#regeo_mesh.mesh_to_paraview">[docs]</a><span class="k">def</span> <span class="nf">mesh_to_paraview</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	It generates a vtu file to be read on Paraview including the rocktype and block name.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd"> 	input_dictionary: dictionary</span>
<span class="sd">	  Contains the information of the layers on the model.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  model_mesh.vtu: on ../mesh</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">segmt_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/segmt.json&#39;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">blocks</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist, run segmnt_to_json from regeo_mesh&quot;</span><span class="o">%</span><span class="n">segmt_json_file</span><span class="p">)</span>		

	<span class="n">ugrid</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkUnstructuredGrid</span><span class="p">()</span>
	<span class="n">block_name</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkStringArray</span><span class="p">()</span>
	<span class="n">block_name</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">)</span>

	<span class="n">rocktype</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkStringArray</span><span class="p">()</span>
	<span class="n">rocktype</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;rocktype&#39;</span><span class="p">)</span>

	<span class="n">layers_dict</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertical_layers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">)</span>

	<span class="n">layers_name</span><span class="o">=</span><span class="p">{}</span>

	<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]):</span>
		<span class="n">layers_name</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">layers_dict</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">layers_dict</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span>

	<span class="n">points_vtk</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>

	<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
	<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>

		<span class="n">faceId</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
		<span class="n">block_name</span><span class="o">.</span><span class="n">InsertNextValue</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
		<span class="n">rocktype</span><span class="o">.</span><span class="n">InsertNextValue</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">])</span>
		<span class="n">points</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;points&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
				<span class="n">point_x</span><span class="o">=</span><span class="n">point</span>
			<span class="k">elif</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">point_y</span><span class="o">=</span><span class="n">point</span>

			<span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="p">[</span><span class="n">point_x</span><span class="p">,</span><span class="n">point_y</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
				<span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">point_x</span><span class="p">,</span><span class="n">point_y</span><span class="p">])</span>

		<span class="n">points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
		<span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

		<span class="n">dict_points</span><span class="o">=</span><span class="p">{}</span>
		
		<span class="n">cnt_int</span><span class="o">=</span><span class="mi">0</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
			<span class="n">dict_points</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">layers_name</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span>
			<span class="n">cnt_int</span><span class="o">+=</span><span class="mi">1</span>

		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
			<span class="n">dict_points</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">layers_name</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span>
			<span class="n">cnt_int</span><span class="o">+=</span><span class="mi">1</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_points</span><span class="p">:</span>
			<span class="n">points_vtk</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">dict_points</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

		<span class="n">faceId</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

		<span class="n">faces</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)]</span>
		<span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">face</span><span class="o">+</span><span class="n">cnt</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))]</span>
		<span class="n">faces</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">face</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))]</span>
		
		<span class="k">for</span> <span class="n">nx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
				<span class="n">faces</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">cnt</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">faces</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">cnt</span><span class="p">]</span>
		
		<span class="n">cnt</span><span class="o">+=</span><span class="n">cnt_int</span>
		
		<span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
			<span class="n">faceId</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">))</span>
			<span class="p">[</span><span class="n">faceId</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">face</span><span class="p">]</span>

		<span class="n">ugrid</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_POLYHEDRON</span><span class="p">,</span><span class="n">faceId</span><span class="p">)</span>
		<span class="n">ugrid</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">block_name</span><span class="p">)</span>
		<span class="n">ugrid</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">rocktype</span><span class="p">)</span>

	<span class="n">ugrid</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points_vtk</span><span class="p">)</span>

	<span class="n">writer</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkXMLUnstructuredGridWriter</span><span class="p">()</span>
	<span class="n">writer</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">ugrid</span><span class="p">)</span>
	<span class="n">writer</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="s1">&#39;../mesh/model_mesh.vtu&#39;</span><span class="p">)</span>
	<span class="n">writer</span><span class="o">.</span><span class="n">SetDataModeToAscii</span><span class="p">()</span>
	<span class="n">writer</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
	<span class="n">writer</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Erick Jimenez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>