

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>report &mdash; T2GEORES  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> T2GEORES
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/gener.html">gener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/geometry.html">geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/it2Obs.html">it2Obs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/model_plots.html">model_plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/output.html">output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/regeo_mesh.html">regeo_mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/run.html">run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/t2geores_functions.html">t2geores_functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/txt2sqlite.html">txt2sqlite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/writer.html">writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/formats.html">formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/report.html">report</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">T2GEORES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>report</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for report</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">T2GEORES</span> <span class="kn">import</span> <span class="n">formats</span> <span class="k">as</span> <span class="n">formats</span>
<span class="kn">from</span> <span class="nn">T2GEORES</span> <span class="kn">import</span> <span class="n">geometry</span> <span class="k">as</span> <span class="n">geometry</span>
<span class="kn">from</span> <span class="nn">T2GEORES</span> <span class="kn">import</span> <span class="n">writer</span> <span class="k">as</span> <span class="n">t2w</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.tri</span> <span class="k">as</span> <span class="nn">mtri</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">vtk</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">ConvexHull</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">iapws</span> <span class="kn">import</span> <span class="n">IAPWS97</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;T2GEORES&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="plot_compare_one"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_one">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_one</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">savefig</span><span class="p">,</span> <span class="n">no_real_data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">TVD_elem</span><span class="p">,</span> <span class="n">TVD_elem_top</span><span class="p">,</span><span class="n">axT</span><span class="p">,</span><span class="n">axP</span><span class="p">,</span><span class="n">PT_real_dictionary</span><span class="p">,</span><span class="n">layer_bottom</span><span class="p">,</span><span class="n">limit_layer</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">def_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates two plots, they compare real downhole temperature and pressure measurements with model output </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	well : str</span>
<span class="sd">	  Selected well</span>
<span class="sd">	savefig : bool</span>
<span class="sd">	  If true the plot is saved on ../output/PT/images/logging/</span>
<span class="sd">	PT_real_dictionary : dictionary</span>
<span class="sd">	  Contains real  measurements on temperature, pressure and measure depth</span>
<span class="sd">	no_real_data : bool</span>
<span class="sd">	  If True, no real measurements are provides</span>
<span class="sd">	data : pandas dataframe</span>
<span class="sd">	  Contains model output information for each element assigned to a well</span>
<span class="sd">	TVD_elem : array</span>
<span class="sd">	  Contains the masl data at the middle for each element assigned to a well</span>
<span class="sd">	TVD_elem_top : array</span>
<span class="sd">	  Contains the masl data at the top  for each element assigned to a well</span>
<span class="sd">	axT : matplotlib_axis</span>
<span class="sd">	  Framework where temperature data is plotted</span>
<span class="sd">	axP : matplotlib_axis</span>
<span class="sd">	  Framework where temperature data is plotted</span>
<span class="sd">	layer_bottom : array</span>
<span class="sd">	  Contains the masl data at the bottom for each element assigned to a well</span>
<span class="sd">	limit_layer : str</span>
<span class="sd">	  Layer correlative at which plotting stops</span>
<span class="sd">	input_dictionary: dictionary</span>
<span class="sd">	  Contains the information of the top level of the mesh on under the key &#39;z_ref&#39;</span>
<span class="sd">	label : str</span>
<span class="sd">	  Contains the legend of the plotted line</span>
<span class="sd">	def_colors : True</span>
<span class="sd">	  If True uses the colors defined on formats</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	image</span>
<span class="sd">		PT_{well}.png: on the path../output/PT/images/logging</span>
<span class="sd">	matplotlib_axis</span>
<span class="sd">	    axT: contains real and simulated downhole temperature data</span>
<span class="sd">	matplotlib_axis</span>
<span class="sd">	    axP: contains real and simulated downhole pressure data</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	It is used in combination of the function plot_compare_one_data</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">fontsize_plot</span><span class="o">=</span><span class="mi">8</span>
	<span class="n">fontsize_layer</span><span class="o">=</span><span class="mi">6</span>

	<span class="n">z_ref</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;z_ref&#39;</span><span class="p">]</span>

	<span class="c1">#Define plot</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">no_real_data</span><span class="p">:</span>

		<span class="c1">#Plotting real data</span>

		<span class="n">ln1T</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;var_T&#39;</span><span class="p">],</span><span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;z_T&#39;</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Measured&#39;</span><span class="p">)</span>

		<span class="n">ln1P</span><span class="o">=</span><span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;var_P&#39;</span><span class="p">],</span><span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;z_P&#39;</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Measured&#39;</span><span class="p">)</span>

		<span class="n">lnsT</span> <span class="o">=</span> <span class="n">ln1T</span>

		<span class="n">lnsP</span> <span class="o">=</span> <span class="n">ln1P</span>

	<span class="c1">#Plotting the calculated data</span>

	<span class="n">ln2T</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span><span class="n">TVD_elem</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Calculated </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">label</span><span class="p">)</span>

	<span class="n">ln2P</span><span class="o">=</span><span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1E5</span><span class="p">,</span><span class="n">TVD_elem</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Calculated </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">label</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">def_colors</span><span class="p">:</span>
		<span class="n">color_real_T</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">color_real_P</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

		<span class="n">ln1T</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color_real_T</span><span class="p">)</span>
		<span class="n">ln2T</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color_real_T</span><span class="p">)</span>

		<span class="n">ln1P</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color_real_P</span><span class="p">)</span>
		<span class="n">ln2P</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color_real_P</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">layer_bottom</span><span class="p">[</span><span class="n">limit_layer</span><span class="p">],</span><span class="n">z_ref</span><span class="p">])</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">layer_bottom</span><span class="p">[</span><span class="n">limit_layer</span><span class="p">],</span><span class="n">z_ref</span><span class="p">])</span>

	<span class="c1">#Preparing the layer axis side for pressure</span>

	<span class="n">ax2P</span> <span class="o">=</span> <span class="n">axP</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem_top</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;correlative&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_layer</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axP</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

	<span class="c1">#Preparing the layer axis side for temperature</span>

	<span class="n">ax2T</span> <span class="o">=</span> <span class="n">axT</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem_top</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
	
	<span class="n">ax2T</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;correlative&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_layer</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axT</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

	<span class="c1">#Preparing the legends on temperature side</span>
	<span class="k">if</span> <span class="n">no_real_data</span><span class="p">:</span>
		<span class="n">lnsT</span><span class="o">=</span><span class="n">ln2T</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">lnsT</span><span class="o">+=</span><span class="n">ln2T</span>

	<span class="n">labsT</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lnsT</span><span class="p">]</span>

	<span class="c1">#axT.legend(lnsT, labsT, loc=&#39;upper right&#39;, fontsize=fontsize_plot)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_plot</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$^\circ$C]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_plot</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;m.a.s.l.&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsize_plot</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize_plot</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

	<span class="c1">#Preparing the legends on pressure side</span>
	<span class="k">if</span> <span class="n">no_real_data</span><span class="p">:</span>
		<span class="n">lnsP</span><span class="o">=</span><span class="n">ln2P</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">lnsP</span><span class="o">+=</span><span class="n">ln2P</span>

	<span class="n">labsP</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lnsP</span><span class="p">]</span>

	<span class="c1">#axP.legend(lnsP, labsP, loc=&#39;upper right&#39;, fontsize=fontsize_plot)</span>
	
	<span class="n">axP</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_plot</span><span class="p">)</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pressure [bar]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_plot</span><span class="p">)</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize_plot</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

	<span class="c1">#Title for both plots</span>

	<span class="c1">#plt.subplots_adjust(top=0.92)</span>

	<span class="k">if</span> <span class="n">savefig</span><span class="p">:</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/PT/images/logging/PT_</span><span class="si">%s</span><span class="s1">.png&#39;</span><span class="o">%</span><span class="n">well</span><span class="p">)</span></div>

<div class="viewcode-block" id="plot_compare_one_data"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_one_data">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_one_data</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">inpath</span><span class="o">=</span><span class="s2">&quot;../output/PT/txt&quot;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Compiles real and output for temperature and pressure data </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	  </span>
<span class="sd">	well : str</span>
<span class="sd">	  Selected well</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	  Dictionary contaning the path and name of database on keyword &#39;db_path&#39;</span>
<span class="sd">	inpath : str</span>
<span class="sd">	  Constains path for input files. Default value is &quot;../output/PT/txt&quot;</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	PT_real_dictionary : dictionary</span>
<span class="sd">	  Contains real  measurements on temperature, pressure and measure depth</span>
<span class="sd">	no_real_data : bool</span>
<span class="sd">	  If True, no real measurements are provides</span>
<span class="sd">	data : pandas dataframe</span>
<span class="sd">	  Contains model output information for each element assigned to a well</span>
<span class="sd">	TVD_elem : array</span>
<span class="sd">	  Contains the masl data at the middle for each element assigned to a well</span>
<span class="sd">	TVD_elem_top : array</span>
<span class="sd">	  Contains the masl data at the top  for each element assigned to a well</span>
<span class="sd">	layer_bottom : array</span>
<span class="sd">	  Contains the masl data at the bottom for each element assigned to a well</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	The real data is taken from the the sqlite database</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">PT_real_dictionary</span><span class="o">=</span><span class="p">{}</span>

	<span class="k">try</span><span class="p">:</span>

		<span class="c1">#Plotting real data</span>
		<span class="n">data_PT_real</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well, MeasuredDepth, Pressure, Temperature FROM PT WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

		<span class="n">x_T</span><span class="p">,</span><span class="n">y_T</span><span class="p">,</span><span class="n">z_T</span><span class="p">,</span><span class="n">var_T</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD_one_var_array</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

		<span class="n">x_P</span><span class="p">,</span><span class="n">y_P</span><span class="p">,</span><span class="n">z_P</span><span class="p">,</span><span class="n">var_P</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD_one_var_array</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;Pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;x_T&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">x_T</span>
		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;y_T&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_T</span>
		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;z_T&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">z_T</span>
		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;var_T&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">var_T</span>

		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;x_P&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">x_P</span>
		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;y_P&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_P</span>
		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;z_P&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">z_P</span>
		<span class="n">PT_real_dictionary</span><span class="p">[</span><span class="s1">&#39;var_P&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">var_P</span>

		<span class="n">no_real_data</span><span class="o">=</span><span class="kc">False</span>

	<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>

		<span class="n">data_PT_real</span><span class="o">=</span><span class="kc">None</span>

		<span class="n">no_real_data</span><span class="o">=</span><span class="kc">True</span>

		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No real data for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">)</span>

	<span class="c1">#Preparing the input file from the t2 results</span>

	<span class="n">in_file</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">inpath</span><span class="p">,</span><span class="n">well</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">in_file</span><span class="p">):</span>

		<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_file</span><span class="p">)</span>

		<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;correlative&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">ELEM</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

		<span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;correlative&#39;</span> <span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

		<span class="c1">#Retrieving the layers information from model_conf</span>

		<span class="n">layers_info</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertical_layers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">)</span>

		<span class="n">TVD_elem</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;middle&#39;</span><span class="p">]</span>

		<span class="n">TVD_elem_top</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span>

		<span class="n">layer_bottom</span><span class="o">=</span><span class="p">{</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]:</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))}</span>

		<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

		<span class="k">return</span> <span class="n">data_PT_real</span><span class="p">,</span> <span class="n">no_real_data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">TVD_elem</span><span class="p">,</span> <span class="n">TVD_elem_top</span><span class="p">,</span> <span class="n">PT_real_dictionary</span><span class="p">,</span> <span class="n">layer_bottom</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist&quot;</span><span class="o">%</span><span class="n">in_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="image_save_all_plots"><a class="viewcode-back" href="../modules/report.html#report.image_save_all_plots">[docs]</a><span class="k">def</span> <span class="nf">image_save_all_plots</span><span class="p">(</span><span class="n">typePT</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It plots all the wells defined on input_dictionay and compare real data with model output</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------	  </span>
<span class="sd">	db_path : str</span>
<span class="sd">	  Direccion de base de datos sqlite, tomado de model_conf</span>
<span class="sd">	input_dictionary : dictionary</span>
<span class="sd">	 Dictionary contaning the path and name of database on keyword &#39;db_path&#39;, list of wells under the keywords &#39;WELLS&#39;, &#39;MAKE_UP_WELLS&#39; and &#39;NOT_PRODUCING_WELL&#39;. Lastly, it contains the information of the top level of the mesh on under the key &#39;z_ref&#39;</span>
<span class="sd">	typePT : str</span>
<span class="sd">	  &#39;T&#39; for temperature or &#39;P&#39; for pressure</span>
<span class="sd">	height : float</span>
<span class="sd">	  Defines the ratio height/width</span>
<span class="sd">	width  : float</span>
<span class="sd">	  By dividing the number of wells defines the number of rows on the chart</span>


<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	image</span>
<span class="sd">		{typePT}_all.png: on path ../output/PT/images/logging/</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	The real data is taken from the the sqlite database. Depending on the number of wells defined the default values for width and height migth be changed</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; image_save_all_plots(typePT=&#39;T&#39;,input_dictionary)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">wells</span><span class="o">=</span><span class="p">[]</span>

	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;MAKE_UP_WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;NOT_PRODUCING_WELL&#39;</span><span class="p">]:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">input_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
				<span class="n">wells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>
	<span class="n">z_ref</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;z_ref&#39;</span><span class="p">]</span>

	<span class="n">limit_layer</span><span class="o">=</span><span class="s1">&#39;U&#39;</span>

	<span class="n">fontsizex</span><span class="o">=</span><span class="mi">4</span>

	<span class="n">fontsize_layer</span><span class="o">=</span><span class="mi">3</span>

	<span class="n">rows</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wells</span><span class="p">)</span><span class="o">/</span><span class="n">width</span><span class="p">))</span>

	<span class="n">widths</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span>

	<span class="c1">#heights=[int(2*(40.0/3)*len(widths)/int(math.ceil(len(wells)/3.0)))+1 for n in range(int(math.ceil(len(wells)/3.0)))]</span>

	<span class="n">heights</span><span class="o">=</span><span class="p">[</span><span class="n">height</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)]</span>

	<span class="c1">#gs = gridspec.GridSpec(nrows=len(heights), ncols=len(widths), width_ratios=widths, height_ratios=heights,hspace=0.8, wspace=0.7)</span>

	<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">width</span><span class="p">,</span><span class="n">width_ratios</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

	<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="n">rows</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Calculated vs  </span><span class="si">%s</span><span class="s2"> Measured&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">typePT</span><span class="p">,</span><span class="n">typePT</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>

	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">layers_info</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertical_layers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">)</span>

	<span class="n">layer_bottom</span><span class="o">=</span><span class="p">{</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]:</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))}</span>

	<span class="n">layer_middle</span><span class="o">=</span><span class="p">{</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]:</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;middle&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))}</span>

	<span class="n">layer_top</span><span class="o">=</span><span class="p">{</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]:</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))}</span>

	<span class="n">TVD_elem</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;middle&#39;</span><span class="p">]</span>

	<span class="n">TVD_elem_top</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span>

	<span class="n">ymin</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT bottom FROM layers WHERE correlative=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">limit_layer</span><span class="p">,</span><span class="n">conn</span><span class="p">)[</span><span class="s1">&#39;bottom&#39;</span><span class="p">])</span>

	<span class="k">if</span> <span class="n">typePT</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">]:</span>
		<span class="k">if</span> <span class="n">typePT</span><span class="o">==</span><span class="s1">&#39;P&#39;</span><span class="p">:</span>
			<span class="n">data_to_extract</span><span class="o">=</span><span class="s1">&#39;Pressure&#39;</span>
			<span class="n">label_name</span><span class="o">=</span><span class="s1">&#39;Pressure [bar]&#39;</span>
			<span class="n">data_lims</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">]</span>
			<span class="n">divisor</span><span class="o">=</span><span class="mf">1E5</span>
		<span class="k">elif</span> <span class="n">typePT</span><span class="o">==</span><span class="s1">&#39;T&#39;</span><span class="p">:</span>
			<span class="n">data_to_extract</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span>
			<span class="n">data_lims</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">]</span>
			<span class="n">divisor</span><span class="o">=</span><span class="mi">1</span>
			<span class="n">label_name</span><span class="o">=</span><span class="s1">&#39;Temperature [$^\circ$C]&#39;</span>

		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>

			<span class="c1">#Real data</span>
			<span class="n">data_PT_real</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well, MeasuredDepth, Pressure, Temperature FROM PT WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39; ORDER BY MeasuredDepth DESC;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
			<span class="n">data_PT_real</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_PT_real</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>

				<span class="n">x_T</span><span class="p">,</span><span class="n">y_T</span><span class="p">,</span><span class="n">z_T</span><span class="p">,</span><span class="n">var_T</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD_one_var_array</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="n">data_to_extract</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

				<span class="c1">#Define plot</span>

				<span class="n">axT</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				
				<span class="n">ln1T</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_T</span><span class="p">,</span><span class="n">z_T</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="n">typePT</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Measured&#39;</span><span class="p">)</span>

				<span class="c1">#Model</span>

				<span class="n">in_file</span><span class="o">=</span><span class="s2">&quot;../output/PT/txt/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="n">name</span>

				<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">in_file</span><span class="p">):</span>

					<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_file</span><span class="p">)</span>

					<span class="n">blk_num</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

					<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;correlative&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">ELEM</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

					<span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;correlative&#39;</span> <span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

					<span class="c1">#ln2T=axT.plot(np.array(data[typePT])/divisor,np.array(TVD_elem)</span>
					<span class="n">zs</span><span class="o">=</span><span class="p">[]</span>
					<span class="k">for</span> <span class="n">bz</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]:</span>
						<span class="n">zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_middle</span><span class="p">[</span><span class="n">bz</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

					<span class="n">zp</span><span class="o">=</span><span class="p">[]</span>
					<span class="k">for</span> <span class="n">bz</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]:</span>
						<span class="n">zp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_top</span><span class="p">[</span><span class="n">bz</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

					<span class="n">ln2T</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">typePT</span><span class="p">])</span><span class="o">/</span><span class="n">divisor</span><span class="p">,</span><span class="n">zs</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="n">typePT</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Calculated&#39;</span><span class="p">)</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">layer_bottom</span><span class="p">[</span><span class="n">limit_layer</span><span class="p">],</span><span class="n">z_ref</span><span class="p">])</span>
					
					<span class="n">axT</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">data_lims</span><span class="p">)</span>

					<span class="n">ax2T</span> <span class="o">=</span> <span class="n">axT</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

					<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">zp</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

					<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
					
					<span class="n">ax2T</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

					<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;correlative&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_layer</span><span class="p">)</span>

					<span class="n">ax2T</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

					<span class="n">ax2T</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axT</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

					<span class="n">lnsT</span> <span class="o">=</span> <span class="n">ln1T</span><span class="o">+</span><span class="n">ln2T</span>

					<span class="n">labsT</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lnsT</span><span class="p">]</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lnsT</span><span class="p">,</span> <span class="n">labsT</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">)</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">label_name</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.3</span><span class="p">)</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;m.a.s.l.&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizex</span><span class="p">)</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>

					<span class="n">axT</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

					<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File does not exist&quot;</span><span class="p">)</span>

			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

		<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../output/PT/images/</span><span class="si">%s</span><span class="s2">_all.png&quot;</span><span class="o">%</span><span class="n">typePT</span><span class="p">)</span> 
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;There is no real data for the parameter selected: </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="o">%</span><span class="n">typePT</span><span class="p">)</span></div>

<div class="viewcode-block" id="to_paraview"><a class="viewcode-back" href="../modules/report.html#report.to_paraview">[docs]</a><span class="k">def</span> <span class="nf">to_paraview</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">itime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	It generates a vtu file to be read on Paraview for different time output including all the parameters from each block.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd"> 	input_dictionary: dictionary</span>
<span class="sd">	  Contains the information of the layers on the model</span>
<span class="sd">	itime: float</span>
<span class="sd">	  It defines a time at which a the parameters from the blocks are extracted into json file. Must be on the same units as the TOUGH2 output files (days, seconds, etc.)</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	file</span>
<span class="sd">	  to_paraview.vtu: on ../mesh</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">segmt_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/segmt.json&#39;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">blocks</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> or directory do not exist, run segmnt_to_json from regeo_mesh&quot;</span><span class="o">%</span><span class="n">segmt_json_file</span><span class="p">)</span>		

	<span class="n">ugrid</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkUnstructuredGrid</span><span class="p">()</span>
	<span class="n">block_name</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkStringArray</span><span class="p">()</span>
	<span class="n">block_name</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">)</span>

	<span class="n">rocktype</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkStringArray</span><span class="p">()</span>
	<span class="n">rocktype</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;rocktype&#39;</span><span class="p">)</span>

	<span class="n">layers_dict</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertical_layers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">)</span>

	<span class="n">layers_name</span><span class="o">=</span><span class="p">{}</span>

	<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]):</span>
		<span class="n">layers_name</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">layers_dict</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">layers_dict</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span>

	<span class="n">points_vtk</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>

	<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
	<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>

		<span class="n">faceId</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
		<span class="n">block_name</span><span class="o">.</span><span class="n">InsertNextValue</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
		<span class="n">rocktype</span><span class="o">.</span><span class="n">InsertNextValue</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;rocktype&#39;</span><span class="p">])</span>
		<span class="n">points</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;points&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
				<span class="n">point_x</span><span class="o">=</span><span class="n">point</span>
			<span class="k">elif</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">point_y</span><span class="o">=</span><span class="n">point</span>

			<span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="p">[</span><span class="n">point_x</span><span class="p">,</span><span class="n">point_y</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
				<span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">point_x</span><span class="p">,</span><span class="n">point_y</span><span class="p">])</span>

		<span class="n">points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
		<span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

		<span class="n">dict_points</span><span class="o">=</span><span class="p">{}</span>
		
		<span class="n">cnt_int</span><span class="o">=</span><span class="mi">0</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
			<span class="n">dict_points</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">layers_name</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span>
			<span class="n">cnt_int</span><span class="o">+=</span><span class="mi">1</span>

		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
			<span class="n">dict_points</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">layers_name</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]]</span>
			<span class="n">cnt_int</span><span class="o">+=</span><span class="mi">1</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_points</span><span class="p">:</span>
			<span class="n">points_vtk</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">dict_points</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

		<span class="n">faceId</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

		<span class="n">faces</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)]</span>
		<span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">face</span><span class="o">+</span><span class="n">cnt</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))]</span>
		<span class="n">faces</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">face</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))]</span>
		
		<span class="k">for</span> <span class="n">nx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
				<span class="n">faces</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">cnt</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">faces</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">nx</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">+</span><span class="n">cnt</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">cnt</span><span class="p">]</span>
		
		<span class="n">cnt</span><span class="o">+=</span><span class="n">cnt_int</span>
		
		<span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
			<span class="n">faceId</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">))</span>
			<span class="p">[</span><span class="n">faceId</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">face</span><span class="p">]</span>

		<span class="n">ugrid</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_POLYHEDRON</span><span class="p">,</span><span class="n">faceId</span><span class="p">)</span>
		<span class="n">ugrid</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">block_name</span><span class="p">)</span>
		<span class="n">ugrid</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">rocktype</span><span class="p">)</span>

	<span class="n">ugrid</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points_vtk</span><span class="p">)</span>

	<span class="n">series</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file-series-version&quot;</span><span class="p">:</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
			<span class="s2">&quot;files&quot;</span><span class="p">:[],</span>
			<span class="p">}</span>

	<span class="n">src_directory</span><span class="o">=</span><span class="s1">&#39;../output/PT/json/evol&#39;</span>
	<span class="n">src_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">src_directory</span><span class="p">)</span>
	<span class="n">files_dictionary</span><span class="o">=</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">src_files</span><span class="p">:</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_directory</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)):</span>
			<span class="n">time</span><span class="o">=</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.j&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">full_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_directory</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
			<span class="n">files_dictionary</span><span class="p">[</span><span class="n">time</span><span class="p">]</span><span class="o">=</span><span class="n">full_file_name</span>
	<span class="nb">print</span><span class="p">(</span><span class="n">files_dictionary</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">num</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files_dictionary</span><span class="p">),</span> <span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files_dictionary</span><span class="p">))</span>

	<span class="k">if</span> <span class="n">itime</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">files_dictionary</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">files_dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>

				<span class="k">if</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
					<span class="n">file_name</span><span class="o">=</span><span class="n">src_directory</span><span class="o">+</span><span class="s1">&#39;/t2_output_</span><span class="si">%.0f</span><span class="s1">.json&#39;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
					<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
					  	<span class="n">data_time_n</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

					<span class="nb">print</span><span class="p">(</span><span class="n">data_time_n</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

					<span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

					<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
					<span class="k">for</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">data_time_n</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">block</span><span class="p">]:</span>
						<span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
							<span class="n">data</span><span class="p">[</span><span class="n">head</span><span class="p">]</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
							<span class="n">data</span><span class="p">[</span><span class="n">head</span><span class="p">]</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>

					<span class="c1">#temperature=vtk.vtkFloatArray()</span>
					<span class="c1">#temperature.SetName(&#39;temperature&#39;)</span>

					<span class="c1">#pressure=vtk.vtkFloatArray()</span>
					<span class="c1">#pressure.SetName(&#39;pressure&#39;)</span>

					<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">data_time_n</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">block</span><span class="p">]:</span>
							<span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
								<span class="n">data</span><span class="p">[</span><span class="n">head</span><span class="p">]</span><span class="o">.</span><span class="n">InsertNextValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data_time_n</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">block</span><span class="p">][</span><span class="n">head</span><span class="p">]))</span>
								<span class="n">ugrid</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">head</span><span class="p">])</span>

						<span class="c1">#pressure.InsertNextValue(float(data_time_n[t][block][&#39;P&#39;])/1E5)</span>
						<span class="c1">#temperature.InsertNextValue(float(data_time_n[t][block][&#39;T&#39;]))</span>
						<span class="c1">#ugrid.GetCellData().AddArray(pressure)</span>
						<span class="c1">#ugrid.GetCellData().AddArray(temperature)</span>

					<span class="n">writer</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkXMLUnstructuredGridWriter</span><span class="p">()</span>
					<span class="n">writer</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">ugrid</span><span class="p">)</span>
					<span class="n">writer</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="s1">&#39;../output/vtu/model_</span><span class="si">%.0f</span><span class="s1">.vtu&#39;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
					<span class="n">series</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;mesh_</span><span class="si">%.0f</span><span class="s2">.vtu&quot;</span><span class="o">%</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="s2">&quot;time&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)})</span>
					<span class="n">writer</span><span class="o">.</span><span class="n">SetDataModeToAscii</span><span class="p">()</span>
					<span class="n">writer</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

					<span class="n">writer</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>

			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/vtu/model_.vtu.series&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">series</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;There are no json files generated, run t2_to_json from output&quot;</span><span class="p">)</span>		
	<span class="k">else</span><span class="p">:</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">files_dictionary</span><span class="p">:</span>
			<span class="n">file_name</span><span class="o">=</span><span class="n">src_directory</span><span class="o">+</span><span class="s1">&#39;/t2_output_</span><span class="si">%6.5E</span><span class="s1">.json&#39;</span><span class="o">%</span><span class="n">itime</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
			  	<span class="n">data_time_n</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

			<span class="n">temperature</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
			<span class="n">temperature</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>

			<span class="n">pressure</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
			<span class="n">pressure</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">)</span>

			<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>
				<span class="n">pressure</span><span class="o">.</span><span class="n">InsertNextValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data_time_n</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;P&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">1E5</span><span class="p">)</span>
				<span class="n">temperature</span><span class="o">.</span><span class="n">InsertNextValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data_time_n</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;T&#39;</span><span class="p">]))</span>
				<span class="n">ugrid</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span>
				<span class="n">ugrid</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>

			<span class="n">writer</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkXMLUnstructuredGridWriter</span><span class="p">()</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">ugrid</span><span class="p">)</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="s1">&#39;../output/vtu/model_</span><span class="si">%s</span><span class="s1">.vtu&#39;</span><span class="o">%</span><span class="n">t</span><span class="p">)</span>
			<span class="n">series</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;mesh_</span><span class="si">%6.5E</span><span class="s2">.vtu&quot;</span><span class="o">%</span><span class="n">itime</span><span class="p">,</span><span class="s2">&quot;time&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="n">itime</span><span class="p">)})</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">SetDataModeToAscii</span><span class="p">()</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

			<span class="n">writer</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>

			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../output/vtu/model_.vtu.series&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">series</span><span class="p">,</span><span class="n">f</span><span class="p">)</span></div>

<div class="viewcode-block" id="vertical_cross_section"><a class="viewcode-back" href="../modules/report.html#report.vertical_cross_section">[docs]</a><span class="k">def</span> <span class="nf">vertical_cross_section</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">ngridx</span><span class="p">,</span><span class="n">ngridy</span><span class="p">,</span><span class="n">variable_to_plot</span><span class="p">,</span><span class="n">source</span><span class="p">,</span><span class="n">show_wells_3D</span><span class="p">,</span><span class="n">print_point</span><span class="p">,</span><span class="n">savefig</span><span class="p">,</span><span class="n">plots_conf</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It Generates a vertical cross section for a specified parameter on a defined path.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	   </span>
<span class="sd">	ngridx : int</span>
<span class="sd">	  Number of element on the horizontal direction</span>
<span class="sd">	ngridy : int</span>
<span class="sd">	  Number of element on the vertical direction</span>
<span class="sd">	show_wells_3D : bool</span>
<span class="sd">	  If true the wells are shown on 3D</span>
<span class="sd">	print_point : bool</span>
<span class="sd">	  If true prints the points where the interpolation has taken place.</span>
<span class="sd">	variable_to_plot : str</span>
<span class="sd">	  Variable to plot: &quot;P&quot;,&quot;T&quot;,&quot;SG&quot;,&quot;SW&quot;,&quot;X1&quot;,&quot;X2&quot;,&quot;PCAP,&quot;&quot;DG&quot; y &quot;DW&quot; for &#39;t2&#39; source; &quot;P&quot; and &quot;T&quot; for &#39;sav&#39; source</span>
<span class="sd">	source: str</span>
<span class="sd">	  &#39;t2&#39; or &#39;sav&#39;</span>
<span class="sd">	savefig : bool</span>
<span class="sd">	  If true the plot is saved</span>
<span class="sd">	plots_conf: dictionary</span>
<span class="sd">	  With key words &#39;cross_section&#39; defines the points of a lines for the vertical section. &#39;variables_level&#39; defines the variable values to plot</span>
<span class="sd">	input_dictionary: dictioanary</span>
<span class="sd">	  Contains the &#39;LAYERS&#39; keyword</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	image</span>
<span class="sd">		vertical_section_{varible_to_plot}.png: on &#39;../output/PT/images/</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	The point should not be defined on a well coordinate.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; plots_conf={&#39;cross_section&#39;:{&#39;x&#39;:[5000,5000,7500],&#39;y&#39;:[3000,7250,7250]},&#39;variable_levels&#39;:[25,50,75,100,125,150,170,180,200,220,230,250,260]}</span>
<span class="sd">	&gt;&gt;&gt; input_dictionary={&#39;LAYERS&#39;:{1:[&#39;A&#39;,100],2:[&#39;B&#39;, 100],3:[&#39;C&#39;, 125]}}</span>
<span class="sd">	&gt;&gt;&gt; vertical_cross_section(ngridx=100,ngridy=100,variable_to_plot=&quot;T&quot;,source=&quot;t2&quot;,show_wells_3D=True)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">x_points</span><span class="o">=</span><span class="n">plots_conf</span><span class="p">[</span><span class="s1">&#39;cross_section&#39;</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
	<span class="n">y_points</span><span class="o">=</span><span class="n">plots_conf</span><span class="p">[</span><span class="s1">&#39;cross_section&#39;</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
	<span class="n">variable_levels</span><span class="o">=</span><span class="n">plots_conf</span><span class="p">[</span><span class="s1">&#39;variable_levels&#39;</span><span class="p">]</span>

	<span class="n">variables_to_plot_t2</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;P&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
						   <span class="s2">&quot;T&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
						   <span class="s2">&quot;SG&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
						   <span class="s2">&quot;SW&quot;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span>
						   <span class="s2">&quot;X1&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>
						   <span class="s2">&quot;X2&quot;</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span>
						   <span class="s2">&quot;PCAP&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
						   <span class="s2">&quot;DG&quot;</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span>
						   <span class="s2">&quot;DW&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">}</span>

	<span class="n">variables_to_plot_sav</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;P&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
	                       <span class="s2">&quot;T&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>

	<span class="k">if</span> <span class="n">source</span><span class="o">==</span><span class="s2">&quot;sav&quot;</span><span class="p">:</span>
		<span class="n">index</span><span class="o">=</span><span class="n">variables_to_plot_sav</span><span class="p">[</span><span class="n">variable_to_plot</span><span class="p">]</span>
		<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../output/PT/json/PT_json_from_sav.txt&quot;</span>
	<span class="k">elif</span> <span class="n">source</span><span class="o">==</span><span class="s2">&quot;t2&quot;</span><span class="p">:</span>
		<span class="n">index</span><span class="o">=</span><span class="n">variables_to_plot_t2</span><span class="p">[</span><span class="n">variable_to_plot</span><span class="p">]</span>
		<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../output/PT/json/PT_json.txt&quot;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	  		<span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
	  	

	<span class="n">variable_min</span><span class="o">=</span><span class="mf">100E8</span>
	<span class="n">variable_max</span><span class="o">=</span><span class="mi">0</span>

	<span class="c1">#Creates an irregular grid with the form [[x,y,z],[x1,y1,z1]]</span>
	<span class="n">irregular_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
	<span class="n">variable</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
	<span class="k">for</span> <span class="n">elementx</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">variable_max</span><span class="o">&lt;</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="n">variable_to_plot</span><span class="p">]:</span>
			<span class="n">variable_max</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="n">variable_to_plot</span><span class="p">]</span>

		<span class="k">if</span> <span class="n">variable_min</span><span class="o">&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="n">variable_to_plot</span><span class="p">]:</span>
			<span class="n">variable_min</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="n">variable_to_plot</span><span class="p">]</span>

		<span class="n">irregular_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irregular_grid</span><span class="p">,[[</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="s1">&#39;Z&#39;</span><span class="p">]]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">variable</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="n">elementx</span><span class="p">][</span><span class="n">variable_to_plot</span><span class="p">])</span>


	<span class="n">irregular_grid</span><span class="o">=</span><span class="n">irregular_grid</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
	<span class="n">variable</span><span class="o">=</span><span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span>


	<span class="c1">#Creates the points a long the lines</span>
	<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
	<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
	
	<span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_points</span><span class="p">)):</span>
		<span class="k">if</span> <span class="n">xy</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_points</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">xt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_points</span><span class="p">[</span><span class="n">xy</span><span class="p">],</span><span class="n">x_points</span><span class="p">[</span><span class="n">xy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">x_points</span><span class="p">[</span><span class="n">xy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x_points</span><span class="p">[</span><span class="n">xy</span><span class="p">])</span><span class="o">/</span><span class="n">ngridx</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">ngridx</span><span class="p">)</span>
			<span class="n">yt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_points</span><span class="p">[</span><span class="n">xy</span><span class="p">],</span><span class="n">y_points</span><span class="p">[</span><span class="n">xy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">y_points</span><span class="p">[</span><span class="n">xy</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y_points</span><span class="p">[</span><span class="n">xy</span><span class="p">])</span><span class="o">/</span><span class="n">ngridy</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">ngridy</span><span class="p">)</span>
			<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xt</span><span class="p">)</span>
			<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yt</span><span class="p">)</span>

	<span class="c1">#Calculastes the distance of every point along the projection</span>

	<span class="n">projection_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
	<span class="k">for</span> <span class="n">npr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
		<span class="k">if</span> <span class="n">npr</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="k">break</span>
		<span class="k">if</span> <span class="n">npr</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">delta_x_pr</span><span class="o">=</span><span class="p">(</span><span class="n">x_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
			<span class="n">delta_y_pr</span><span class="o">=</span><span class="p">(</span><span class="n">y_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
			<span class="n">prj_prox</span><span class="o">=</span><span class="p">(</span><span class="n">delta_y_pr</span><span class="o">+</span><span class="n">delta_x_pr</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">delta_x_pr</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">npr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">npr</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
			<span class="n">delta_y_pr</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">npr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">npr</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
			<span class="n">prj_prox</span><span class="o">=</span><span class="p">(</span><span class="n">delta_y_pr</span><span class="o">+</span><span class="n">delta_x_pr</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
		<span class="n">projection_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">projection_req</span><span class="p">,</span><span class="n">prj_prox</span><span class="o">+</span><span class="n">projection_req</span><span class="p">[</span><span class="n">npr</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

	<span class="n">layers_info</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertical_layers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">)</span>

	<span class="n">zmid</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;middle&#39;</span><span class="p">]</span>

	<span class="n">ztop</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span>

	<span class="n">zbottom</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span>

	<span class="n">zlabels</span><span class="o">=</span><span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

	<span class="c1">#Creates the regular  mesh in 3D along all the layers</span>

	<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">ngridx</span><span class="p">)</span>
	<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">ngridy</span><span class="p">)</span>
	<span class="n">zi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zmid</span><span class="p">)</span>

	<span class="n">proj_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
	<span class="n">z_req_proj</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

	<span class="k">for</span> <span class="n">nprj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">projection_req</span><span class="p">)):</span>
		<span class="k">for</span> <span class="n">nz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zi</span><span class="p">)):</span>
			<span class="n">proj_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proj_req</span><span class="p">,</span><span class="n">projection_req</span><span class="p">[</span><span class="n">nprj</span><span class="p">])</span>
			<span class="n">z_req_proj</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_req_proj</span><span class="p">,</span><span class="n">zi</span><span class="p">[</span><span class="n">nz</span><span class="p">])</span>

	<span class="n">request_points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
	<span class="n">x_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
	<span class="n">y_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
	<span class="n">z_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>


	<span class="k">for</span> <span class="n">nx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
		<span class="k">for</span> <span class="n">nz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zi</span><span class="p">)):</span>
			<span class="n">request_points</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">request_points</span><span class="p">,[[</span><span class="n">x</span><span class="p">[</span><span class="n">nx</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">nx</span><span class="p">],</span><span class="n">zi</span><span class="p">[</span><span class="n">nz</span><span class="p">]]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">x_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_req</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">nx</span><span class="p">])</span>
			<span class="n">y_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_req</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="n">nx</span><span class="p">])</span>
			<span class="n">z_req</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_req</span><span class="p">,</span><span class="n">zi</span><span class="p">[</span><span class="n">nz</span><span class="p">])</span>

	<span class="n">request_points</span><span class="o">=</span><span class="n">request_points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

	<span class="n">requested_values</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">irregular_grid</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">request_points</span><span class="p">)</span>

	<span class="c1">#Creates regular mesh on projection</span>

	<span class="n">xi_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">proj_req</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">proj_req</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
	<span class="n">yi_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">z_req_proj</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">z_req_proj</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
	<span class="n">zi_pr</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="n">proj_req</span><span class="p">,</span> <span class="n">z_req_proj</span><span class="p">),</span> <span class="n">requested_values</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">zmid</span><span class="p">)],</span> <span class="p">(</span><span class="n">xi_pr</span><span class="p">[</span><span class="kc">None</span><span class="p">,:],</span> <span class="n">yi_pr</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]))</span>

	<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

	<span class="c1">#Plot projection</span>
	
	<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>


	<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.05</span><span class="p">,</span> <span class="s2">&quot;A&#39;&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;distance [m]&#39;</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;masl&#39;</span><span class="p">)</span>

	<span class="n">contourax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xi_pr</span><span class="p">,</span><span class="n">yi_pr</span><span class="p">,</span><span class="n">zi_pr</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">variable_levels</span><span class="p">)</span>
	<span class="n">cntr</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xi_pr</span><span class="p">,</span><span class="n">yi_pr</span><span class="p">,</span><span class="n">zi_pr</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">variable_levels</span><span class="p">)</span>
	
	<span class="k">if</span> <span class="n">print_point</span><span class="p">:</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">proj_req</span><span class="p">,</span><span class="n">z_req_proj</span><span class="p">,</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
	
	<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contourax</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%10.0f</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

	<span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cntr</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Temperature [$^\circ$C]&#39;</span><span class="p">)</span> <span class="c1">#Fix it</span>
	<span class="c1">#Scatter 3D</span>

	<span class="n">ax3D</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

	<span class="n">colorbar_source</span><span class="o">=</span><span class="n">ax3D</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">x_req</span><span class="p">,</span><span class="n">y_req</span><span class="p">,</span><span class="n">z_req</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">requested_values</span><span class="p">)</span>

	<span class="n">ax3D</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;East [m]&#39;</span><span class="p">)</span>
	<span class="n">ax3D</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;North [m]&#39;</span><span class="p">)</span>
	<span class="n">ax3D</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;m.a.s.l.&#39;</span><span class="p">)</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">colorbar_source</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3D</span><span class="p">)</span>
	

	<span class="c1">#Projects well on slice</span>
	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;WELLS&#39;</span><span class="p">]):</span>
		<span class="n">data_position</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT east,north,elevation FROM wells WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
		<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT MeasuredDepth FROM survey WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39; ORDER BY MeasuredDepth;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

		<span class="n">x_real</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">y_real</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">z_real</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">well_proj</span><span class="o">=</span><span class="p">[]</span>

		<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">])):</span>
			<span class="n">xf</span><span class="p">,</span><span class="n">yf</span><span class="p">,</span><span class="n">zf</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">])</span>
			<span class="n">x_real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">xf</span><span class="p">))</span>
			<span class="n">y_real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">yf</span><span class="p">))</span>
			<span class="n">z_real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">zf</span><span class="p">))</span>
		
		<span class="k">for</span> <span class="n">ny</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_points</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">data_position</span><span class="p">[</span><span class="s1">&#39;north&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">y_points</span><span class="p">[</span><span class="n">ny</span><span class="p">]:</span>
				<span class="n">position</span><span class="o">=</span><span class="n">ny</span>
				<span class="n">bx</span><span class="o">=</span><span class="n">x_points</span><span class="p">[</span><span class="n">position</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x_points</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
				<span class="n">by</span><span class="o">=</span><span class="n">y_points</span><span class="p">[</span><span class="n">position</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y_points</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
				<span class="n">br</span><span class="o">=</span><span class="p">(</span><span class="n">bx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">by</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
		
	
		<span class="k">for</span> <span class="n">n_proj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_real</span><span class="p">)):</span>
			<span class="n">delta_x</span><span class="o">=</span><span class="n">x_real</span><span class="p">[</span><span class="n">n_proj</span><span class="p">]</span><span class="o">-</span><span class="n">x_points</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
			<span class="n">delta_y</span><span class="o">=</span><span class="n">y_real</span><span class="p">[</span><span class="n">n_proj</span><span class="p">]</span><span class="o">-</span><span class="n">y_points</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
			<span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">delta_y</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">delta_x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
			<span class="n">proj_w</span><span class="o">=</span><span class="p">((</span><span class="n">bx</span><span class="o">*</span><span class="n">delta_x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">by</span><span class="o">*</span><span class="n">delta_y</span><span class="p">))</span><span class="o">/</span><span class="n">br</span>
			<span class="nb">print</span><span class="p">(</span><span class="n">n_proj</span><span class="p">)</span>
			<span class="n">well_proj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proj_w</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">n_proj</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
				<span class="n">d</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">proj_w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
		<span class="k">if</span> <span class="n">d</span><span class="o">&lt;</span><span class="mi">200</span><span class="p">:</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">well_proj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z_real</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">well_proj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">200</span><span class="p">,</span> <span class="n">z_real</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span>
                            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3&quot;</span><span class="p">),</span>
            <span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">well_proj</span><span class="p">,</span><span class="n">z_real</span><span class="p">,</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
		
	<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


	<span class="c1">#Plot wells on 3D</span>

	<span class="k">if</span> <span class="n">show_wells_3D</span><span class="p">:</span>
		<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
		<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;WELLS&#39;</span><span class="p">]):</span>
			<span class="n">data_position</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT east,north,elevation FROM wells WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
			<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT MeasuredDepth FROM survey WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39; ORDER BY MeasuredDepth;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
			
			<span class="n">ax3D</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">data_position</span><span class="p">[</span><span class="s1">&#39;east&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_position</span><span class="p">[</span><span class="s1">&#39;north&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_position</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
				      <span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

			<span class="n">x_real</span><span class="o">=</span><span class="p">[]</span>
			<span class="n">y_real</span><span class="o">=</span><span class="p">[]</span>
			<span class="n">z_real</span><span class="o">=</span><span class="p">[]</span>

			<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">])):</span>
				<span class="n">xf</span><span class="p">,</span><span class="n">yf</span><span class="p">,</span><span class="n">zf</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">])</span>
				<span class="n">x_real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">xf</span><span class="p">))</span>
				<span class="n">y_real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">yf</span><span class="p">))</span>
				<span class="n">z_real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">zf</span><span class="p">))</span>
		
			<span class="n">ax3D</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">x_real</span><span class="p">,</span> <span class="n">y_real</span><span class="p">,</span> <span class="n">z_real</span><span class="p">,</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

		<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">savefig</span><span class="p">:</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/PT/images/vertical_section_</span><span class="si">%s</span><span class="s1">.png&#39;</span><span class="o">%</span><span class="n">variable_to_plot</span><span class="p">)</span> 

	<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_evol_well_data"><a class="viewcode-back" href="../modules/report.html#report.plot_evol_well_data">[docs]</a><span class="k">def</span> <span class="nf">plot_evol_well_data</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">layer</span><span class="p">,</span><span class="n">parameter</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates the input data for a line type plot data, from model and real , for one parameter along the time from a reference date define on input_dictionary </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	  </span>
<span class="sd">	well : str</span>
<span class="sd">	  Well name</span>
<span class="sd">	layer : str</span>
<span class="sd">	  Layer (level) at which the data will be extracted</span>
<span class="sd">	parameter : str</span>
<span class="sd">	  Variable to plot: &quot;P&quot;,&quot;T&quot;,&quot;SG&quot;,&quot;SW&quot;,&quot;X1&quot;,&quot;X2&quot;,&quot;PCAP,&quot;&quot;DG&quot; y &quot;DW&quot;</span>
<span class="sd">	input_dictionary: dict</span>
<span class="sd">	  Dictionary with the keywords &#39;ref_date&#39; (datetime type value) and &#39;db_path&#39; (database path)</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	dictionary</span>
<span class="sd">		calculated: output data from model</span>
<span class="sd">	pandas.dataframe</span>
<span class="sd">		data_real: Real data (if exist)</span>
<span class="sd">	float</span>
<span class="sd">		depth: masl</span>
<span class="sd">	string</span>
<span class="sd">		header: Parameter keyword</span>
<span class="sd">	string</span>
<span class="sd">		parameter_label: parameter label</span>
<span class="sd">	string</span>
<span class="sd">		parameter_unit: Parameter unit</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	it generates the input data for the function plot_evol_well_lines</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="n">parameter</span>  <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="s2">&quot;T&quot;</span><span class="p">,</span><span class="s2">&quot;SG&quot;</span><span class="p">,</span><span class="s2">&quot;SW&quot;</span><span class="p">,</span><span class="s2">&quot;X(WAT1)&quot;</span><span class="p">,</span><span class="s2">&quot;X(WAT2)&quot;</span><span class="p">,</span><span class="s2">&quot;PCAP&quot;</span><span class="p">,</span><span class="s2">&quot;DG&quot;</span><span class="p">,</span><span class="s2">&quot;DW&quot;</span><span class="p">]:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cant be printed, the parameter is  not register&quot;</span><span class="p">)</span>
	<span class="k">elif</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;P&quot;</span><span class="p">:</span>
		<span class="n">parameter_label</span><span class="o">=</span><span class="s2">&quot;Pressure&quot;</span>
		<span class="n">parameter_unit</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span>
		<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../input/drawdown/</span><span class="si">%s</span><span class="s2">_DD.dat&quot;</span><span class="o">%</span><span class="n">well</span>
		<span class="n">header</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span>
	<span class="k">elif</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;T&quot;</span><span class="p">:</span>
		<span class="n">parameter_label</span><span class="o">=</span><span class="s2">&quot;Temperature&quot;</span>
		<span class="n">parameter_unit</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
		<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../input/cooling/</span><span class="si">%s</span><span class="s2">_C.dat&quot;</span><span class="o">%</span><span class="n">well</span>
		<span class="n">header</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span>

	<span class="k">elif</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;SW&quot;</span><span class="p">:</span>
		<span class="n">parameter_label</span><span class="o">=</span><span class="s2">&quot;1-Quality&quot;</span>
		<span class="n">parameter_unit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
	<span class="k">elif</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;SG&quot;</span><span class="p">:</span>
		<span class="n">parameter_label</span><span class="o">=</span><span class="s2">&quot;Quality&quot;</span>
		<span class="n">parameter_unit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
	<span class="k">elif</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;DG&quot;</span><span class="p">:</span>
		<span class="n">parameter_label</span><span class="o">=</span><span class="s2">&quot;Density&quot;</span>
		<span class="n">parameter_unit</span><span class="o">=</span><span class="s2">&quot;kg/m3&quot;</span>
	<span class="k">elif</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;DW&quot;</span><span class="p">:</span>
		<span class="n">parameter_label</span><span class="o">=</span><span class="s2">&quot;Density&quot;</span>
		<span class="n">parameter_unit</span><span class="o">=</span><span class="s2">&quot;kg/m3&quot;</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">parameter_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
		<span class="n">parameter_unit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

	<span class="n">color_real</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">color_calc</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
	<span class="c1">#Read file, calculated</span>
	<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../output/PT/evol/</span><span class="si">%s</span><span class="s2">_PT_</span><span class="si">%s</span><span class="s2">_evol.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
	<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

	<span class="n">times</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

	<span class="n">values</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>

	<span class="n">dates</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">values_to_plot</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
		<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>
				<span class="k">if</span> <span class="n">parameter</span><span class="o">!=</span><span class="s2">&quot;P&quot;</span><span class="p">:</span>
					<span class="n">values_to_plot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">values_to_plot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="mf">1E5</span><span class="p">)</span>
					
			<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">])</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">depth</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT middle FROM layers WHERE correlative=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">layer</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>


	<span class="c1">#Read file, real</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">check_res</span><span class="o">=</span><span class="kc">False</span>
		<span class="k">if</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;P&quot;</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">well</span><span class="o">!=</span><span class="s1">&#39;AH-25&#39;</span> <span class="ow">or</span> <span class="n">layer</span><span class="o">!=</span><span class="s1">&#39;E&#39;</span><span class="p">:</span>
				<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../input/drawdown/</span><span class="si">%s</span><span class="s2">_DD.dat&quot;</span><span class="o">%</span><span class="n">well</span>
			<span class="k">elif</span> <span class="n">well</span><span class="o">==</span><span class="s1">&#39;AH-25&#39;</span> <span class="ow">and</span> <span class="n">layer</span><span class="o">==</span><span class="s1">&#39;E&#39;</span><span class="p">:</span>
				<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../input/drawdown/p_res.csv&quot;</span>
				<span class="n">check_res</span><span class="o">=</span><span class="kc">True</span>
		<span class="k">elif</span> <span class="n">parameter</span><span class="o">==</span><span class="s2">&quot;T&quot;</span><span class="p">:</span>	
			<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../input/cooling/</span><span class="si">%s</span><span class="s2">_C.dat&quot;</span><span class="o">%</span><span class="n">well</span>

		<span class="n">data_real</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
		
	<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
		<span class="n">data_real</span><span class="o">=</span><span class="kc">None</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No real data exist&quot;</span><span class="p">)</span>
		<span class="k">pass</span>


	<span class="n">calculated</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dates&#39;</span><span class="p">:</span><span class="n">dates</span><span class="p">,</span><span class="s1">&#39;values&#39;</span><span class="p">:</span><span class="n">values_to_plot</span><span class="p">}</span>

	<span class="k">return</span> <span class="n">calculated</span><span class="p">,</span><span class="n">data_real</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">header</span><span class="p">,</span><span class="n">parameter_label</span><span class="p">,</span><span class="n">parameter_unit</span></div>

<div class="viewcode-block" id="plot_evol_well_lines"><a class="viewcode-back" href="../modules/report.html#report.plot_evol_well_lines">[docs]</a><span class="k">def</span> <span class="nf">plot_evol_well_lines</span><span class="p">(</span><span class="n">calculated</span><span class="p">,</span><span class="n">real_data</span><span class="p">,</span><span class="n">parameter</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">header</span><span class="p">,</span><span class="n">well</span><span class="p">,</span><span class="n">layer</span><span class="p">,</span><span class="n">parameter_unit</span><span class="p">,</span><span class="n">parameter_label</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">years</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">color_def</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates the input data for a line type plot data, from model and real , for one parameter along the time from a reference date define on input_dictionary </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	 </span>
<span class="sd">	calculated: dict</span>
<span class="sd">		Output data from model</span>
<span class="sd">	pandas.dataframe</span>
<span class="sd">		data_real: Real data (if exist)</span>
<span class="sd">	float</span>
<span class="sd">		depth: masl</span>
<span class="sd">	header: str</span>
<span class="sd">		Parameter keyword</span>
<span class="sd">	parameter_label: str</span>
<span class="sd">		parameter label</span>
<span class="sd">	parameter_unit: str</span>
<span class="sd">		parameter_unit: Parameter unit</span>
<span class="sd">	well : str</span>
<span class="sd">	  Well name</span>
<span class="sd">	layer : str</span>
<span class="sd">	  Layer (level) at which the data will be extracted</span>
<span class="sd">	parameter : str</span>
<span class="sd">	  Variable to plot: &quot;P&quot;,&quot;T&quot;,&quot;SG&quot;,&quot;SW&quot;,&quot;X1&quot;,&quot;X2&quot;,&quot;PCAP,&quot;&quot;DG&quot; y &quot;DW&quot;</span>
<span class="sd">	input_dictionary: dict</span>
<span class="sd">	  Dictionary with the keywords &#39;ref_date&#39; (datetime type value) and &#39;db_path&#39; (database path)</span>
<span class="sd">	years: float</span>
<span class="sd">	  Number of years after the ref_date to be plotted on the chart</span>
<span class="sd">	color_def: bool</span>
<span class="sd">	  If true default colors are use from the formats module</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	matplotlib_axis</span>
<span class="sd">		ax: contains real and simulated for the selected paramter along the time</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">		It is use in combination with the function plot_evol_well_data</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">dates_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">datesX</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">datesX</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
	
	<span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calculated</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">],</span><span class="n">calculated</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Calculated </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">label</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">color_def</span><span class="p">:</span>
		<span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">line</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">real_data</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
		<span class="n">dates_real</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">dates_func</span><span class="p">,</span><span class="n">real_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">real_data</span><span class="p">[</span><span class="s1">&#39;TVD&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">depth</span><span class="p">][</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_real</span><span class="p">,</span><span class="n">real_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">real_data</span><span class="p">[</span><span class="s1">&#39;TVD&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">depth</span><span class="p">][</span><span class="n">header</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">well</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Well: </span><span class="si">%s</span><span class="s2"> at </span><span class="si">%s</span><span class="s2"> masl (layer </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [</span><span class="si">%s</span><span class="s1">]&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">parameter_label</span><span class="p">,</span><span class="n">parameter_unit</span><span class="p">),</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

	<span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">],</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">years</span><span class="o">*</span><span class="mf">365.25</span><span class="p">)]</span>
	
	<span class="n">ax</span><span class="o">.</span><span class="n">format_xdata</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y%-m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

	<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
	<span class="n">years_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
	
	<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">years_fmt</span><span class="p">)</span>

	<span class="c1">#Grid style</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="cross_section_real_data"><a class="viewcode-back" href="../modules/report.html#report.cross_section_real_data">[docs]</a><span class="k">def</span> <span class="nf">cross_section_real_data</span><span class="p">(</span><span class="n">wells</span><span class="p">,</span><span class="n">ngrid</span><span class="p">,</span><span class="n">masl</span><span class="p">,</span><span class="n">PT</span><span class="p">,</span><span class="n">save_img</span><span class="p">,</span><span class="n">model_version</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It Generates a vertical cross section for a specified parameter on a defined path.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	   </span>
<span class="sd">	ngrid : int</span>
<span class="sd">	  Number of element on the horizontal/vertical direction</span>
<span class="sd">	wells : dict</span>
<span class="sd">	  Wells names</span>
<span class="sd">	masl : float</span>
<span class="sd">	  Desire depth for cross section</span>
<span class="sd">	PT   : string</span>
<span class="sd">	  &#39;T&#39; or &#39;P&#39;</span>
<span class="sd">	save_img : bool</span>
<span class="sd">	  Selects weather the plot is save as image or not</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	image</span>
<span class="sd">		vertical_section_{varible_to_plot}.png: on &#39;../output/PT/images/</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	The data comes from the text file. The function is meant to be use at the early stages of the model to check natural state</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">if</span> <span class="n">PT</span><span class="o">==</span><span class="s1">&#39;T&#39;</span><span class="p">:</span>
		<span class="n">var_label</span><span class="o">=</span><span class="s1">&#39;Temperature [$^\circ$C]&#39;</span>
		<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="mi">25</span><span class="p">)]</span>
	<span class="k">elif</span> <span class="n">PT</span><span class="o">==</span><span class="s1">&#39;P&#39;</span><span class="p">:</span>
		<span class="n">var_label</span><span class="o">=</span><span class="s1">&#39;Pressure [bar]&#39;</span>
		<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">15</span><span class="p">)]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Not listed variable&quot;</span><span class="p">)</span>

	<span class="n">ngridx</span><span class="o">=</span><span class="n">ngrid</span>
	<span class="n">ngridy</span><span class="o">=</span><span class="n">ngrid</span>

	<span class="c1">#Setting up the canvas</span>
	<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> m.a.s.l.&quot;</span><span class="o">%</span><span class="n">masl</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;model_version:&#39;</span><span class="o">+</span><span class="n">model_version</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>


	<span class="c1">#Extracting the data</span>
	<span class="n">src</span><span class="o">=</span><span class="s1">&#39;../input/PT&#39;</span>
	<span class="n">src_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
	<span class="n">var</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">x</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">y</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">platorm</span><span class="o">=</span><span class="p">{}</span>
	<span class="n">toremove</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;ST&#39;</span><span class="p">]</span>
	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
		<span class="n">file_name</span><span class="o">=</span><span class="n">well</span><span class="o">+</span><span class="s1">&#39;_MDPT.dat&#39;</span>
		<span class="n">full_file_name</span><span class="o">=</span><span class="n">src</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">file_name</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">full_file_name</span><span class="p">):</span>
			<span class="n">well</span><span class="o">=</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">full_file_name</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
			<span class="n">funcT</span><span class="o">=</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">PT</span><span class="p">])</span>

			<span class="k">try</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">funcT</span><span class="p">(</span><span class="n">geometry</span><span class="o">.</span><span class="n">TVD_to_MD</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">masl</span><span class="p">))):</span>
					<span class="n">var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">funcT</span><span class="p">(</span><span class="n">geometry</span><span class="o">.</span><span class="n">TVD_to_MD</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">masl</span><span class="p">)))</span>
					<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">geometry</span><span class="o">.</span><span class="n">TVD_to_MD</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">masl</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
					<span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">geometry</span><span class="o">.</span><span class="n">TVD_to_MD</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">masl</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>

					<span class="c1">#Getting the plataform&#39;s name</span>
					<span class="n">well_i</span><span class="o">=</span><span class="n">well</span>
					<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">toremove</span><span class="p">:</span>
						<span class="n">well_i</span><span class="o">=</span><span class="n">well_i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
					
					<span class="c1">#Plotting plataform name</span>
					<span class="k">if</span> <span class="n">well_i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">platorm</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
						<span class="n">platorm</span><span class="p">[</span><span class="n">well_i</span><span class="p">]</span><span class="o">=</span><span class="n">well_i</span>
						<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">well_i</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
				<span class="k">pass</span>


	<span class="c1">#Resampling</span>
	<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">ngridx</span><span class="p">)</span>
	<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">ngridy</span><span class="p">)</span>
	
	<span class="n">triangles</span><span class="o">=</span><span class="n">mtri</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
	<span class="n">interpolator</span><span class="o">=</span><span class="n">mtri</span><span class="o">.</span><span class="n">LinearTriInterpolator</span><span class="p">(</span><span class="n">triangles</span><span class="p">,</span><span class="n">var</span><span class="p">)</span>
	<span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span>
	<span class="n">zi</span><span class="o">=</span><span class="n">interpolator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

	<span class="c1">#Plotting the colormarp</span>
	<span class="n">c</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">zi</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

	<span class="c1">#Plotting triangles</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">triplot</span><span class="p">(</span><span class="n">triangles</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

	<span class="c1">#Setting up the colorbar</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">var_label</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

	<span class="c1">#Setting up the axis</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;East [m]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;North [m]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

	<span class="n">step</span><span class="o">=</span><span class="mi">500</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">step</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">step</span><span class="p">])</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">step</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">step</span><span class="p">])</span>

	<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

	<span class="k">if</span> <span class="n">save_img</span><span class="p">:</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../input/PT/selection_PT/</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_masl.png&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">PT</span><span class="p">,</span><span class="n">masl</span><span class="p">))</span> </div>



<div class="viewcode-block" id="plot_compare_PT_curr_prev"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_PT_curr_prev">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_PT_curr_prev</span><span class="p">(</span><span class="n">db_path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">ELEME</span><span class="p">,</span><span class="n">layers</span><span class="p">,</span><span class="n">inpath</span><span class="o">=</span><span class="s2">&quot;../output/PT/txt&quot;</span><span class="p">,</span><span class="n">previnpath</span><span class="o">=</span><span class="s2">&quot;../output/PT/txt/prev&quot;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

	<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
	<span class="n">c</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

	<span class="n">fontsizex</span><span class="o">=</span><span class="mi">10</span>

	<span class="n">fontsize_layer</span><span class="o">=</span><span class="mi">8</span>

	<span class="c1">#Define plot</span>

	<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>

	<span class="n">axP</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>

	<span class="n">col_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rocktype&#39;</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
	<span class="n">rocks_colors</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../mesh/to_steinar/rocks&quot;</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">col_name</span><span class="p">)</span>
	<span class="n">rocks_colors</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;rocktype&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="c1">#Real data</span>
	<span class="n">data_PT_real</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT well, MeasuredDepth, Pressure, Temperature FROM PT WHERE well=&#39;</span><span class="si">%s</span><span class="s2">&#39; ORDER BY MeasuredDepth DESC;&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>

	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_PT_real</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>

		<span class="n">x_T</span><span class="p">,</span><span class="n">y_T</span><span class="p">,</span><span class="n">z_T</span><span class="p">,</span><span class="n">var_T</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD_one_var_array</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

		<span class="n">ln1T</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_T</span><span class="p">,</span><span class="n">z_T</span><span class="p">,</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated &#39;</span><span class="p">)</span>

		<span class="n">x_P</span><span class="p">,</span><span class="n">y_P</span><span class="p">,</span><span class="n">z_P</span><span class="p">,</span><span class="n">var_P</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">MD_to_TVD_one_var_array</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;Pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">data_PT_real</span><span class="p">[</span><span class="s1">&#39;MeasuredDepth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

		<span class="n">ln1P</span><span class="o">=</span><span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_P</span><span class="p">,</span><span class="n">z_P</span><span class="p">,</span><span class="s1">&#39;-b&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated &#39;</span><span class="p">)</span>


	<span class="n">COF_PT_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/COF_PT.json&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">COF_PT_file</span><span class="p">):</span>
		<span class="n">COF_PT</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">COF_PT_file</span><span class="p">)</span>

		<span class="n">axP_COF</span> <span class="o">=</span> <span class="n">axP</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
		<span class="n">axT_COF</span> <span class="o">=</span> <span class="n">axT</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

		<span class="n">COF_locations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

		<span class="c1"># Move twinned axis ticks and label from top to bottom</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

		<span class="c1"># Offset the twin axis below the host</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">))</span>

		<span class="c1"># Turn on the frame for the twin axis, but then hide all </span>
		<span class="c1"># but the bottom spine</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">axT_COF</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
		    <span class="n">sp</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

		<span class="n">axT_COF</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">COF_locations</span><span class="p">)</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;COF&quot;</span><span class="p">)</span>
		<span class="n">axT_COF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>


		<span class="c1"># Move twinned axis ticks and label from top to bottom</span>
		<span class="n">axP_COF</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
		<span class="n">axP_COF</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

		<span class="c1"># Offset the twin axis below the host</span>
		<span class="n">axP_COF</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">))</span>

		<span class="c1"># Turn on the frame for the twin axis, but then hide all </span>
		<span class="c1"># but the bottom spine</span>
		<span class="n">axP_COF</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">axP_COF</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">axP_COF</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
		    <span class="n">sp</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
		<span class="n">axP_COF</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

		<span class="n">axP_COF</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">COF_locations</span><span class="p">)</span>
		<span class="n">axP_COF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;COF&quot;</span><span class="p">)</span>

		<span class="n">axP_COF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No file on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">COF_PT_file</span><span class="p">)</span>

	<span class="n">COF_PT_prev_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/prev/COF_PT.json&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">COF_PT_prev_file</span><span class="p">):</span>
		<span class="n">COF_PT_prev</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">COF_PT_prev_file</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No file on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">COF_PT_prev_file</span><span class="p">)</span>

	<span class="n">layers_block</span><span class="o">=</span><span class="p">{</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]:</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;middle&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))}</span>

	<span class="c1">#Model</span>

	<span class="n">in_file</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">inpath</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

	<span class="n">prev_in_file</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">previnpath</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">in_file</span><span class="p">):</span>

		<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_file</span><span class="p">)</span>

		<span class="k">if</span> <span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">T_colum</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
		<span class="k">elif</span> <span class="s1">&#39;TEMP&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">T_colum</span> <span class="o">=</span> <span class="s1">&#39;TEMP&#39;</span>

		<span class="k">if</span> <span class="s1">&#39;P&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">P_colum</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>
		<span class="k">elif</span> <span class="s1">&#39;PRES_VAP&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">P_colum</span> <span class="o">=</span> <span class="s1">&#39;PRES_VAP&#39;</span>


		<span class="n">blk_num</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

		<span class="n">TVD_elem</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">))]</span>
		<span class="n">TVD_elem_top</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">))]</span>
		<span class="n">TVD_elem_bottom</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">))]</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">)):</span>
			<span class="n">TVD_elem</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT middle FROM layers WHERE correlative=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">conn</span><span class="p">)[</span><span class="s1">&#39;middle&#39;</span><span class="p">])</span>
			<span class="n">TVD_elem_top</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT top FROM layers WHERE correlative=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">conn</span><span class="p">)[</span><span class="s1">&#39;top&#39;</span><span class="p">])</span>
			<span class="n">TVD_elem_bottom</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT bottom FROM layers WHERE correlative=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">conn</span><span class="p">)[</span><span class="s1">&#39;bottom&#39;</span><span class="p">])</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">COF_PT_file</span><span class="p">):</span>
			<span class="c1">#COF plot</span>
			<span class="n">T_COF</span><span class="o">=</span><span class="n">COF_PT</span><span class="p">[</span><span class="n">COF_PT</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;T-</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">)]</span>
			<span class="n">P_COF</span><span class="o">=</span><span class="n">COF_PT</span><span class="p">[</span><span class="n">COF_PT</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;P-</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">)]</span>

			<span class="n">T_COF</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
			<span class="n">T_COF</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
			<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">T_COF</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
				<span class="n">T_COF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">T_COF</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
				<span class="n">T_COF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">T_COF</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers_block</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

			<span class="n">P_COF</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
			<span class="n">P_COF</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
			<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">P_COF</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
				<span class="n">P_COF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">P_COF</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
				<span class="n">P_COF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">P_COF</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers_block</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

			<span class="n">lnCOFT</span> <span class="o">=</span> <span class="n">axT_COF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_COF</span><span class="p">[</span><span class="s1">&#39;COF&#39;</span><span class="p">],</span><span class="n">T_COF</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">],</span><span class="s1">&#39;--+k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Current calculation&#39;</span><span class="p">)</span>

			<span class="n">lnCOFP</span> <span class="o">=</span> <span class="n">axP_COF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P_COF</span><span class="p">[</span><span class="s1">&#39;COF&#39;</span><span class="p">],</span><span class="n">P_COF</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">],</span><span class="s1">&#39;--+&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Current calculation&#39;</span><span class="p">)</span>

		<span class="c1">#Rock types</span>
		<span class="n">layers_block_limits</span> <span class="o">=</span> <span class="p">{</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]:[</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))}</span>

		<span class="c1">#like {&#39;A&#39;:[500,400],&#39;B&#39;: [400,300]}</span>

		<span class="n">xs</span><span class="o">=</span><span class="p">[</span><span class="mi">290</span><span class="p">,</span><span class="mi">310</span><span class="p">]</span>
		
		<span class="k">for</span> <span class="n">iy</span><span class="p">,</span><span class="n">block</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blk_num</span><span class="p">):</span>
			<span class="n">colori</span><span class="o">=</span><span class="n">rocks_colors</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ELEME</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;MA1&#39;</span><span class="p">]]</span>
			<span class="n">axT</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">layers_block_limits</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">],</span><span class="n">layers_block_limits</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[(</span><span class="n">colori</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span><span class="n">colori</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span><span class="n">colori</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">255.0</span><span class="p">)])</span>


		<span class="n">ln2T</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">T_colum</span><span class="p">],</span><span class="n">TVD_elem</span><span class="p">,</span><span class="s1">&#39;+r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Current calculation&#39;</span><span class="p">)</span>

		<span class="k">def</span> <span class="nf">tsat</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">val</span> <span class="o">=</span> <span class="n">IAPWS97</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="mf">1E6</span><span class="p">),</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="mf">273.15</span>
			<span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
				<span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
			<span class="k">return</span> <span class="n">val</span>

		<span class="n">data</span><span class="p">[</span><span class="s1">&#39;sat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">tsat</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">P_colum</span><span class="p">]),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

		<span class="n">ln2Tsat</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sat&#39;</span><span class="p">],</span><span class="n">TVD_elem</span><span class="p">,</span><span class="s1">&#39;sr&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;T SAT&#39;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

		<span class="n">ln2P</span><span class="o">=</span><span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">P_colum</span><span class="p">]</span><span class="o">/</span><span class="mf">1E5</span><span class="p">,</span><span class="n">TVD_elem</span><span class="p">,</span><span class="s1">&#39;+b&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Current calculation&#39;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

		<span class="k">if</span> <span class="s1">&#39;PSAT&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">ln2PSAT</span><span class="o">=</span><span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;PSAT&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1E5</span><span class="p">,</span><span class="n">TVD_elem</span><span class="p">,</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;PSAT&#39;</span><span class="p">)</span>
			<span class="n">lgd_PSAT</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">lgd_PSAT</span> <span class="o">=</span> <span class="kc">False</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">prev_in_file</span><span class="p">):</span>

		<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">prev_in_file</span><span class="p">)</span>

		<span class="k">if</span> <span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">T_colum</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
		<span class="k">elif</span> <span class="s1">&#39;TEMP&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">T_colum</span> <span class="o">=</span> <span class="s1">&#39;TEMP&#39;</span>

		<span class="k">if</span> <span class="s1">&#39;P&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">P_colum</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>
		<span class="k">elif</span> <span class="s1">&#39;PRES_VAP&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
			<span class="n">P_colum</span> <span class="o">=</span> <span class="s1">&#39;PRES_VAP&#39;</span>


		<span class="n">blk_num</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


		<span class="n">TVD_elem</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">))]</span>
		<span class="n">TVD_elem_top</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">))]</span>

		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">)):</span>
			<span class="n">TVD_elem</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT middle FROM layers WHERE correlative=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">conn</span><span class="p">)[</span><span class="s1">&#39;middle&#39;</span><span class="p">])</span>
			<span class="n">TVD_elem_top</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT top FROM layers WHERE correlative=&#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span><span class="o">%</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">conn</span><span class="p">)[</span><span class="s1">&#39;top&#39;</span><span class="p">])</span>


		<span class="n">ln3T</span><span class="o">=</span><span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">T_colum</span><span class="p">],</span><span class="n">TVD_elem</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Previously calculated&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">)</span>

		<span class="n">ln3P</span><span class="o">=</span><span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">P_colum</span><span class="p">]</span><span class="o">/</span><span class="mf">1E5</span><span class="p">,</span><span class="n">TVD_elem</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Previously calculated&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;indigo&quot;</span><span class="p">)</span>


		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">COF_PT_prev_file</span><span class="p">):</span>
			<span class="c1">#COF plot</span>
			<span class="n">T_COF_prev</span><span class="o">=</span><span class="n">COF_PT_prev</span><span class="p">[</span><span class="n">COF_PT_prev</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;T-</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">)]</span>
			<span class="n">P_COF_prev</span><span class="o">=</span><span class="n">COF_PT_prev</span><span class="p">[</span><span class="n">COF_PT_prev</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;P-</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">)]</span>

			<span class="n">T_COF_prev</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="n">T_COF_prev</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">T_COF_prev</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
				<span class="n">T_COF_prev</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">T_COF_prev</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
				<span class="n">T_COF_prev</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">T_COF_prev</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers_block</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

			<span class="n">P_COF_prev</span><span class="p">[</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
			<span class="n">P_COF_prev</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
			<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">P_COF_prev</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
				<span class="n">P_COF_prev</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">P_COF_prev</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;ELEME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
				<span class="n">P_COF_prev</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">P_COF_prev</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">],</span><span class="s1">&#39;masl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers_block</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>


			<span class="n">lnCOFT_prev</span><span class="o">=</span><span class="n">axT_COF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_COF_prev</span><span class="p">[</span><span class="s1">&#39;COF&#39;</span><span class="p">],</span><span class="n">T_COF_prev</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">],</span><span class="s1">&#39;-+&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Previously calculated&#39;</span><span class="p">)</span>

			<span class="n">lnCOFP_prev</span><span class="o">=</span><span class="n">axP_COF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P_COF_prev</span><span class="p">[</span><span class="s1">&#39;COF&#39;</span><span class="p">],</span><span class="n">P_COF_prev</span><span class="p">[</span><span class="s1">&#39;masl&#39;</span><span class="p">],</span><span class="s1">&#39;-+&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;teal&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Previously calculated&#39;</span><span class="p">)</span>

		<span class="n">lnsT</span> <span class="o">=</span> <span class="n">ln2T</span><span class="o">+</span><span class="n">ln3T</span> <span class="o">+</span> <span class="n">ln2Tsat</span>

		<span class="n">lnsP</span> <span class="o">=</span> <span class="n">ln2P</span><span class="o">+</span><span class="n">ln3P</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">COF_PT_file</span><span class="p">):</span>
			<span class="n">lnsT</span> <span class="o">+=</span> <span class="n">lnCOFT</span>
			<span class="n">lnsP</span> <span class="o">+=</span> <span class="n">lnCOFP</span>

		<span class="k">if</span> <span class="n">lgd_PSAT</span><span class="p">:</span>
			<span class="n">lnsP</span><span class="o">+=</span><span class="n">ln2PSAT</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">COF_PT_prev_file</span><span class="p">):</span>
			<span class="n">lnsP</span><span class="o">+=</span><span class="n">lnCOFP_prev</span>
			<span class="n">lnsT</span><span class="o">+=</span><span class="n">lnCOFT_prev</span>

		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_PT_real</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="n">lnsP</span><span class="o">+=</span><span class="n">ln1T</span>
			<span class="n">lnsT</span><span class="o">+=</span><span class="n">ln1P</span>

		<span class="n">labsT</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lnsT</span><span class="p">]</span>

		<span class="n">axT</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lnsT</span><span class="p">,</span> <span class="n">labsT</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">)</span>

		<span class="n">labsP</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lnsP</span><span class="p">]</span>
	
		<span class="n">axP</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lnsP</span><span class="p">,</span> <span class="n">labsP</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">)</span>

	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_PT_real</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">axT</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="nb">sorted</span><span class="p">(</span><span class="n">TVD_elem_bottom</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="nb">sorted</span><span class="p">(</span><span class="n">TVD_elem_top</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
			<span class="n">axP</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="nb">sorted</span><span class="p">(</span><span class="n">TVD_elem_bottom</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="nb">sorted</span><span class="p">(</span><span class="n">TVD_elem_top</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
		<span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
			<span class="n">axT</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span><span class="mi">550</span><span class="p">])</span>
			<span class="n">axP</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span><span class="mi">550</span><span class="p">])</span>
			<span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span><span class="mi">305</span><span class="p">])</span>
	<span class="n">axP</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">305</span><span class="p">])</span>

	<span class="n">ax2P</span> <span class="o">=</span> <span class="n">axP</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

	<span class="n">layer_corr</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blk_num</span><span class="p">))]</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem_top</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">layer_corr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_layer</span><span class="p">)</span>

	<span class="n">ax2P</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axP</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

	<span class="n">ax2T</span> <span class="o">=</span> <span class="n">axT</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem_top</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">TVD_elem</span><span class="p">,</span><span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
	
	<span class="n">ax2T</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">layer_corr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_layer</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

	<span class="n">ax2T</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axT</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [C]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;m.a.s.l.&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizex</span><span class="p">)</span>

	<span class="n">axT</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pressure [bar]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">)</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>

	<span class="n">axP</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

	<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsizex</span><span class="p">)</span>

	<span class="k">if</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">prev_in_file</span><span class="p">)</span> <span class="ow">and</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">in_file</span><span class="p">):</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../calib/PT/images/PT_</span><span class="si">%s</span><span class="s1">.png&#39;</span><span class="o">%</span><span class="n">name</span><span class="p">)</span> 

	<span class="k">if</span> <span class="n">show</span><span class="p">:</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

	<span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="compare_runs_PT"><a class="viewcode-back" href="../modules/report.html#report.compare_runs_PT">[docs]</a><span class="k">def</span> <span class="nf">compare_runs_PT</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">compare_wells</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;It generates a pdf for calibration pourposes, comparing current and previous data set</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	   </span>
<span class="sd">	input_dictionary : dict</span>
<span class="sd">		Contains well names, model version, db path and layers information.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	pdf</span>
<span class="sd">		run_{date_time}.pdf: on &#39;../calib/PT/run</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Some other files such as ELEME.json, OBJ.json and COF_PT.json must be ready.</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">db_path</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;db_path&#39;</span><span class="p">]</span>
	<span class="n">model_version</span><span class="o">=</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;model_version&#39;</span><span class="p">]</span>
	<span class="n">wells</span><span class="o">=</span><span class="p">[]</span>

	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;MAKE_UP_WELLS&#39;</span><span class="p">,</span><span class="s1">&#39;NOT_PRODUCING_WELL&#39;</span><span class="p">]:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">input_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
				<span class="n">wells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="n">pdf_pages</span><span class="o">=</span><span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;../calib/PT/run_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span><span class="p">)</span>

	<span class="n">layers</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertical_layers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">)</span>

	<span class="n">eleme_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">eleme_json_file</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">eleme_json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">ELEME</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;The file </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">eleme_json_file</span><span class="p">))</span>

	<span class="k">if</span> <span class="n">compare_wells</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>
			<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_compare_PT_curr_prev</span><span class="p">(</span><span class="n">db_path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">ELEME</span><span class="p">,</span><span class="n">layers</span><span class="p">,</span><span class="s2">&quot;../output/PT/txt&quot;</span><span class="p">,</span><span class="s2">&quot;../output/PT/txt/prev&quot;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
			<span class="n">pdf_pages</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>


	<span class="c1">#Scatter plot</span>

	<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
	<span class="n">axT</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
	<span class="n">axP</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>

	<span class="n">layers_block</span> <span class="o">=</span> <span class="p">{</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]:</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;middle&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))}</span>

	<span class="n">OBJ_PT_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/it2_PT.json&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">OBJ_PT_file</span><span class="p">):</span>
		<span class="n">OBJ_PT</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">OBJ_PT_file</span><span class="p">)</span>

		<span class="n">data_T</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">data_P</span><span class="o">=</span><span class="p">[]</span>

		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>
			<span class="n">in_file</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">_PT.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="s2">&quot;../output/PT/txt&quot;</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
			<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_file</span><span class="p">)</span>

			<span class="k">if</span> <span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
				<span class="n">T_colum</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
			<span class="k">elif</span> <span class="s1">&#39;TEMP&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
				<span class="n">T_colum</span> <span class="o">=</span> <span class="s1">&#39;TEMP&#39;</span>

			<span class="k">if</span> <span class="s1">&#39;P&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
				<span class="n">P_colum</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>
			<span class="k">elif</span> <span class="s1">&#39;PRES_VAP&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
				<span class="n">P_colum</span> <span class="o">=</span> <span class="s1">&#39;PRES_VAP&#39;</span>

			<span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
				<span class="n">T_COF</span> <span class="o">=</span> <span class="n">OBJ_PT</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">OBJ_PT</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-T-</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">],</span><span class="n">name</span><span class="p">),</span><span class="s1">&#39;MEASURED&#39;</span><span class="p">]</span>
				<span class="n">P_COF</span> <span class="o">=</span> <span class="n">OBJ_PT</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">OBJ_PT</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-P-</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">],</span><span class="n">name</span><span class="p">),</span><span class="s1">&#39;MEASURED&#39;</span><span class="p">]</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">P_COF</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">T_COF</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">T_colum</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">T_COF</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
					<span class="n">data_T</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="n">T_colum</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">T_COF</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
					<span class="n">data_P</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="n">P_colum</span><span class="p">]</span><span class="o">/</span><span class="mf">1E5</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">P_COF</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">1E5</span><span class="p">])</span>

		<span class="n">data_T</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_T</span><span class="p">)</span>
		<span class="n">resT</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
		
		<span class="n">data_P</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_P</span><span class="p">)</span>
		<span class="n">resP</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

		<span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;or&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
		<span class="n">T_s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="nb">max</span><span class="p">(</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="mi">10</span><span class="p">)</span>
		<span class="n">axT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_s</span><span class="p">,</span><span class="n">resT</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">T_s</span><span class="o">+</span><span class="n">resT</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span><span class="s1">&#39;--k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">*P+</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">resT</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span><span class="n">resT</span><span class="o">.</span><span class="n">intercept</span><span class="p">))</span>
		<span class="n">axT</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span><span class="mi">320</span><span class="p">])</span>
		<span class="n">axT</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span><span class="mi">320</span><span class="p">])</span>
		<span class="n">axT</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Calculated Temperature [C]&#39;</span><span class="p">)</span>
		<span class="n">axT</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Measured Temperature [C]&#39;</span><span class="p">)</span>
		<span class="n">axT</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

		<span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
		<span class="n">P_s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="nb">max</span><span class="p">(</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="mi">10</span><span class="p">)</span>
		<span class="n">axP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P_s</span><span class="p">,</span><span class="n">resP</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">P_s</span><span class="o">+</span><span class="n">resP</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span><span class="s1">&#39;--k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">*P+</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">resP</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span><span class="n">resP</span><span class="o">.</span><span class="n">intercept</span><span class="p">))</span>
		<span class="n">axP</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">250</span><span class="p">])</span>
		<span class="n">axP</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">250</span><span class="p">])</span>
		<span class="n">axP</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Calculated Pressure [bar]&#39;</span><span class="p">)</span>
		<span class="n">axP</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Measured Pressure [bar]&#39;</span><span class="p">)</span>
		<span class="n">axP</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

		<span class="n">pdf_pages</span><span class="o">.</span><span class="n">savefig</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

		<span class="c1">#Histogram</span>

		<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
		<span class="n">ax2</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
		<span class="c1"># An &quot;interface&quot; to matplotlib.axes.Axes.hist() method</span>
		<span class="n">T_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">data_T</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> 
		<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">T_diff</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">)</span>
		<span class="n">muT</span><span class="p">,</span> <span class="n">stdT</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">T_diff</span><span class="p">)</span>
		<span class="n">T_diff_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">T_diff</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">T_diff</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">muT</span><span class="p">,</span> <span class="n">stdT</span><span class="p">),</span><span class="s1">&#39;--r&#39;</span><span class="p">)</span>

		<span class="n">P_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">data_P</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> 
		<span class="n">n2</span><span class="p">,</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">patches2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">P_diff</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;steelblue&quot;</span><span class="p">)</span>
		<span class="n">P_diff_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">P_diff</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">P_diff</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
		<span class="n">muP</span><span class="p">,</span> <span class="n">stdP</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">P_diff</span><span class="p">)</span>
		<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins2</span><span class="p">,</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins2</span><span class="p">,</span> <span class="n">muP</span><span class="p">,</span> <span class="n">stdP</span><span class="p">),</span><span class="s1">&#39;--r&#39;</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Diff [C]&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu = &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> ,&#39;</span><span class="o">%</span><span class="n">muT</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\sigma$ = &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">stdT</span><span class="p">)</span>

		<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Diff [bar]&#39;</span><span class="p">)</span>
		<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
		<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu = &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> ,&#39;</span><span class="o">%</span><span class="n">muP</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\sigma$ = &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">stdP</span><span class="p">)</span>
		<span class="n">pdf_pages</span><span class="o">.</span><span class="n">savefig</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No file on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">OBJ_PT_file</span><span class="p">)</span>

	<span class="c1">#Objective function</span>

	<span class="n">OBJ_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/OBJ.json&quot;</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">):</span>
		<span class="n">OBJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">)</span>

		<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

		<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">OBJ</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span><span class="n">OBJ</span><span class="p">[</span><span class="s1">&#39;OBJ&#39;</span><span class="p">],</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">)</span>

		<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">OBJ</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
			<span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
			<span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Val&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

		<span class="n">pdf_pages</span><span class="o">.</span><span class="n">savefig</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No file on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">OBJ_file</span><span class="p">)</span>


	<span class="k">if</span> <span class="n">comment</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
		<span class="n">firstPage</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
		<span class="n">firstPage</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
		<span class="n">firstPage</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">comment</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;model version: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">model_version</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">firstPage</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
		<span class="n">pdf_pages</span><span class="o">.</span><span class="n">savefig</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="n">d</span> <span class="o">=</span> <span class="n">pdf_pages</span><span class="o">.</span><span class="n">infodict</span><span class="p">()</span>
	<span class="n">d</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Calibration Model Plots&#39;</span>
	<span class="n">d</span><span class="p">[</span><span class="s1">&#39;Author&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;EJ&#39;</span>
	<span class="n">d</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;BGF&#39;</span>
	<span class="n">d</span><span class="p">[</span><span class="s1">&#39;Keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Model, TOUGH2, iTOUGH2, H&#39;</span>
	<span class="n">d</span><span class="p">[</span><span class="s1">&#39;CreationDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
	<span class="n">d</span><span class="p">[</span><span class="s1">&#39;ModDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>

	<span class="c1"># Write the PDF document to the disk</span>
	<span class="n">pdf_pages</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_compare_mh"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_mh">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_mh</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">source</span><span class="p">,</span><span class="n">save</span><span class="p">,</span><span class="n">show</span><span class="p">,</span> <span class="n">production_dictionary</span><span class="p">,</span> <span class="n">years</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span> <span class="n">variables</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">plot_feedzones</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Genera una grafica donde compara la evolucion de flujo y entalpia para el bloque asignado a la fuente de un pozo en particular</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	  </span>
<span class="sd">	well : str</span>
<span class="sd">	  Nombre de pozo</span>
<span class="sd">	block : str</span>
<span class="sd">	  Nombre de bloque, en general donde se ubica zona de alimentacion</span>
<span class="sd">	source : str</span>
<span class="sd">	  Nombre de fuente asociada a pozo</span>
<span class="sd">	save : bool</span>
<span class="sd">	  Almacaena la grafica generada</span>
<span class="sd">	show : bool</span>
<span class="sd">	  Almacaena la grafica generada</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	image</span>
<span class="sd">		{well}_{block}_{source}_evol.png: archivo con direccion ../output/mh/images/</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	El archivo correspondiente en la carpeta  ../output/mh/txt debe existir</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; plot_compare_mh(&#39;AH-1&#39;,&#39;DA110&#39;,&#39;SRC1&#39;,save=True,show=False)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1">#Read file, current calculated</span>
	<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../output/mh/txt/</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_evol_mh.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">source</span><span class="p">)</span>
	<span class="n">OBJ_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/it2_PT.json&quot;</span>
	<span class="n">OBJ_file_prev</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/prev/it2_PT.json&quot;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>

		<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>
		<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
		<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

		<span class="n">line_index</span> <span class="o">=</span> <span class="mi">1</span>

		<span class="c1">#Section dedicated to wells with more with one feedzone. iT2 computes the weighted enthlapy and the flowrate sum for each timestep define on the iT2 file</span>
		<span class="k">if</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">production_dictionary</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">plot_feedzones</span><span class="p">:</span>
			<span class="n">data_t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">)</span>
			<span class="n">data_h</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">production_dictionary</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="mi">0</span><span class="p">],[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>
			<span class="n">data_r</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">production_dictionary</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>

			<span class="n">times</span> <span class="o">=</span> <span class="n">data_h</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

			<span class="n">dates_h</span><span class="o">=</span><span class="p">[]</span>
			<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">dates_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])))</span>
					<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

			<span class="n">times</span> <span class="o">=</span> <span class="n">data_r</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

			<span class="n">dates_r</span><span class="o">=</span><span class="p">[]</span>
			<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">dates_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])))</span>
					<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Well: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">)</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flow rate [kg/s]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>


			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_r</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_r</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]),</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed flow&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>


			<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Enthalpy [kJ/kg]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

			<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_h</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_h</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">1E3</span><span class="p">,</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed enthalpy&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

			<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span><span class="mi">3000</span><span class="p">])</span>

			<span class="n">data_t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">OBJ_file_prev</span><span class="p">)</span>
			<span class="n">data_h</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">production_dictionary</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="mi">0</span><span class="p">],[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>
			<span class="n">data_r</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">production_dictionary</span><span class="p">[</span><span class="n">well</span><span class="p">][</span><span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>

			<span class="n">times</span> <span class="o">=</span> <span class="n">data_h</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

			<span class="n">dates_h</span><span class="o">=</span><span class="p">[]</span>
			<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">dates_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])))</span>
					<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

			<span class="n">times</span> <span class="o">=</span> <span class="n">data_r</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

			<span class="n">dates_r</span><span class="o">=</span><span class="p">[]</span>
			<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">dates_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])))</span>
					<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Well: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">)</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flow rate [kg/s]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>


			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_r</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_r</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]),</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed flow prev&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span>

			<span class="n">line_index</span> <span class="o">=</span> <span class="mi">2</span>


			<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
			<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Enthalpy [kJ/kg]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span><span class="mi">3000</span><span class="p">])</span>


			<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_h</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_h</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">1E3</span><span class="p">,</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed enthalpy prev&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span>

		<span class="k">else</span><span class="p">:</span>
			<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
			<span class="c1">#data.replace(0,np.nan, inplace=True)</span>

			<span class="c1">#Setting the time to plot</span>
			
			<span class="n">times</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

			<span class="n">dates</span><span class="o">=</span><span class="p">[]</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>
					<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

				
				<span class="n">enthalpy</span><span class="o">=</span><span class="p">[]</span>
				<span class="n">flow_rate</span><span class="o">=</span><span class="p">[]</span>

				<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
					<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
						<span class="k">try</span><span class="p">:</span>
							<span class="c1">#dates.append(input_dictionary[&#39;ref_date&#39;]+datetime.timedelta(seconds=int(times[n])))</span>

							<span class="k">if</span> <span class="s1">&#39;ENTHALPY&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
								<span class="n">H_colum</span> <span class="o">=</span> <span class="s1">&#39;ENTHALPY&#39;</span>
							<span class="k">elif</span> <span class="s1">&#39;ENTH&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
								<span class="n">H_colum</span> <span class="o">=</span> <span class="s1">&#39;ENTH&#39;</span>

							<span class="k">if</span> <span class="s1">&#39;GENERATION RATE&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
								<span class="n">m_colum</span> <span class="o">=</span> <span class="s1">&#39;GENERATION RATE&#39;</span>
							<span class="k">elif</span> <span class="s1">&#39;GEN&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
								<span class="n">m_colum</span> <span class="o">=</span> <span class="s1">&#39;GEN&#39;</span>

							<span class="n">enthalpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">H_colum</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="mf">1E3</span><span class="p">)</span>
							<span class="n">flow_rate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">m_colum</span><span class="p">][</span><span class="n">n</span><span class="p">])</span>
						<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
							<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>

		
			<span class="c1">#Real data</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Well: </span><span class="si">%s</span><span class="s2">, block </span><span class="si">%s</span><span class="s2">, source </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">source</span><span class="p">)</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flow rate [kg/s]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

			<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Enthalpy [kJ/kg]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span><span class="mi">2700</span><span class="p">])</span>
			
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

				<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">flow_rate</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
					<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Calculated flow&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>


				<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">enthalpy</span><span class="p">,</span>\
					<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Calculated enthalpy&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

				
			<span class="k">else</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
					<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">TIME</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span>\
						<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

		

		<span class="k">try</span><span class="p">:</span>
			<span class="n">data_real</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/mh/</span><span class="si">%s</span><span class="s2">_mh.dat&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">)</span>
			<span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H:%M:%S&quot;</span><span class="p">)</span>
			<span class="n">data_real</span><span class="o">=</span><span class="n">data_real</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span>
			<span class="n">data_real</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

			<span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;total_flow&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;liquid&#39;</span><span class="p">]</span>

			<span class="c1">#Plotting</span>

			<span class="c1">#ax=data[[&#39;Flujo_total&#39;]].plot(figsize=(12,4),legend=False,linestyle=&quot;-&quot;)</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;liquid&#39;</span><span class="p">],</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

			<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;enthalpy&#39;</span><span class="p">],</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			
			<span class="n">real_data</span><span class="o">=</span><span class="kc">True</span>
			
		<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
			<span class="n">real_data</span><span class="o">=</span><span class="kc">False</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No real data for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">)</span>
			<span class="k">pass</span>

		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

			<span class="k">if</span> <span class="n">real_data</span><span class="p">:</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="n">line_index</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">1</span><span class="p">]],</span>\
				                   <span class="p">[</span><span class="s1">&#39;Computed flow rate &#39;</span><span class="p">,</span><span class="s1">&#39;Measured flow rate &#39;</span><span class="p">,</span>\
				                    <span class="s1">&#39;Computed enthalpy&#39;</span><span class="p">,</span> <span class="s1">&#39;Estimated enthalpy&#39;</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>\
				           <span class="p">[</span><span class="s1">&#39;Computed Flow rate &#39;</span><span class="p">,</span><span class="s1">&#39;Estimated enthalpy&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


		<span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="o">*</span><span class="mf">0.9</span><span class="p">])</span>

		<span class="c1">#Plotting formating</span>
		<span class="c1">#xlims=[min(dates)-datetime.timedelta(days=365),max(dates)+datetime.timedelta(days=365)]</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">format_xdata</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y%-m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>


		<span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">),</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">years</span><span class="o">*</span><span class="mf">365.25</span><span class="p">)]</span>
		<span class="c1">#ylims=[0,100]</span>
		<span class="c1">#ax1.set_ylim(ylims)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
		<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
		<span class="n">years_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">years_fmt</span><span class="p">)</span>

		<span class="c1">#ax.xaxis.set_major_locator(years)</span>
		<span class="c1">#fig.autofmt_xdate()</span>

		<span class="c1">#Grid style</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">save</span><span class="p">:</span>
			<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/mh/images/</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_evol.png&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">source</span><span class="p">))</span> 
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is not a file called </span><span class="si">%s</span><span class="s2">, try running src_evol from output.py&quot;</span><span class="o">%</span><span class="n">file</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_compare_PT"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_PT">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_PT</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">save</span><span class="p">,</span><span class="n">show</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Genera una grafica donde compara la evolucion de flujo y entalpia para el bloque asignado a la fuente de un pozo en particular</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	  </span>
<span class="sd">	well : str</span>
<span class="sd">	  Nombre de pozo</span>
<span class="sd">	block : str</span>
<span class="sd">	  Nombre de bloque, en general donde se ubica zona de alimentacion</span>
<span class="sd">	source : str</span>
<span class="sd">	  Nombre de fuente asociada a pozo</span>
<span class="sd">	save : bool</span>
<span class="sd">	  Almacaena la grafica generada</span>
<span class="sd">	show : bool</span>
<span class="sd">	  Almacaena la grafica generada</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	image</span>
<span class="sd">		{well}_{block}_{source}_evol.png: archivo con direccion ../output/mh/images/</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	El archivo correspondiente en la carpeta  ../output/mh/txt debe existir</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; plot_compare_mh(&#39;AH-1&#39;,&#39;DA110&#39;,&#39;SRC1&#39;,save=True,show=False)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1">#Read file, current calculated</span>
	<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/evol/</span><span class="si">%s</span><span class="s2">_PT_evol.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
		<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

		<span class="c1">#Setting the time to plot</span>
		
		<span class="n">times</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">block</span><span class="p">]</span>
		<span class="n">times</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">time</span>  <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
			<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>

		<span class="c1">#Real data</span>

		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">block</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
			<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Well: </span><span class="si">%s</span><span class="s2">, block </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">)</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [C]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

		<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

		<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;PRES_VAP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">block</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)]</span><span class="o">/</span><span class="mf">1E5</span><span class="p">,</span>\
			<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Calculated enthalpy&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

		<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [bar]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
		

		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>\
			           <span class="p">[</span><span class="s1">&#39;Calculated Temperature&#39;</span><span class="p">,</span><span class="s1">&#39;Calculated Pressure &#39;</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">format_xdata</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y%-m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

		<span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">),</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">35</span><span class="o">*</span><span class="mf">365.25</span><span class="p">)]</span>
		<span class="c1">#ylims=[0,100]</span>
		<span class="c1">#ax1.set_ylim(ylims)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
		<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
		<span class="n">years_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">years_fmt</span><span class="p">)</span>

		<span class="c1">#ax.xaxis.set_major_locator(years)</span>
		<span class="c1">#fig.autofmt_xdate()</span>

		<span class="c1">#Grid style</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">save</span><span class="p">:</span>
			<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/mh/images/</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_evol.png&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">))</span> 
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is not a file called </span><span class="si">%s</span><span class="s2">, try running src_evol from output.py&quot;</span><span class="o">%</span><span class="n">file</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_compare_PT_vertical"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_PT_vertical">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_PT_vertical</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">well</span><span class="p">,</span><span class="n">block</span><span class="p">,</span><span class="n">save</span><span class="p">,</span><span class="n">show</span><span class="p">,</span> <span class="n">years</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span> <span class="n">p_res_block</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Genera una grafica donde compara la evolucion de flujo y entalpia para el bloque asignado a la fuente de un pozo en particular</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------	  </span>
<span class="sd">	well : str</span>
<span class="sd">	  Nombre de pozo</span>
<span class="sd">	block : str</span>
<span class="sd">	  Nombre de bloque, en general donde se ubica zona de alimentacion</span>
<span class="sd">	source : str</span>
<span class="sd">	  Nombre de fuente asociada a pozo</span>
<span class="sd">	save : bool</span>
<span class="sd">	  Almacaena la grafica generada</span>
<span class="sd">	show : bool</span>
<span class="sd">	  Almacaena la grafica generada</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	image</span>
<span class="sd">		{well}_{block}_{source}_evol.png: archivo con direccion ../output/mh/images/</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	El archivo correspondiente en la carpeta  ../output/mh/txt debe existir</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	&gt;&gt;&gt; plot_compare_mh(&#39;AH-1&#39;,&#39;DA110&#39;,&#39;SRC1&#39;,save=True,show=False)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1">#Read file, current calculated</span>
	<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/evol/</span><span class="si">%s</span><span class="s2">_PT_evol.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>


	<span class="n">layers_info</span><span class="o">=</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertical_layers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">)</span>

	<span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="o">+</span><span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">layers_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
		<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Well: </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">)</span> <span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>

		<span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
		<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colormap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">))]</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">block_i</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>

			<span class="c1">#Setting the time to plot</span>
			
			<span class="n">times</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">block_i</span><span class="p">]</span>
			<span class="n">times</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">time</span>  <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
				<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>


			<span class="k">if</span> <span class="n">p_res_block</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">block_i</span> <span class="o">==</span> <span class="n">p_res_block</span><span class="p">:</span>
				<span class="n">linestyle_i</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">linestyle_i</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>

			<span class="k">if</span> <span class="n">var_name</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
				<span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;PRES_VAP&#39;</span>
				<span class="n">label_y</span> <span class="o">=</span> <span class="s1">&#39;Pressure [bar]&#39;</span>
				<span class="n">divisor</span> <span class="o">=</span> <span class="mf">1E5</span>
			<span class="k">elif</span> <span class="n">var_name</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
				<span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;TEMP&#39;</span>
				<span class="n">label_y</span> <span class="o">=</span> <span class="s1">&#39;Temperature [C]&#39;</span>
				<span class="n">divisor</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="k">elif</span> <span class="n">var_name</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
				<span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;SAT_VAP&#39;</span>
				<span class="n">label_y</span> <span class="o">=</span> <span class="s1">&#39;Quality&#39;</span>
				<span class="n">divisor</span> <span class="o">=</span> <span class="mf">0.01</span>


			<span class="n">data_var</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">block_i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)]</span><span class="o">/</span><span class="n">divisor</span>

			<span class="n">data_var</span> <span class="o">=</span> <span class="n">data_var</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

			<span class="k">if</span> <span class="n">delta</span><span class="p">:</span>
				<span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;delta&#39;</span>
				<span class="n">pos</span> <span class="o">=</span> <span class="n">data_var</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
				<span class="n">data_var</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data_var</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">pos</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_var</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pos</span><span class="p">]</span>
				
			<span class="k">else</span><span class="p">:</span>
				<span class="n">var</span> <span class="o">=</span> <span class="n">var_name</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">data_var</span><span class="p">[</span><span class="n">var</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle_i</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">block_i</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

			<span class="k">if</span> <span class="n">p_res_block</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">block_i</span> <span class="o">==</span> <span class="n">p_res_block</span><span class="p">:</span>
				<span class="n">pres_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/field_data.csv&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
				<span class="n">pres_data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

				<span class="n">pres_data</span> <span class="o">=</span> <span class="n">pres_data</span><span class="p">[</span><span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;prs1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>

				<span class="k">if</span> <span class="n">delta</span><span class="p">:</span>
					<span class="n">pos</span> <span class="o">=</span> <span class="n">pres_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;prs1&#39;</span><span class="p">)</span>
					<span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">pres_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">pos</span><span class="p">]</span> <span class="o">-</span> <span class="n">pres_data</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pos</span><span class="p">]</span>

				<span class="n">pres_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">)</span>

				<span class="n">dates_func_res</span><span class="o">=</span><span class="k">lambda</span> <span class="n">datesX</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datesX</span><span class="p">),</span> <span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="n">dates_res</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">dates_func_res</span><span class="p">,</span><span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]))</span>
				

				<span class="k">if</span> <span class="n">delta</span><span class="p">:</span>
					<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_res</span><span class="p">,</span><span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;p_res&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_res</span><span class="p">,</span><span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;prs1&#39;</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;p_res&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label_y</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">format_xdata</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y%-m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

		<span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">),</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">years</span><span class="o">*</span><span class="mf">365.25</span><span class="p">)]</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
		<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
		<span class="n">years_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">years_fmt</span><span class="p">)</span>

		<span class="c1">#Grid style</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">save</span><span class="p">:</span>
			<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/PT/evol/</span><span class="si">%s</span><span class="s1">_evol_</span><span class="si">%s</span><span class="s1">.png&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">,</span><span class="n">var_name</span><span class="p">))</span> 
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is not a file called </span><span class="si">%s</span><span class="s2">, try running src_evol from output.py&quot;</span><span class="o">%</span><span class="n">file</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_compare_producers"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_producers">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_producers</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">years</span> <span class="o">=</span> <span class="mi">35</span><span class="p">):</span>

	<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

	<span class="n">OBJ_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/it2_PT.json&quot;</span>

	<span class="n">data_t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">)</span>
	<span class="n">data_h</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PROD_FLOWH&#39;</span><span class="p">,[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>
	<span class="n">data_r</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PROD_FLOWR&#39;</span><span class="p">,[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>

	<span class="n">times</span> <span class="o">=</span> <span class="n">data_h</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>

	<span class="n">dates</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])))</span>
			<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Production wells&quot;</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flow rate [kg/s]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_r</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]),</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed flow&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

	<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
	<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Enthalpy [kJ/kg]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>


	<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_h</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">1E3</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed enthalpy&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>


	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	data_real=pd.read_csv(&quot;../input/mh/total_prod_mh.csv&quot;)</span>
<span class="sd">	data_real[&#39;date_time&#39;] = pd.to_datetime(data_real[&#39;date_time&#39;] , format=&quot;%Y-%m-%d&quot;)</span>
<span class="sd">	data_real=data_real.set_index([&#39;date_time&#39;])</span>
<span class="sd">	data_real.index = pd.to_datetime(data_real.index)</span>


<span class="sd">	#Plotting</span>

<span class="sd">	#ax=data[[&#39;Flujo_total&#39;]].plot(figsize=(12,4),legend=False,linestyle=&quot;-&quot;)</span>

<span class="sd">	ax.plot(data_real.index,data_real[&#39;m&#39;],\</span>
<span class="sd">		linestyle=&#39;-&#39;,color=formats.plot_conf_color[&#39;m&#39;][0],ms=3,label=&#39;Measured flow&#39;,marker=formats.plot_conf_marker[&#39;real&#39;][0],alpha=formats.plot_conf_marker[&#39;current&#39;][1])</span>
<span class="sd">	ax1.plot(data_real.index,data_real[&#39;h&#39;],&#39;ob&#39;,\</span>
<span class="sd">		linestyle=&#39;None&#39;,color=formats.plot_conf_color[&#39;h&#39;][0],ms=3,label=&#39;Estimated enthalpy&#39;,marker=formats.plot_conf_marker[&#39;real&#39;][0],alpha=formats.plot_conf_marker[&#39;current&#39;][1])</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">data_real</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/field_data.csv&quot;</span><span class="p">)</span>
	<span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
	<span class="n">data_real</span><span class="o">=</span><span class="n">data_real</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;fecha&#39;</span><span class="p">])</span>
	<span class="n">data_real</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>


	<span class="c1">#Plotting</span>

	<span class="c1">#ax=data[[&#39;Flujo_total&#39;]].plot(figsize=(12,4),legend=False,linestyle=&quot;-&quot;)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;agua&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;vapor&#39;</span><span class="p">],</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Measured flow&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated enthalpy&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	
	<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">1</span><span class="p">]],</span>\
				                   <span class="p">[</span><span class="s1">&#39;Computed Flow rate &#39;</span><span class="p">,</span><span class="s1">&#39;Measured flow rate &#39;</span><span class="p">,</span>\
				                    <span class="s1">&#39;Computed Enthalpy&#39;</span><span class="p">,</span> <span class="s1">&#39;Estimated enthalpy&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


	<span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="o">*</span><span class="mf">0.9</span><span class="p">])</span>

	<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/mh/producer_wells.png&#39;</span><span class="p">)</span> 

	<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="cross_section"><a class="viewcode-back" href="../modules/report.html#report.cross_section">[docs]</a><span class="k">def</span> <span class="nf">cross_section</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">plot_mesh</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>


	<span class="n">ngridx</span> <span class="o">=</span> <span class="mi">200</span>
	<span class="n">ngridy</span> <span class="o">=</span> <span class="mi">200</span>

	<span class="n">fontsize_labels</span> <span class="o">=</span> <span class="mi">6</span>


	<span class="n">file_output</span><span class="o">=</span><span class="s2">&quot;../output/PT/json/evol/t2_output_</span><span class="si">%s</span><span class="s2">.json&quot;</span><span class="o">%</span><span class="n">time</span>

	<span class="n">elem_file</span><span class="o">=</span><span class="s1">&#39;../mesh/ELEME.json&#39;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">elem_file</span><span class="p">):</span>
		 <span class="n">blocks</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">elem_file</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_output</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_output</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		  	<span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
		
	<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">time</span><span class="p">]</span>

	<span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mi">1</span>
	<span class="k">elif</span> <span class="n">variable</span> <span class="o">==</span> <span class="s1">&#39;PRES_VAP&#39;</span><span class="p">:</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mf">1E5</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">divisor</span> <span class="o">=</span> <span class="mi">1</span>

	<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">eleme</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">eleme</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">layer</span><span class="p">:</span>
			<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">eleme</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
			<span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">eleme</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">])</span>
			<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">eleme</span><span class="p">][</span><span class="n">variable</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span><span class="p">)</span>

	<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">ngridx</span><span class="p">)</span>
	<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">ngridy</span><span class="p">)</span>
	<span class="n">zi</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="kc">None</span><span class="p">,:],</span> <span class="n">yi</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

	<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
	<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

	<span class="n">lv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="mi">20</span><span class="p">)</span>

	<span class="n">c</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">zi</span><span class="p">,</span> <span class="n">linewidths</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">lv</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">inline</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsize_labels</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.1f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
	<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">zi</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;jet&quot;</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">lv</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">variable</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize_labels</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;North [m]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span><span class="n">fontsize_labels</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;East [m]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_labels</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Layer </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">layer</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_labels</span><span class="p">)</span>


	<span class="k">if</span> <span class="n">plot_mesh</span><span class="p">:</span>
		<span class="n">segmt_json_file</span><span class="o">=</span><span class="s1">&#39;../mesh/segmt.json&#39;</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">):</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">segmt_json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
			  	<span class="n">blocks_seg</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

			<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks_seg</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">layer</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blocks_seg</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="s1">&#39;points&#39;</span><span class="p">]):</span>

						<span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
							<span class="n">line</span><span class="o">=</span><span class="p">[]</span>
						<span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
							<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
							<span class="n">line</span><span class="o">=</span><span class="p">[]</span>
						<span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">4</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
							<span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

	<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/PT/images/layer/</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">.png&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">time</span><span class="p">))</span> 

	<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>



<div class="viewcode-block" id="plot_power"><a class="viewcode-back" href="../modules/report.html#report.plot_power">[docs]</a><span class="k">def</span> <span class="nf">plot_power</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

	<span class="n">real_data</span> <span class="o">=</span> <span class="s2">&quot;../input/generation_data.csv&quot;</span>

	<span class="n">gen_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
	<span class="n">gen_data</span> <span class="o">=</span> <span class="n">gen_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span><span class="s1">&#39;fecha&#39;</span> <span class="p">)</span>
	<span class="n">gen_data</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">gen_data</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="n">gen_data_u12</span> <span class="o">=</span> <span class="n">gen_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">((</span><span class="n">gen_data</span><span class="o">.</span><span class="n">unidad</span> <span class="o">==</span> <span class="s1">&#39;u1&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">unidad</span> <span class="o">==</span> <span class="s1">&#39;u2&#39;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">generation</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">,</span><span class="s1">&#39;fecha&#39;</span><span class="p">,</span><span class="s1">&#39;unidad&#39;</span><span class="p">]]</span>
	<span class="n">gen_data_u12</span> <span class="o">=</span> <span class="n">gen_data_u12</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;fecha&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
	<span class="n">gen_data_u12</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gen_data_u12</span><span class="o">.</span><span class="n">index</span>
	<span class="n">gen_data_u12</span> <span class="o">=</span> <span class="n">gen_data_u12</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">gen_data_u3</span> <span class="o">=</span> <span class="n">gen_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">unidad</span> <span class="o">==</span> <span class="s1">&#39;u3&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">generation</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">,</span><span class="s1">&#39;fecha&#39;</span><span class="p">,</span><span class="s1">&#39;unidad&#39;</span><span class="p">]]</span>
	<span class="n">gen_data_u3</span> <span class="o">=</span> <span class="n">gen_data_u3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">file_12</span> <span class="o">=</span> <span class="s2">&quot;../output/unit_12_power.csv&quot;</span>
	<span class="n">file_3</span> <span class="o">=</span> <span class="s2">&quot;../output/unit_3_power.csv&quot;</span>

	<span class="n">data_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_12</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
	<span class="n">data_12</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_12</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

	<span class="n">data_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_3</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
	<span class="n">data_3</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_3</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

	<span class="n">fig12</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

	<span class="n">ax12</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
	<span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Power Generation, Units 1 and 2&quot;</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
	<span class="n">ax12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Generation [MW]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
	<span class="n">ax12</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

	<span class="n">fig3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

	<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
	<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Power Generation, Units 3&quot;</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
	<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Generation [MW]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
	<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

	<span class="n">ax12</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_12</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">],</span><span class="n">data_12</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ax12</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gen_data_u12</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">],</span><span class="n">gen_data_u12</span><span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ax12</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

	<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_3</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">],</span><span class="n">data_3</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
	<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gen_data_u3</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">],</span><span class="n">gen_data_u3</span><span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
	<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">save</span><span class="p">:</span>
		<span class="n">fig12</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/power_12.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> 
		<span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/power_3.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span> <span class="mi">300</span><span class="p">)</span> 

	<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_power_it2"><a class="viewcode-back" href="../modules/report.html#report.plot_power_it2">[docs]</a><span class="k">def</span> <span class="nf">plot_power_it2</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

	<span class="c1">#Read file, current calculated</span>
	<span class="n">file</span><span class="o">=</span><span class="s2">&quot;../input/generation_data.csv&quot;</span>
	<span class="n">OBJ_file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/it2_PT.json&quot;</span>
	<span class="n">OBJ_file_prev</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/json/prev/it2_PT.json&quot;</span>

	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>

		<span class="n">gen_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
		<span class="n">gen_data</span> <span class="o">=</span> <span class="n">gen_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span><span class="s1">&#39;fecha&#39;</span> <span class="p">)</span>
		<span class="n">gen_data</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">gen_data</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

		<span class="n">gen_data_u12</span> <span class="o">=</span> <span class="n">gen_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">((</span><span class="n">gen_data</span><span class="o">.</span><span class="n">unidad</span> <span class="o">==</span> <span class="s1">&#39;u1&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">unidad</span> <span class="o">==</span> <span class="s1">&#39;u2&#39;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">generation</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">,</span><span class="s1">&#39;fecha&#39;</span><span class="p">,</span><span class="s1">&#39;unidad&#39;</span><span class="p">]]</span>
		<span class="n">gen_data_u12</span> <span class="o">=</span> <span class="n">gen_data_u12</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;fecha&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
		<span class="n">gen_data_u12</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gen_data_u12</span><span class="o">.</span><span class="n">index</span>
		<span class="n">gen_data_u12</span> <span class="o">=</span> <span class="n">gen_data_u12</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

		<span class="n">gen_data_u3</span> <span class="o">=</span> <span class="n">gen_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">unidad</span> <span class="o">==</span> <span class="s1">&#39;u3&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gen_data</span><span class="o">.</span><span class="n">generation</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">,</span><span class="s1">&#39;fecha&#39;</span><span class="p">,</span><span class="s1">&#39;unidad&#39;</span><span class="p">]]</span>
		<span class="n">gen_data_u3</span> <span class="o">=</span> <span class="n">gen_data_u3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


		<span class="c1">#Section dedicated to wells with more with one feedzone. iT2 computes the weighted enthlapy and the flowrate sum for each timestep define on the iT2 file</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">):</span>
			<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>
			<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

			<span class="n">data_t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">OBJ_file</span><span class="p">)</span>

			<span class="n">data_12</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;UNIT1&amp;2&#39;</span><span class="p">,[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>

			<span class="n">dates_12</span><span class="o">=</span><span class="p">[]</span>
			<span class="n">times</span> <span class="o">=</span> <span class="n">data_12</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">dates_12</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])))</span>
					<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Power Generation, Units 1 and 2&quot;</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Generation [MW]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>


			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_12</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_12</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]),</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gen_data_u12</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">],</span><span class="n">gen_data_u12</span><span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">show</span><span class="p">:</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
			
			<span class="k">if</span> <span class="n">save</span><span class="p">:</span>
				<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/power_12.png&#39;</span><span class="p">)</span> 



			<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>
			<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

			<span class="n">data_3</span> <span class="o">=</span> <span class="n">data_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_t</span><span class="p">[</span><span class="s1">&#39;OBSERVATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;UNIT3&#39;</span><span class="p">,[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">]]</span>

			<span class="n">dates_3</span><span class="o">=</span><span class="p">[]</span>
			<span class="n">times</span> <span class="o">=</span> <span class="n">data_3</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">dates_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])))</span>
					<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
						<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span><span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Power Generation, Unit 3&quot;</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Generation [MW]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>


			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data_3</span><span class="p">[</span><span class="s1">&#39;COMPUTED&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">32</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_color</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Computed power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gen_data_u3</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">],</span><span class="n">gen_data_u3</span><span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>\
				<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real power&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">show</span><span class="p">:</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
			
			<span class="k">if</span> <span class="n">save</span><span class="p">:</span>
				<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/power_3.png&#39;</span><span class="p">)</span> </div>



<div class="viewcode-block" id="plot_compare_mh_filtered"><a class="viewcode-back" href="../modules/report.html#report.plot_compare_mh_filtered">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_mh_filtered</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">,</span> <span class="n">well</span><span class="p">):</span>

	<span class="n">years</span> <span class="o">=</span> <span class="mi">35</span>

	<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>
	<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
	<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>


	<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Well: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">)</span> <span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flow rate [kg/s]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>


	<span class="n">data_real</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/mh/</span><span class="si">%s</span><span class="s2">_mh.dat&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">)</span>
	<span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H:%M:%S&quot;</span><span class="p">)</span>
	<span class="n">data_real</span><span class="o">=</span><span class="n">data_real</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span>
	<span class="n">data_real</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
	<span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;total_flow&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;liquid&#39;</span><span class="p">]</span>

	<span class="n">data_real_filtered</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/mh/filtered/</span><span class="si">%s</span><span class="s2">_week_avg.csv&quot;</span><span class="o">%</span><span class="n">well</span><span class="p">)</span>
	<span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
	<span class="n">data_real_filtered</span><span class="o">=</span><span class="n">data_real_filtered</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span>
	<span class="n">data_real_filtered</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_real_filtered</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
	<span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;total_flow&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;liquid&#39;</span><span class="p">]</span>


	<span class="c1">#Plotting</span>

	<span class="c1">#ax=data[[&#39;Flujo_total&#39;]].plot(figsize=(12,4),legend=False,linestyle=&quot;-&quot;)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;liquid&#39;</span><span class="p">],</span><span class="s1">&#39;or&#39;</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real_filtered</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;steam&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;liquid&#39;</span><span class="p">],</span><span class="s1">&#39;og&#39;</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

	<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real</span><span class="p">[</span><span class="s1">&#39;enthalpy&#39;</span><span class="p">],</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_real_filtered</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">data_real_filtered</span><span class="p">[</span><span class="s1">&#39;enthalpy&#39;</span><span class="p">],</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span>\
		<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

	<span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="o">*</span><span class="mf">0.9</span><span class="p">])</span>

	<span class="c1">#Plotting formating</span>
	<span class="c1">#xlims=[min(dates)-datetime.timedelta(days=365),max(dates)+datetime.timedelta(days=365)]</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">format_xdata</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y%-m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>


	<span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">),</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">years</span><span class="o">*</span><span class="mf">365.25</span><span class="p">)]</span>
	<span class="c1">#ylims=[0,100]</span>
	<span class="c1">#ax1.set_ylim(ylims)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
	<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
	<span class="n">years_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">years_fmt</span><span class="p">)</span>

	<span class="c1">#ax.xaxis.set_major_locator(years)</span>
	<span class="c1">#fig.autofmt_xdate()</span>

	<span class="c1">#Grid style</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="mi">1</span><span class="p">]],</span>\
	                   <span class="p">[</span><span class="s1">&#39;Flow rate &#39;</span><span class="p">,</span><span class="s1">&#39;Filtered flow rate&#39;</span><span class="p">,</span>\
	                    <span class="s1">&#39;Enthalpy&#39;</span><span class="p">,</span> <span class="s1">&#39;Filtered enthalpy&#39;</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="pres"><a class="viewcode-back" href="../modules/report.html#report.pres">[docs]</a><span class="k">def</span> <span class="nf">pres</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">):</span>
	<span class="n">years</span> <span class="o">=</span> <span class="mi">35</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	wells = {&#39;TR-4&#39;:[</span>
<span class="sd">					 [datetime.datetime(1992,1,1,0,0,0),datetime.datetime(2001,5,30,0,0,0)],</span>
<span class="sd">					 [datetime.datetime(2002,5,22,0,0,0),datetime.datetime(2005,3,28,0,0)],</span>
<span class="sd">					 [datetime.datetime(2006,1,1,0,0,0),datetime.datetime(2009,10,20,0,0,0)],</span>
<span class="sd">					 [datetime.datetime(2018,9,8,0,0,0),datetime.datetime(2022,2,10,0,0,0)],</span>
<span class="sd">					 ],</span>
<span class="sd">			 &#39;TR-3&#39;:[</span>
<span class="sd">					 [datetime.datetime(2009,9,23,0,0,0),datetime.datetime(2010,5,7,0,0,0)],</span>
<span class="sd">					 [datetime.datetime(2011,6,27,0,0,0),datetime.datetime(2012,6,18,0,0)],</span>
<span class="sd">					 [datetime.datetime(2014,4,10,0,0,0),datetime.datetime(2016,6,7,0,0,0)],</span>
<span class="sd">					 ],</span>
<span class="sd">			 &#39;TR-12A&#39;:[</span>
<span class="sd">					 [datetime.datetime(2010,6,30,0,0,0),datetime.datetime(2010,11,30,0,0,0)],</span>
<span class="sd">					 [datetime.datetime(2011,5,30,0,0,0),datetime.datetime(2012,4,30,0,0)],</span>
<span class="sd">					 [datetime.datetime(2012,11,30,0,0,0),datetime.datetime(2013,3,1,0,0,0)],</span>
<span class="sd">					 [datetime.datetime(2014,3,1,0,0,0),datetime.datetime(2015,3,1,0,0,0)],</span>
<span class="sd">					 ]</span>
<span class="sd">			}</span>
<span class="sd">	</span>

<span class="sd">	wells = {&#39;TR-4&#39;:[</span>
<span class="sd">					 [datetime.datetime(2005,1,29,0,0,0),datetime.datetime(2019,8,29,0,0,0)],</span>
<span class="sd">					 ],</span>
<span class="sd">			 &#39;TR-3&#39;:[</span>
<span class="sd">					 [datetime.datetime(2006,6,29,0,0,0),datetime.datetime(2018,4,4,0,0,0)],</span>
<span class="sd">					 ],</span>
<span class="sd">			 &#39;TR-12A&#39;:[</span>
<span class="sd">					 [datetime.datetime(2004,8,26,0,0,0),datetime.datetime(2015,1,26,0,0,0)],</span>
<span class="sd">					 ],</span>
<span class="sd">			 &#39;TR-4A&#39;:[</span>
<span class="sd">					 [datetime.datetime(2019,8,28,0,0,0),datetime.datetime(2022,2,15,0,0,0)],</span>
<span class="sd">					 ],</span>
<span class="sd">			 &#39;TR-10A&#39;:[</span>
<span class="sd">					 [datetime.datetime(2000,12,16,0,0,0),datetime.datetime(2009,6,10,0,0,0)],</span>
<span class="sd">					 ]</span>
<span class="sd">			}</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">wells</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TR-4&#39;</span><span class="p">:[</span>
					 <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1992</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
					 <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
					 <span class="p">],</span>
			 <span class="s1">&#39;TR-3&#39;</span><span class="p">:[</span>
					 <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
					 <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
					 <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
					 <span class="p">],</span>
			 <span class="s1">&#39;TR-12A&#39;</span><span class="p">:[</span>
					 <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
					 <span class="p">],</span>
			 <span class="s1">&#39;TR-4A&#39;</span><span class="p">:[</span>
					 <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
					 <span class="p">],</span>
			<span class="p">}</span>

	<span class="n">colors_wells</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TR-4&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
					<span class="s1">&#39;TR-3&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
					<span class="s1">&#39;TR-12A&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
					<span class="s1">&#39;TR-4A&#39;</span><span class="p">:</span><span class="s1">&#39;orange&#39;</span><span class="p">}</span>

	<span class="n">wells_feezones</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TR-4&#39;</span><span class="p">:</span><span class="s1">&#39;NA746&#39;</span><span class="p">,</span>
					<span class="s1">&#39;TR-3&#39;</span><span class="p">:</span><span class="s1">&#39;LD367&#39;</span><span class="p">,</span>
					<span class="s1">&#39;TR-12A&#39;</span><span class="p">:</span><span class="s1">&#39;OA135&#39;</span><span class="p">,</span>
					<span class="s1">&#39;TR-4A&#39;</span><span class="p">:</span><span class="s1">&#39;NA170&#39;</span><span class="p">}</span>

	<span class="n">pres_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/field_data.csv&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
	<span class="n">pres_data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
	<span class="n">pres_data</span> <span class="o">=</span> <span class="n">pres_data</span><span class="p">[</span><span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;prs1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
	<span class="n">pos</span> <span class="o">=</span> <span class="n">pres_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;prs1&#39;</span><span class="p">)</span>
	<span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">pres_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">pos</span><span class="p">]</span> <span class="o">-</span> <span class="n">pres_data</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pos</span><span class="p">]</span>

	<span class="n">dates_func_res</span><span class="o">=</span><span class="k">lambda</span> <span class="n">datesX</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datesX</span><span class="p">),</span> <span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
	<span class="n">dates_res</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">dates_func_res</span><span class="p">,</span><span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]))</span>
	
	<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

	<span class="n">init_value</span> <span class="o">=</span> <span class="mi">35</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">well</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wells</span><span class="p">):</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">well</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">dates_range</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">dates_range</span><span class="p">,[</span><span class="o">-</span><span class="n">init_value</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">init_value</span><span class="o">-</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">init_value</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">init_value</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span> <span class="n">colors_wells</span><span class="p">[</span><span class="n">well</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">dates_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">),</span><span class="o">-</span><span class="n">init_value</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">well</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>


	<span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">wells_feezones</span><span class="p">:</span>

		<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;../output/PT/evol/</span><span class="si">%s</span><span class="s2">_PT_evol.dat&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">well</span><span class="p">)</span>
		<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

		<span class="n">times</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">wells_feezones</span><span class="p">[</span><span class="n">well</span><span class="p">]]</span>
		<span class="n">times</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">time</span>  <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
			<span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="s2">&quot;wont be plot&quot;</span><span class="p">)</span>

		<span class="n">data_var</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PRES_VAP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">wells_feezones</span><span class="p">[</span><span class="n">well</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)]</span><span class="o">/</span><span class="mf">1E5</span>

		<span class="n">data_var</span> <span class="o">=</span> <span class="n">data_var</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

		<span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;delta&#39;</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">data_var</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;PRES_VAP&#39;</span><span class="p">)</span>
		<span class="n">data_var</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data_var</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">pos</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_var</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pos</span><span class="p">]</span>
		<span class="n">data_var</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dates</span>

		<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_var</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">],</span><span class="n">data_var</span><span class="p">[</span><span class="n">var</span><span class="p">],</span><span class="n">lw</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span> <span class="n">colors_wells</span><span class="p">[</span><span class="n">well</span><span class="p">]</span> <span class="p">)</span>

		<span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">[</span><span class="n">well</span><span class="p">]:</span>

			<span class="n">df</span> <span class="o">=</span> <span class="n">data_var</span><span class="p">[(</span><span class="n">data_var</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_var</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">lw</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">formats</span><span class="o">.</span><span class="n">plot_conf_marker</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors_wells</span><span class="p">[</span><span class="n">well</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">well</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">wells_feezones</span><span class="p">[</span><span class="n">well</span><span class="p">])</span>


	<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
	<span class="n">unique</span> <span class="o">=</span> <span class="p">[(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">))</span> <span class="k">if</span> <span class="n">l</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[:</span><span class="n">i</span><span class="p">]]</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">unique</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Monitoring pressure&quot;</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure drawdown [bar]&quot;</span><span class="p">)</span>

	<span class="c1">#Grid style</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_res</span><span class="p">,</span><span class="n">pres_data</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Monitoring&#39;</span><span class="p">)</span>


	<span class="n">ax</span><span class="o">.</span><span class="n">format_xdata</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y%-m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

	<span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">),</span><span class="n">input_dictionary</span><span class="p">[</span><span class="s1">&#39;ref_date&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">years</span><span class="o">*</span><span class="mf">365.25</span><span class="p">)]</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
	<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
	<span class="n">years_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">years_fmt</span><span class="p">)</span>

	<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../output/res_pressure.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> 

	<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Erick Jimenez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>